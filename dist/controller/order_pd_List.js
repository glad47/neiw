/** layuiAdmin.pro-v1.0.0 LPPL License By http://www.layui.com/admin/ */
 ;"use strict";layui.define(["admin","table","index","element","form","laydate"],function(e){function t(){if(null!=a.startOrderTime&&a.endOrderTime){var e=a.startOrderTime,t=a.endOrderTime;return console.log(12112),!(t<e)||(layer.msg("结束时间不能小于开始时间, 请重新选择！！！"),!1)}}function r(){var e=l("select[name='orderField']").next(".layui-form-select").find(".layui-this").text();return"销售日期"==e?n="销售额":"支付时间"==e&&(n="回款"),n}function i(){var e=l("input[name='startOrderTime']").val(),t=l("input[name='endOrderTime']").val(),r=l("select[lay-filter='order-pd-list-monthMark']").next(".layui-form-select").find(".layui-this").text();return 0!=e.length&&0!=t.length&&0==r.length?e+"至"+t:0!=r.length?r:0===e.length&&0===t.length&&0===r.length?"全部":void 0}table=layui.table,view=layui.view,admin=layui.admin,form=layui.form,laydate=layui.laydate,setter=layui.setter,element=layui.element;var l=layui.jquery,a={startOrderTime:null,endOrderTime:null,orderField:null,monthMark:null,businessName:null},n="销售额";laydate.render({elem:"#pdlStartOrderTime",isInitValue:!1,done:function(e,r,i){a.startOrderTime=e,a.monthMark=null,l("select[name='monthMark']").val(""),form.render(),null!=a.endOrderTime&&t()}}),laydate.render({elem:"#pdlEndOrderTime",isInitValue:!1,done:function(e,r,i){a.endOrderTime=e,a.monthMark=null,l("select[name='monthMark']").val(""),form.render(),null!=a.startOrderTime&&t()}}),table.render({elem:"#tabOrderPdList",url:setter.baseUrl+"/sys/pa/orderPaList",toolbar:"#tabOrderPdListTb",cellMinWidth:80,id:"tabOrderPdList",page:!0,parseData:function(e){return{code:0,data:e.page.list,count:e.page.totalCount}},where:{orderField:"pay_time",monthMark:"currMonthMark"},cols:[[{type:"checkbox",fixed:"left"},{field:"businessName",title:"业务员",width:160,sort:!0},{field:"orderTime",title:"下单日期",width:113,sort:!0,templet:"#oplOrderTime"},{field:"productNo",title:"内部型号",width:114,sort:!0},{field:"totalFee",title:"订单金额",width:180,sort:!0,templet:"#oplTotalFee"},{field:"commission",title:"提成",width:84,sort:!0,templet:"#oplCommission"},{field:"payLogId",title:"是否支付",width:105,sort:!0,templet:"#oplPayLogId"},{field:"payTime",title:"支付日期",width:113,sort:!0,templet:"#oplPayTime"},{field:"customerUserPaVO",title:"渠道",width:150,sort:!0,templet:"<a>{{ d.customerUserPaVO.channel || 0 }}</a>"},{field:"customerUserPaVO",title:"网站",width:219,sort:!0,templet:"<a>{{ d.customerUserPaVO.siteUrl || 0 }}</a>"},{field:"payLogId",title:"新客户",width:100,sort:!0},{field:"customerUserPaVO",title:"客户名称",width:150,sort:!0,templet:"<a>{{ d.customerUserPaVO.userName || 0 }}</a>"},{field:"customerUserPaVO",title:"客户系统id",width:150,sort:!0,templet:"<a>{{ d.customerUserPaVO.userSystemId || 0 }}</a>",hide:!0},{field:"customerUserPaVO",title:"国家",width:170,sort:!0,templet:"<a>{{ d.customerUserPaVO.country || '' }}</a>"},{field:"customerUserPaVO",title:"客户邮箱",width:219,sort:!0,templet:"<a>{{ d.customerUserPaVO.email || 0 }}</a>"},{field:"orderNumNo",title:"订单编号",width:110,hide:!0,sort:!0}]],done:function(e,t,r){}}),table.on("toolbar(tabOrderPdList)",function(e){var t=table.checkStatus(e.config.id),l=t.data;"MonthlyStatistical"==e.event&&(l.length<1?layer.msg("请选择数据再继续操作！"):(l.popMonthlyStatisticalType=r(),l.popMSTime=i(),admin.popup({title:"月度统计表",area:["100%","100%"],maxmin:!0,id:"popMonthlyStatistical",btn:["打印","取消"],yes:function(){var e="monthlyStatistical";document.body.innerHTML=document.getElementById(e).innerHTML,window.print(),window.location.reload()},success:function(){var e="/marketManagement/iframeWindow/monthly_statistical";view(this.id).render(e,l).done(function(){console.log(l)})}})))}),l("select[lay-filter='order-pd-list-monthMark']").closest(".layui-input-inline").on("click",function(){l("input[name='startOrderTime']").val(""),l("input[name='endOrderTime']").val("")}),e("order_pd_List",{})});