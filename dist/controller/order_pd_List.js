/** layuiAdmin.pro-v1.0.0 LPPL License By http://www.layui.com/admin/ */
 ;"use strict";layui.define(["admin","table","index","element","form","laydate"],function(e){function t(){if(null!=n.startOrderTime&&n.endOrderTime){var e=n.startOrderTime,t=n.endOrderTime;return!(t<e)||(layer.msg("结束时间不能小于开始时间, 请重新选择！！！"),!1)}}function r(){var e=a("select[name='orderField']").next(".layui-form-select").find(".layui-this").text();return"销售日期"==e?d="销售额":"支付时间"==e&&(d="回款"),d}function i(){var e=a("input[name='startOrderTime']").val(),t=a("input[name='endOrderTime']").val(),r=a("select[lay-filter='order-pd-list-monthMark']").next(".layui-form-select").find(".layui-this").text();return 0!=e.length&&0!=t.length&&0==r.length?e+"至"+t:0!=r.length?r:0===e.length&&0===t.length&&0===r.length?"全部":void 0}table=layui.table,view=layui.view,admin=layui.admin,form=layui.form,laydate=layui.laydate,setter=layui.setter,element=layui.element;var l,a=layui.jquery,n={startOrderTime:null,endOrderTime:null,orderField:null,monthMark:null,businessName:null},d="销售额";laydate.render({elem:"#pdlStartOrderTime",isInitValue:!1,done:function(e,r,i){n.startOrderTime=e,n.monthMark=null,a("select[name='monthMark']").val(""),form.render(),null!=n.endOrderTime&&t()}}),laydate.render({elem:"#pdlEndOrderTime",isInitValue:!1,done:function(e,r,i){n.endOrderTime=e,n.monthMark=null,a("select[name='monthMark']").val(""),form.render(),null!=n.startOrderTime&&t()}}),table.render({elem:"#tabOrderPdList",url:setter.baseUrl+"/sys/pa/orderPaList",toolbar:"#tabOrderPdListTb",cellMinWidth:80,id:"tabOrderPdList",page:!1,parseData:function(e){return{code:0,data:e.page.list,count:e.page.totalCount}},where:{orderField:"pay_time",monthMark:"currMonthMark",limit:1e4},cols:[[,{field:"businessName",title:"业务员",width:160,sort:!0},{field:"orderTime",title:"下单日期",width:113,sort:!0,templet:"#oplOrderTime"},{field:"productNo",title:"内部型号",width:114,sort:!0},{field:"totalFee",title:"订单金额",width:180,sort:!0,templet:"#oplTotalFee"},{field:"commission",title:"提成",width:84,sort:!0,templet:"#oplCommission"},{field:"payLogId",title:"是否支付",width:105,sort:!0,templet:"#oplPayLogId"},{field:"payTime",title:"支付日期",width:113,sort:!0,templet:"#oplPayTime"},{field:"customerUserPaVO",title:"渠道",width:150,sort:!0,templet:"<a>{{ d.customerUserPaVO.channel || 0 }}</a>"},{field:"customerUserPaVO",title:"网站",width:219,sort:!0,templet:"<a>{{ d.customerUserPaVO.siteUrl || 0 }}</a>"},{field:"payLogId",title:"新客户",width:100,sort:!0},{field:"customerUserPaVO",title:"客户名称",width:150,sort:!0,templet:"<a>{{ d.customerUserPaVO.userName || 0 }}</a>"},{field:"customerUserPaVO",title:"客户系统id",width:150,sort:!0,templet:"<a>{{ d.customerUserPaVO.userSystemId || 0 }}</a>",hide:!0},{field:"customerUserPaVO",title:"国家",width:170,sort:!0,templet:"<a>{{ d.customerUserPaVO.country || '' }}</a>"},{field:"customerUserPaVO",title:"客户邮箱",width:219,sort:!0,templet:"<a>{{ d.customerUserPaVO.email || 0 }}</a>"},{field:"orderNumNo",title:"订单编号",width:110,hide:!0,sort:!0}]],done:function(e,t,r){l=e.data}}),table.on("toolbar(tabOrderPdList)",function(e){var t=(table.checkStatus(e.config.id),l);"MonthlyStatistical"==e.event&&(t.length<1?layer.msg("当前不存在数据，操作失败"):(t.popMonthlyStatisticalType=r(),t.popMSTime=i(),admin.popup({title:"月度统计表",area:["100%","100%"],maxmin:!0,id:"popMonthlyStatistical",btn:["打印","取消"],yes:function(){var e="monthlyStatistical";document.body.innerHTML=document.getElementById(e).innerHTML,window.print(),window.location.reload()},success:function(){var e="/marketManagement/iframeWindow/monthly_statistical";view(this.id).render(e,t).done(function(){console.log(t)})}})))}),a("select[lay-filter='order-pd-list-monthMark']").closest(".layui-input-inline").on("click",function(){a("input[name='startOrderTime']").val(""),a("input[name='endOrderTime']").val("")}),e("order_pd_List",{})});