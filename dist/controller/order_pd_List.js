/** layuiAdmin.pro-v1.0.0 LPPL License By http://www.layui.com/admin/ */
 ;"use strict";layui.define(["admin","table","index","element","form","laydate"],function(e){function t(){if(null!=a.startOrderTime&&a.endOrderTime){var e=a.startOrderTime,t=a.endOrderTime;return!(t<e)||(layer.msg("结束时间不能小于开始时间, 请重新选择！！！"),!1)}}function r(){var e=l("select[name='orderField']").next(".layui-form-select").find(".layui-this").text();return"销售日期"==e?o="销售额":"支付时间"==e&&(o="回款"),o}function i(){var e=l("input[name='startOrderTime']").val(),t=l("input[name='endOrderTime']").val(),r=l("select[lay-filter='order-pd-list-monthMark']").next(".layui-form-select").find(".layui-this").text();return 0!=e.length&&0!=t.length&&0==r.length?e+"至"+t:0!=r.length?r:0===e.length&&0===t.length&&0===r.length?"全部":void 0}table=layui.table,view=layui.view,admin=layui.admin,form=layui.form,laydate=layui.laydate,setter=layui.setter,element=layui.element;var l=layui.jquery;form.render(null,"market-order-pd-list-formlist");var n,a={startOrderTime:null,endOrderTime:null,orderField:null,monthMark:null,businessName:null},o="销售额";laydate.render({elem:"#pdlStartOrderTime",isInitValue:!1,done:function(e,r,i){a.startOrderTime=e,a.monthMark=null,l("select[name='monthMark']").val(""),form.render(),null!=a.endOrderTime&&t()}}),laydate.render({elem:"#pdlEndOrderTime",isInitValue:!1,done:function(e,r,i){a.endOrderTime=e,a.monthMark=null,l("select[name='monthMark']").val(""),form.render(),null!=a.startOrderTime&&t()}}),form.on("submit(LAY-app-order-pd-list-search)",function(e){var t=e.field;table.reload("tab-order-pd-list",{where:t})}),table.render({elem:"#tab-order-pd-list",url:setter.baseUrl+"/sys/pa/orderPaList",toolbar:"#tabOrderPdListTb",cellMinWidth:80,id:"tab-order-pd-list",page:!1,parseData:function(e){return{code:0,data:e.page.list,count:e.page.totalCount}},where:{orderField:"pay_time",monthMark:"currMonthMark",limit:1e4},cols:[[{field:"businessName",title:"业务员",width:120,sort:!0},{field:"orderTime",title:"下单日期",width:120,sort:!0,templet:"#oplOrderTime"},{field:"productNo",title:"内部型号",width:135,sort:!0},{field:"totalFee",title:"订单金额",width:180,sort:!0,templet:"#oplTotalFee"},{field:"payLogId",title:"是否支付",width:120,sort:!0,templet:"#oplPayLogId"},{field:"payTime",title:"支付日期",width:120,sort:!0,templet:"#oplPayTime"},{field:"payLogId",title:"支付id",width:120,sort:!0},{field:"isSourceCompany",title:"订单类型",width:120,sort:!0,templet:"#oplisSourceCompany"},{field:"orderNumNo",title:"订单编号",width:120,sort:!0}]],done:function(e,t,r){n=e.data}}),table.on("toolbar(tab-order-pd-list)",function(e){var t=(table.checkStatus(e.config.id),n);if("MonthlyStatistical"==e.event)if(t.length<1)layer.msg("当前不存在数据，操作失败");else{t.popMonthlyStatisticalType=r(),t.popMSTime=i();var l=t.filter(function(e){return 0==e.customerUserPaVO.isSourceCompany}),a=t.filter(function(e){return 1==e.customerUserPaVO.isSourceCompany});t.gr=l,t.gs=a,admin.popup({title:"月度统计表",area:["100%","100%"],maxmin:!0,id:"popMonthlyStatistical",btn:["打印","取消"],yes:function(){var e="monthlyStatistical";document.body.innerHTML=document.getElementById(e).innerHTML,window.print(),window.location.reload()},success:function(){var e="/marketManagement/iframeWindow/monthly_statistical";view(this.id).render(e,t).done(function(){console.log(t)})}})}}),l("select[lay-filter='order-pd-list-monthMark']").closest(".layui-input-inline").on("click",function(){l("input[name='startOrderTime']").val(""),l("input[name='endOrderTime']").val("")}),e("order_pd_List",{})});