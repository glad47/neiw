/** layuiAdmin.pro-v1.0.0 LPPL License By http://www.layui.com/admin/ */
 ;"use strict";function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}layui.define(["admin","table","element","form"],function(e){var t,i=layui.table,r=layui.jquery,n=(layui.element,layui.admin),o=layui.form,s=layui.view,l=layui.setter;o.render(null,"app-content-comment"),o.on("submit(LAY-app-contlist-search)",function(e){var t=e.field;console.log(t),i.reload("customer_listTab",{where:t})}),r(".customer-info-form-search input").bind("input propertychange",function(e){r("*[lay-filter='LAY-app-contlist-search']").click()}),i.render({elem:"#customer_listTab",url:l.baseUrl+"sys/consumer/user/list",cellMinWidth:80,cols:[[{field:"id",title:"id",sort:!0,width:130},{field:"status",title:"状态",width:130,templet:"#customerStatus"},{field:"userSystemId",title:"客户ID",sort:!0,width:130},{field:"userName",title:"用户名",width:130},{field:"email",title:"邮箱",sort:!0,minWidth:196},{field:"countryName",title:"收货国家",sort:!0},{field:"gmtCreate",title:"注册时间",sort:!0},{field:"gmtModified",title:"更新时间",sort:!0},{field:"userType",title:"内外",sort:!0,templet:"#userType",width:130,hide:!0},{field:"userIp",title:"注册IP",sort:!0,hide:!0},{field:"skypeId",title:"Skype",sort:!0,hide:!0},{field:"receiverTelephone",title:"收货电话",minWidth:120,sort:!0,hide:!0},{field:"googleId",title:"Google",sort:!0,align:"right",hide:!0},{field:"facebookId",title:"Facebook",sort:!0,align:"right",hide:!0},{field:"receiverCompany",title:"公司名",sort:!0,align:"right",hide:!0},{field:"receiverAddress",title:"收货地址",sort:!0,align:"right",hide:!0},{field:"receiverCity",title:"收货城市",sort:!0,hide:!0},{field:"jobrole",title:"工作角色",sort:!0,hide:!0},{field:"contact",title:"联系人",sort:!0,hide:!0},{field:"businessType",title:"业务类型",sort:!0,hide:!0},{field:"applications",title:"应用",sort:!0,hide:!0},(t={width:250,align:"center"},_defineProperty(t,"align","center"),_defineProperty(t,"fixed","right"),_defineProperty(t,"toolbar","#role-table-operate-barDemo"),_defineProperty(t,"title","操作"),t)]],done:function(e,t,i){r(".layui-table tr div").each(function(){r(this).text().indexOf("已审核")>0&&r(this).parents("tr").children("td:last").find("a[lay-event='customerInfosh']").remove()})},page:!0}),i.on("tool(customer_listTab)",function(e){var t=e.data;console.log(t),"edit"===e.event?n.popup({title:"编辑客户",area:["40%","100%"],id:"LAY-popup-customer-edit",btn:["提交","取消"],yes:function(e,t){r("#layuiadmin-app-form-submit").click()},btn3:function(){r(".edit-cusInfo input").each(function(e){r(this).removeAttr("lay-verify")})},end:function(){},success:function(e,i){s(this.id).render("/infoManagement/iframeWindow/customer_edit_info",t).done(function(){o.render(null,"customer-add-edit-form-list");var e;o.on("switch(optionUser)",function(t){console.log(t.field),1==t.elem.checked?(layer.msg("已启用"),e=0):(layer.msg("停用"),e=1)});var t;o.on("switch(isneibuUser)",function(e){1==e.elem.checked?(layer.msg("内部用户"),t=1):(layer.msg("客户系统用户"),t=0)});var r=0;o.on("switch(deliveryReport)",function(e){1==e.elem.checked?(layer.msg("需要出货报告"),r=1):(layer.msg("不需要出货报告"),r=0)});var s;o.on("switch(isAuditMark)",function(e){1==e.elem.checked?(layer.msg("需要审核"),s=0):(layer.msg("不需审核"),s=1)});var a;o.on("switch(productionVerification)",function(e){1==e.elem.checked?(layer.msg("需要确定生产资料"),a=1):(layer.msg("不需要确定生产资料"),a=0)}),o.on("submit(layuiadmin-app-form-submit)",function(o){var c=o.field;c.invalidMark=e,c.userType=t,c.auditMark=s,c.deliveryReport=r,c.productionVerification=a,n.req({url:l.baseUrl+"sys/consumer/user/update",type:"POST",data:c,success:function(e){layui.table.reload("customer_listTab"),layer.close(i)}})})})}}):"del"===e.event?layer.confirm("确定删除此客户？",function(e){n.req({url:l.baseUrl+"sys/consumer/user/delete",type:"POST",data:{ids:t.id},success:function(e){layui.table.reload("customer_listTab"),layer.msg("已删除")}})}):"conversionCustomer"===e.event?n.popup({type:1,title:"选择跟单员",btn:["转换","取消"],area:["300px","233px"],yes:function(){r("*[lay-filter='conversionCustomer-submit']").click()},success:function(e,i){s(this.id).render("/infoManagement/iframeWindow/conversionCustomer",t).done(function(){o.render()})}}):"customerInfosh"===e.event&&n.popup({type:1,title:"审核",btn:["审核","取消"],area:["396px","299px"],id:"popupCustomerInfosh",yes:function(){layer.confirm("确定通过审核？",function(){r("input[lay-filter='customersh-submit']").click()})},success:function(){s(this.id).render("/infoManagement/iframeWindow/customer_sh",t).done(function(){o.render()})}})});var a={customerInfo_add:function(){n.popup({type:1,title:"客户新增",shadeClose:!0,shade:!1,maxmin:!1,area:["40%","100%"],content:'<div class="layui-row" id="customer_edit_info"></div>',btn:["确定","取消"],yes:function(e,t){r("#layuiadmin-app-form-submit").click()},success:function(e,t){s("customer_edit_info").render("/infoManagement/iframeWindow/customer_edit_info").then(function(e){}).done(function(){o.render(null,"customer-add-edit-form-list");var e;o.on("switch(productionVerification)",function(t){1==t.elem.checked?(layer.msg("需要确定生产资料"),e=0):(layer.msg("不需要确定生产资料"),e=1)});var i;o.on("switch(optionUser)",function(e){1==e.elem.checked?(layer.msg("已启用"),i=0):(layer.msg("停用"),i=1)});var r;o.on("switch(isneibuUser)",function(e){1==e.elem.checked?(layer.msg("内部用户"),r=1):(layer.msg("客户系统用户"),r=0)});var s;o.on("switch(isAuditMark)",function(e){1==e.elem.checked?(layer.msg("需要审核"),s=0):(layer.msg("不需审核"),s=1)});var a=0;o.on("switch(deliveryReport)",function(e){1==e.elem.checked?(layer.msg("需要出货报告"),a=1):(layer.msg("不需要出货报告"),a=0)}),o.on("submit(layuiadmin-app-form-submit)",function(o){var c=o.field;c.invalidMark=i,c.userType=r,c.auditMark=s,c.deliveryReport=a,c.productionVerification=e,n.req({url:l.baseUrl+"sys/consumer/user/save",type:"POST",data:c,success:function(e){console.log(e),layui.table.reload("customer_listTab"),layer.close(t)}})})})}})}};r(".layui-btn").on("click",function(){var e=r(this).data("type");a[e]&&a[e].call(this)}),e("sys_coustomer",{})});