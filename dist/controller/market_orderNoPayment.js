/** layuiAdmin.pro-v1.0.0 LPPL License By http://www.layui.com/admin/ */
 ;"use strict";function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}layui.define(["admin","table","index","element","form","laydate","jsTools"],function(e){function t(e,t){var i={data:{}};i.data=e,i.tabType=r.orderType;var a,d,o=2,c=0;n.each(i.data,function(e,n){if(c=parseFloat(c+n.subtotal),i.total=c,i.data[e].totalFee=n.subtotal,2===t?(d="marketManagement/iframeWindow/quote_contractS",o=3,r.canOpenView=!0):1===t&&(null==a||""==a?(a=n.productNo,d="marketManagement/iframeWindow/quote_contractA",o=1,r.canOpenView=!0):null!=a&&a!=n.productNo&&(o=2,d="marketManagement/iframeWindow/quote_contractB",layer.msg("选择了不同型号"),r.canOpenView=!0)),null!=r.customerSn&&r.customerSn!=n.productNo.substring(0,3))return layer.alert("请选择同一个客户的订单！"),r.customerSn=null,r.canOpenView=!1,!1}),r.canOpenView&&admin.req({type:"get",url:setter.baseUrl+"sys/consumer/user/info/"+i.data[0].userId,success:function(t){i.userName=t.user.userName,i.companyName=t.user.companName,i.country=t.user.country,i.city=t.user.city,i.address=t.user.address,i.mobilePhone=t.user.mobilePhone,i.postcode=t.user.postcode,i.paymentType=t.user.paymentType,i.deliveryType=t.user.deliveryType,i.contact=t.user.contact,admin.popup({title:"报价合同",area:["100%","100%"],maxmin:!0,btn:["打印","取消"],yes:function(){var e;"1"==o?e="quoteContract_AllA":"2"==o?e="quoteContract_AllB":"3"==o&&(e="quoteContract_AllS"),document.body.innerHTML=document.getElementById(e).innerHTML,window.print(),window.location.reload()},success:function(){i.htmlType=1,view(this.id).render(d,i).done(function(){if(1===o){var t,r=n(".contract-module-three-tab tbody tr").eq(0).find("td").size(),a=i.data.length;a<3?t=4:a>=4&&(t=7);for(var d=r;d<t;d++)n(".contract-module-three-tab tbody").find("tr").append("<td></td>");if(4==t)for(var d=1;d<t;d++)n(".contract-module-three-tab tbody tr").find("td").eq(d).css({width:"27.3%"});else for(var d=1;d<t;d++)n(".contract-module-three-tab tbody tr").find("td").eq(d).css({width:"13.6%"})}var c,s=[],u=[];if(null!=e){for(var f=0,d=0;d<e.length;d++)s[d]=e[d].gmtModified,u[d]=e[d].gmtCreate,null==s[d]&&f++;f==e.length?(c=l.TimeContrast(u),console.log(u)):c=l.TimeContrast(s),n("#contractBotDate").text(c.substring(0,10)),n("#topDate").text(c.substring(0,10))}})}})}})}var i;table=layui.table,view=layui.view,admin=layui.admin,form=layui.form,laydate=layui.laydate,setter=layui.setter,element=layui.element;var n=layui.jquery,l=layui.jsTools,r={orderType:0,canOpenView:!1};laydate.render({elem:"#gmtCreate"}),table.render({elem:"#or_Tabpcb_no_payment",url:setter.baseUrl+"market/quote/noPaymentList",toolbar:"#noPaymentToolbar",cellMinWidth:80,id:"or_Tabpcb_no_payment",page:!0,parseData:function(e){return{code:0,data:e.page.list}},cols:[[{type:"checkbox",fixed:"left"},{field:"id",title:"ID",hide:!0},{field:"productNo",fixed:"left",title:"内部型号",align:"center",width:114,sort:!0},{field:"status",title:"状态",hide:!1,align:"center",templet:"#pcbor_status",width:150,sort:!0},{field:"",title:"文件名",toolbar:"#pcb-file",align:"center",sort:!0},{field:"gerberName",title:"Gerber Name",align:"center",width:254,sort:!0},{field:"pcbType",title:"订单类型",align:"center",width:114,sort:!0},{field:"layerNum",title:"层数",align:"center",width:114,sort:!0},{field:"finishThickness",title:"完成板厚",align:"center",width:134,sort:!0},{field:"quantityPcs",title:"Pcs数",align:"center",width:114,sort:!0},{field:"areaSq",title:"面积",align:"center",width:110,sort:!0},{field:"boardFee",title:"板费",align:"center",width:114,sort:!0},{field:"gmtCreate",title:"创建时间",align:"center",width:165,sort:!0},{field:"userId",title:"User ID",width:80,hide:!0,sort:!0},{field:"orderId",title:"Order ID",align:"center",width:96,hide:!0},{field:"orderType",title:"Order Type",align:"center",width:109,hide:!0},{field:"dimensionsX",title:"DimensionsX",templet:"#type",align:"center",width:114,hide:!0},{field:"dimensionsY",title:"DimensionsY",align:"center",width:114,hide:!0},{field:"panelSizeX",title:"PanelSizeX",align:"center",width:114,hide:!0},(i={field:"panelSizeX",title:"PanelSizeY",align:"center"},_defineProperty(i,"align","center"),_defineProperty(i,"width",114),_defineProperty(i,"hide",!0),i),{field:"panelWayX",title:"PanelWayX",align:"center",width:114,hide:!0},{field:"panelWayY",title:"PanelWayY",align:"center",width:114,hide:!0},{field:"quantityPanel",title:"Quantity Panel",align:"center",width:124,hide:!0},{field:"tg",title:"TG",align:"center",width:80,hide:!0},{field:"material",title:"Material",align:"center",width:110,hide:!0},{field:"cti",title:"CTI",align:"center",width:114,hide:!0},{field:"productCode",title:"Product Code",align:"center",width:124,hide:!0},{field:"halogenFree",title:"Halogen Free",align:"center",width:114,hide:!0},{field:"heatConductivity",title:"Heat Conductivity",align:"center",width:150,hide:!0},{field:"innerLayerCopper",title:"InnerLayer Copper",align:"center",width:150,hide:!0},{field:"stackUp",title:"Stack Up",align:"center",width:95,hide:!0},{field:"innerMinTrack",title:"InnerMin Track",align:"center",width:134,hide:!0},{field:"innerMinSpacing",title:"InnerMin Spacing",align:"center",width:134,hide:!0},{field:"outerLayerCopper",title:"Outer Layer Copper",align:"center",width:134,hide:!0},{field:"outerMinTrack",title:"outerMinTrack",align:"center",width:124,hide:!0},{field:"bgaSize",title:"bgaSize",align:"center",width:90,hide:!0},{field:"outerMinSpacing",title:"outerMinSpacing",align:"center",width:134,hide:!0},{field:"minHoleSize",title:"minHoleSize",align:"center",width:124,hide:!0},{field:"pthCopper",title:"pthCopper",align:"center",width:114,hide:!0},{field:"solderMaskTopColor",title:"solderMaskTopColor",align:"center",width:134,hide:!0},{field:"viaProcess",title:"viaProcess",align:"center",width:124,hide:!0},{field:"solderMaskBotColor",title:"SolderMaskBotColor",align:"center",width:134,hide:!0},{field:"silkScreenTopColor",title:"SilkScreenTopColor",align:"center",width:134,hide:!0},{field:"silkScreenBotColor",title:"silkScreenBotColor",align:"center",width:134,hide:!0},{field:"peelable",title:"Peelable",align:"center",width:85,hide:!0},{field:"peelableBrand",title:"PeelableBrand",align:"center",width:118,hide:!0},{field:"surfaceFinish",title:"SurfaceFinish",align:"center",width:114,hide:!0},{field:"thickness",title:"Thickness",align:"center",width:96,hide:!0},{field:"surfaceArea",title:"SurfaceArea",align:"center",width:114,hide:!0},{field:"panelRoutingPath",title:"PanelRoutingPath",align:"center",width:124,hide:!0},{field:"punchingHoles",title:"PunchingHoles",align:"center",width:124,hide:!0},{field:"punchingSlots",title:"PunchingSlots",align:"center",width:124,hide:!0},{field:"testPoint",title:"TestPoint",align:"center",width:114,hide:!0},{field:"testPointType",title:"TestPointType",align:"center",width:124,hide:!0},{field:"testPoinType",title:"TestPoinType",align:"center",width:114,hide:!0},{field:"testCost",title:"TestCost",align:"center",width:90,hide:!0},{field:"blindHoles",title:"BlindHoles",align:"center",width:92,hide:!0},{field:"edgePlated",title:"EdgePlated",align:"center",width:100,hide:!0},{field:"halfHoleLated",title:"HalfHoleLated",align:"center",width:114,hide:!0},{field:"contrlImpeance",title:"ContrlImpeance",align:"center",width:114,hide:!0},{field:"buriedHoles",title:"BuriedHoles",align:"center",width:114,hide:!0},{field:"carbon",title:"Carbon",align:"center",width:80,hide:!0},{field:"bevellingCamfer",title:"BevellingCamfer",align:"center",width:134,hide:!0},{field:"deepMillRouting",title:"deepMillRouting",align:"center",width:134,hide:!0},_defineProperty({field:"gerberPath",title:"gerberPath",align:"center",hide:!0,width:114},"hide",!0),{field:"remark",title:"Remark",align:"center",width:80,hide:!0},{field:"differentDesign",title:"DifferentDesign",align:"center",width:134,hide:!0},{field:"gmtModified",title:"gmtModified",align:"center",width:114,hide:!0},{field:"uuid",title:"UuId",align:"center",width:80,hide:!0},{field:"stencilFee",title:"StencilFee",align:"center",width:114,hide:!0},{field:"overworkFee",title:"OverworkFee",align:"center",width:114,hide:!0},{field:"buildTime",title:"BuildTime",align:"center",width:114,hide:!0},{field:"isExistSmt",title:"IsExistSmt",align:"center",width:114,hide:!0},{field:"weight",title:"Weight",align:"center",width:80,hide:!0},{field:"nofCore",title:"NofCore",align:"center",width:80,hide:!0},{field:"nofPp",title:"NofPp",align:"center",width:80,hide:!0},{field:"nofHoles",title:"NofHoles",align:"center",width:90,hide:!0},{title:"操作",width:200,align:"center",fixed:"right",toolbar:"#Tabtb-pcb-market-noPayment-option"}]],done:function(e,t,i){/(iPhone|iPad|iPod|iOS|Android)/i.test(navigator.userAgent)&&n("#LAY_app_body").each(function(e){n("a[lay-event='edit']").html('<i class="layui-icon layui-icon-edit"></i>'),n("a[lay-event='search']").html('<i class="layui-icon layui-icon-search"></i>'),n("a[lay-event='del']").html('<i class="layui-icon layui-icon-delete"></i>'),n(".laytable-cell-1-0-22").css({width:"130px"})})}}),table.on("tool(or_Tabpcb_no_payment)",function(e){var t=e.data;"detail"===e.event?admin.popup({title:"订单id:［"+t.id+"］-----------订单时间：［"+t.gmtCreate+"］",area:["100%","100%"],success:function(e,i){view(this.id).render("marketManagement/iframeWindow/order_pcb_detail",t).done(function(){})}}):"del"===e.event?layer.confirm("真的删除订单号为［"+t.productNo+"］吗",function(i){admin.req({type:"post",url:setter.baseUrl+"/market/quote/audit/delete",data:{ids:t.id},done:function(t){layer.msg("删除成功"),e.del()},fail:function(e){layer.msg("服务器异常，稍后再试！")}}),layer.close(i)}):"edit"===e.event?admin.popup({title:"编辑PCB订单信息",area:["45%","561px"],btn:["立即提交","取消"],yes:function(){n(".submit-ok").click()},success:function(e,i){view(this.id).render("marketManagement/iframeWindow/orderPCB_update",t).done(function(){form.render(null,""),form.on("submit(LAY-pcborder-update-submit)",function(e){var t=e.field;return""!=t.remark&&"null"!=t.remark||(t.remark=" "),admin.req({type:"post",url:setter.baseUrl+"/market/quote/audit/update",data:t,done:function(e){layer.msg("订单信息修改成功"),layui.table.reload("or_Tabpcb_no_payment")},fail:function(e){layer.msg("订单信息修改失败，请稍后再试！")}}),layer.close(i),!1})})}}):"pcb-submit"===e.event?layer.confirm("确定提交订单［"+t.productNo+"］?",function(e){t.status=2,admin.req({type:"post",url:setter.baseUrl+"/market/quote/audit/update",data:{id:t.id,status:t.status},done:function(){layer.msg("订单［"+t.productNo+"］提交成功！")},fail:function(){layer.msg("订单［"+t.productNo+"］提交失败，请重试！！！")}}),layui.table.reload("or_Tabpcb_no_payment"),layer.close(e)}):"pcb-sendback"===e.event&&layer.confirm("确定退回订单［"+t.productNo+"］?",function(e){layer.msg("退回"+t.productNo),layui.table.reload("or_Tabpcb_no_payment"),layer.close(e)})}),table.on("toolbar(or_Tabpcb_no_payment)",function(e){var i=table.checkStatus(e.config.id),n=i.data;return i.data.length<1?(layer.msg("请选择一条数据"),!1):void("noPaymentToolbar-lookOrder"==e.event&&t(n,1))}),table.render({elem:"#stencil_orderTab_no_payment",id:"stencil_orderTab_no_payment",url:setter.baseUrl+"market/stencil/noPayment/list",page:!0,toolbar:"#noPaymentToolbar",done:function(){n(window).resize(),n(".layui-table-fixed-r").removeClass("layui-hide")},parseData:function(e){return{code:0,data:e.page.list,count:e.page.totalCount}},where:{access_token:layui.data("layuiAdmin").access_token},cols:[[{type:"checkbox",fixed:"left"},{field:"productNo",title:"Product No",align:"center",width:134,sort:!0,fixed:"left"},{field:"id",title:"ID",hide:!0,sort:!0},{field:"status",fixed:"left",title:"状态",align:"center",width:100,templet:"#stencil-status",sort:!0},{field:"",title:"File",templet:"#stencil-file",align:"center",sort:!0},{field:"gerberName",title:"gerberName",align:"center",width:224,sort:!0},{field:"totalStencilFee",title:"TotalStencilFee($)",align:"center",width:144,sort:!0},{field:"stencilType",title:"Stencil Type",align:"center",width:124,sort:!0},{field:"stencilSide",title:"Stencil Side",align:"center",width:124,sort:!0},{field:"quantity",title:"Quantity",align:"center",width:114,sort:!0},{field:"size",title:"Size",align:"center",width:80,sort:!0},{field:"gmtCreate",title:"gmtCreate",align:"center",width:165,sort:!0},{field:"quoteId",title:"Quote ID",align:"center",width:114,hide:!0},{field:"thickness",title:"Thickness",align:"center",width:114,hide:!0},{field:"existingFiducials",title:"Existing Fiducials",align:"center",width:145,hide:!0},{field:"stencilSizeX",title:"stencilSizeX",align:"center",width:124,hide:!0},{field:"stencilSizeY",title:"stencilSizeY",align:"center",width:124,hide:!0},{field:"stencilAreaX",title:"stencilSizeY",align:"center",width:124,hide:!0},{field:"stencilAreaY",title:"stencilSizeY",align:"center",width:124,hide:!0},{field:"userId",title:"User ID",align:"center",width:100,hide:!0},{field:"gmtModified",title:"gmtModified",hide:!0,width:124},{field:"weight",title:"Weight",align:"center",width:85,sort:!0},{field:"gerberPath",title:"gerberPath",hide:!0,width:124},{field:"note",title:"Note",align:"center",width:80,hide:!0,sort:!0},{title:"操作",fixed:"right",align:"center",toolbar:"#Tabtb-stencil-market-noPayment-option",width:260}]]}),table.on("tool(stencil_orderTab_no_payment)",function(e){var t=e.data;"detail"===e.event?admin.popup({title:"订单号［"+t.productNo+"]---订单时间［"+t.gmtCreate+"］",area:["45%","70%"],success:function(e,i){view(this.id).render("marketManagement/iframeWindow/order_stencil_detail",t).done(function(){})}}):"edit"===e.event?admin.popup({title:"编辑：订单号［"+t.productNo+"]",area:["45%","70%"],yes:function(){n("button[lay-filter='LAY-stencilorder-update-submit']").click()},success:function(e,i){view(this.id).render("marketManagement/iframeWindow/orderStencil_update",t).done(function(){form.render(),form.on("submit(LAY-stencilorder-update-submit)",function(e){var t=e.field;return console.log("提交的字段信息："+JSON.stringify(t)),admin.req({type:"post",url:setter.baseUrl+"/market/stencil/audit/update",data:t,done:function(e){layer.msg("订单信息修改成功"),layui.table.reload("stencil_orderTab_no_payment")},fail:function(e){layer.msg("订单信息修改失败，请稍后再试！")}}),layer.closeAll(),!1})})}}):"del"===e.event?layer.confirm("真的删除订单号为［"+t.productNo+"］吗",function(i){console.log(111),admin.req({type:"post",url:setter.baseUrl+"market/stencil/audit/delete",data:{ids:t.id},done:function(t){layer.msg("删除成功"),e.del()},fail:function(e){layer.msg("服务器异常，稍后重试！")}}),layer.close(i)}):"stencil-submit"===e.event?layer.confirm("确定提交订单［"+t.productNo+"］?",function(e){t.status=2,admin.req({type:"post",url:setter.baseUrl+"market/stencil/audit/update",data:{id:t.id,status:t.status},done:function(){layer.msg("订单［"+t.productNo+"］提交成功！"),console.log("提交的信息为"+JSON.stringify(t))},fail:function(){layer.msg("订单［"+t.productNo+"］提交失败，请重试！！！")}}),layui.table.reload("stencil_orderTab_no_payment"),layer.close(e)}):"stencil-sendback"===e.event&&layer.confirm("确定退回订单［"+t.productNo+"］?",function(e){layer.msg("退回"+t.productNo),layui.table.reload("stencil_orderTab_no_payment"),layer.close(e)})}),form.on("submit(LAY-app-noPayment-search)",function(e){var t,i=e.field;delete i.quiz,0===r.orderType?t="or_Tabpcb_no_payment":1===r.orderType&&(t="stencil_orderTab_no_payment"),table.reload(t,{where:i})}),form.on("select(no-payment-search-sel)",function(e){n("*[lay-filter='LAY-app-noPayment-search']").click()}),n(".no-payment-search input").bind("input propertychange",function(e){n("*[lay-filter='LAY-app-noPayment-search']").click()}),element.on("tab(pcdorstencil_tab)",function(e){r.orderType=e.index;var t=e.index;form.on("submit(LAY-app-orderReview-search)",function(e){var i=e.field;delete i.quiz,0===t?(layer.msg("PCBOrders"),table.reload("or_Tabpcb",{where:i})):1===t&&(layer.msg("StencilOrders"),table.reload("stencil_orderTab_no_payment",{where:i}))})}),table.on("toolbar(stencil_orderTab_no_payment)",function(e){var i=table.checkStatus(e.config.id),n=i.data;return i.data.length<1?(layer.msg("请选择一条数据"),!1):void("noPaymentToolbar-lookOrder"==e.event&&t(n,2))}),table.render({elem:"#smt_orderTab_no_payment",id:"smt_orderTab_no_payment",url:setter.baseUrl+"market/assembly/listByStatus",page:!0,toolbar:"#noPaymentToolbar",done:function(){n(window).resize(),n(".layui-table-fixed-r").removeClass("layui-hide")},parseData:function(e){return{code:0,data:e.page.list,count:e.page.totalCount}},where:{status:2},cols:[[{type:"checkbox",fixed:"left"},{field:"id",title:"ID",hide:!0,sort:!0},{field:"quoteId",title:"ID",hide:!0,sort:!0},{field:"productNo",title:"Product No",align:"center",width:134,sort:!0},{field:"status",fixed:"left",title:"状态",align:"center",width:100,templet:"#Tabtb-smt-market-orderReview-status",sort:!0},{field:"",title:"File",templet:"#stencil-file",align:"center",sort:!0},{field:"gerberName",title:"gerberName",align:"center",width:224,sort:!0},{field:"smtPartNum",title:"SMT PartNum",align:"center",width:124,sort:!0},{field:"throughHolePartNum",title:"Through Hole PartNum",align:"center",width:224,sort:!0},{field:"assemblySide",title:"Assembly Side",align:"center",width:165,sort:!0},{field:"invoiceNo",title:"Invoice No",align:"center",width:134,sort:!0},{field:"totalAssemblyFee",title:"TotalAssemblyFee($)",align:"center",width:144,sort:!0},{field:"assemblyType",title:"Stencil Type",align:"center",width:124,sort:!0},{field:"uniquePartNum",title:"Unique PartNum",align:"center",width:124,sort:!0},{field:"quantity",title:"Quantity",align:"center",width:114,sort:!0},{field:"gmtCreate",title:"gmtCreate",align:"center",width:165,sort:!0},{field:"orderId",title:"Order ID",align:"center",width:114,hide:!0},{field:"orderNo",title:"Order No",align:"center",width:114,hide:!0},{field:"isLock",title:"Is Lock",align:"center",width:114,hide:!0},{field:"userId",title:"User ID",align:"center",width:100,hide:!0},{field:"gmtModified",title:"gmtModified",width:124,sort:!0},{field:"gerberPath",title:"gerberPath",hide:!0,width:124},{field:"ordertime",title:"Order Time",width:124,sort:!0},{field:"remark",title:"Remark",align:"center",width:80,hide:!0},{title:"操作",fixed:"right",align:"center",toolbar:"#Tabtb-smt-market-noPayment-option",width:260}]]}),table.on("tool(smt_orderTab_no_payment)",function(e){var t=e.data;"detail"===e.event?admin.popup({title:"订单号［"+t.productNo+"]---订单时间［"+t.gmtCreate+"］",area:["45%","70%"],success:function(e,i){view(this.id).render("marketManagement/iframeWindow/order_smt_detail",t).done(function(){})}}):"edit"===e.event?admin.popup({title:"编辑：订单号［"+t.productNo+"]",area:["45%","70%"],success:function(e,i){view(this.id).render("marketManagement/iframeWindow/orderSMT_update",t).done(function(){form.render(null,""),form.on("submit(LAY-smtorder-update-submit)",function(e){var t=e.field;return console.log("提交的字段信息："+JSON.stringify(t)),admin.req({type:"post",url:setter.baseUrl+"market/assembly/update",data:t,done:function(e){layer.msg("订单信息修改成功"),layui.table.reload("smt_orderTab_no_payment")},fail:function(e){layer.msg("订单信息修改失败，请稍后再试！")}}),layer.close(i),!1})})}}):"del"===e.event?layer.confirm("真的删除(SMT)订单号为［"+t.id+"］吗",function(i){admin.req({type:"post",url:setter.baseUrl+"market/assembly/delete",data:{ids:t.id},done:function(t){layer.msg("删除成功"),e.del()},fail:function(e){layer.msg("服务器异常，稍后再试！")}}),layer.close(i)}):"smt-submit"===e.event?layer.confirm("确定提交订单［"+t.productNo+"］?",function(e){t.status=2,admin.req({type:"post",url:setter.baseUrl+"market/assembly/okPaymentList/submit",data:{id:t.id,status:t.status},done:function(){layer.msg("订单［"+t.productNo+"］提交成功！"),console.log("提交的信息为"+JSON.stringify(t))},fail:function(){layer.msg("订单［"+t.productNo+"］提交失败，请重试！！！")}}),layui.table.reload("smt_orderTab_no_payment"),layer.close(e)}):"stencil-sendback"===e.event&&layer.confirm("确定退回订单［"+t.productNo+"］?",function(e){layer.msg("退回"+t.productNo),layui.table.reload("smt_orderTab_no_payment"),layer.close(e)})}),form.on("submit(LAY-app-orderReview-search)",function(e){var t=e.field;delete t.quiz,table.reload("smt_orderTab_no_payment",{where:t})}),n("#noPayment-operation").on("click",function(){n(this).text("隐藏操作"==n(this).text()?"显示操作":"隐藏操作"),n(".layui-table-fixed-r").toggle("slow")}),/(iPhone|iPad|iPod|iOS|Android)/i.test(navigator.userAgent)&&(n("#orderReview_searll").css({display:""}),n("#orderReview_pcsear").css({display:"none"}),form.on("select(orderReview-search-select)",function(e){var t=e.value,i=e.elem.selectedIndex,l=e.elem.options[i].text,r=n("#orderReview_sinp");null!=t||""!=t?(r.attr({placeholder:l}),n("input[id='orderReview_sinp']").attr("name",t)):r.attr("placeholder","请选取搜索条件")})),e("market_orderNoPayment",{})});