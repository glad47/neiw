/** layuiAdmin.pro-v1.0.0 LPPL License By http://www.layui.com/admin/ */
 ;"use strict";function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}layui.define(["admin","table","index","element","form","laydate"],function(e){function t(){table.render({elem:"#sqeManaOrderT_tabPcb",url:setter.baseUrl+"/sqe/pcborder/orderTogether/list",toolbar:"#ord_tother_tb",cellMinWidth:80,id:"sqeManaOrderT_tabPcb",page:!0,parseData:function(e){return{code:0,data:e.page.list,count:e.page.totalCount}},cols:[[{type:"checkbox"},_defineProperty({field:"status",title:"状态",templet:"#pcb",width:115},"templet",'<div>{{ d.status == 4 ? "待确认交期" : "" }}</div>'),{field:"gmtCreate",title:"报价时间",width:166},{field:"supplierNo",title:"供应商编号",width:124},{field:"factoryMake",title:"供应商厂编",width:117},{field:"productNo",title:"聚谷型号",width:124},{field:"pcbName",title:"聚谷产品型号",width:144},{field:"quantityPcs",title:"订单数量(PCS)",width:134},{field:"unitPrice",title:"单价",width:96},{field:"subtotal",title:"合计",width:96},{field:"remark",title:"订单备注",width:168},{field:"engineeringFee",title:"工程费",width:96,hide:!0},{field:"testCostFee",title:"飞针费",width:96,hide:!0},{field:"testCostFee",title:"测试架费",width:96,hide:!0},{field:"toolingFee",title:"模具",width:96,hide:!0},{field:"supplierQuoteNo",title:"报价单号",hide:!0},{field:"dimensionsX",title:"dimensionsX",hide:!0},{field:"dimensionsY",title:"dimensionsY",hide:!0},{field:"panelSizeX",title:"panelSizeX",hide:!0},{field:"panelSizeY",title:"panelSizeY",hide:!0},{field:"panelWayX",title:"panelWayX",hide:!0},{field:"panelWayY",title:"panelWayY",hide:!0},{field:"gerberName",title:"gerberName",hide:!0},{field:"gerberPath",title:"gerberPath",hide:!0},{fixed:"right",title:"操作",toolbar:"#scmManaOrderT_tabbar",width:150}]],done:function(e,t,i){}})}function i(){table.render({elem:"#sqeManaOrderT_tabStencil",url:setter.baseUrl+"sqe/stencilorder/orderTogether/list",toolbar:"#ord_tother_tbS",cellMinWidth:80,id:"sqeManaOrderT_tabStencil",page:!0,parseData:function(e){return{code:0,data:e.page.list,count:e.page.totalCount}},cols:[[{type:"checkbox"},_defineProperty({field:"status",title:"状态",templet:"#pcb",width:115},"templet",'<div>{{ d.status == 4 ? "待确认交期" : "" }}</div>'),{field:"gmtCreate",title:"报价时间",width:166},{field:"supplierNo",title:"供应商编号",width:124},{field:"factoryMake",title:"供应商厂编",width:117},{field:"productNo",title:"聚谷型号",width:124},{field:"pcbName",title:"聚谷产品型号",width:144},{field:"quantityPcs",title:"订单数量(PCS)",width:134},{field:"unitPrice",title:"单价",width:96},{field:"subtotal",title:"合计",width:96},{field:"remark",title:"订单备注",width:168},{field:"engineeringFee",title:"工程费",width:96,hide:!0},{field:"testCostFee",title:"飞针费",width:96,hide:!0},{field:"testCostFee",title:"测试架费",width:96,hide:!0},{field:"toolingFee",title:"模具",width:96,hide:!0},{field:"supplierQuoteNo",title:"报价单号",hide:!0},{field:"dimensionsX",title:"dimensionsX",hide:!0},{field:"dimensionsY",title:"dimensionsY",hide:!0},{field:"panelSizeX",title:"panelSizeX",hide:!0},{field:"panelSizeY",title:"panelSizeY",hide:!0},{field:"panelWayX",title:"panelWayX",hide:!0},{field:"panelWayY",title:"panelWayY",hide:!0},{field:"gerberName",title:"gerberName",hide:!0},{field:"gerberPath",title:"gerberPath",hide:!0},{fixed:"right",title:"操作",toolbar:"#scmManaOrderT_tabbarS",width:150}]],done:function(e,t,i){}})}table=layui.table,view=layui.view,admin=layui.admin,form=layui.form,setter=layui.setter,element=layui.element;var l=layui.jquery;t();var d={orderType:1};element.on("tab(tabot-scmManagement)",function(e){console.log(e.index),layer.msg(e.index),0===e.index?(d.orderType=1,t()):1===e.index?(d.orderType=2,i()):2===e.index&&(d.orderType=3)}),table.on("toolbar(sqeManaOrderT_tabPcb)",function(e){var t=table.checkStatus(e.config.id);if("submit"===e.event){for(var i=t.data,l=null,d=0;d<i.length;d++)null==l?l=i[d].supplierContractNo:l+=","+i[d].supplierContractNo;layer.confirm("确认提交 ["+l+"] ?",function(e){console.log(i),admin.req({type:"post",data:{supplierContractNo:l,orderId:i[0].orderId},url:setter.baseUrl+"sqe/pcborder/submitByOt",success:function(t){"0"==t.code&&(layer.alert("提交成功！！"),table.reload("sqeManaOrderT_tabPcb"),layer.close(e))}})})}}),table.on("tool(sqeManaOrderT_tabPcb)",function(e){var t=e.data;"edit"==e.event?(layer.msg("编辑操作"),admin.popup({title:"订单协同编辑",area:["434px","448px"],btn:["保存","取消"],yes:function(e,t){layer.msg("提交信息"),l(".otEdit").click()},success:function(e,i){var l=t.id,d=t.supplierId,r=t.orderId;view(this.id).render("sqeManagement/iframeWindow/order_together_edit",t).done(function(){form.on("submit(otEdit)",function(e){var t=e.field;return t.id=l,t.orderId=r,t.supplierId=d,console.log(t),admin.req({type:"post",data:t,url:setter.baseUrl+"scm/ordersupplier/update",success:function(e){layer.alert("订单协同修改成功"),table.reload("sqeManaOrderT_tabPcb"),layer.close(i)}}),!1})})}})):"search"==e.event&&layer.msg("查看订单协同")}),table.on("toolbar(sqeManaOrderT_tabStencil)",function(e){var t=table.checkStatus(e.config.id);if("submit"===e.event){for(var i=t.data,l=null,d=0;d<i.length;d++)null==l?l=i[d].supplierContractNo:l+=","+i[d].supplierContractNo;layer.confirm("确认提交 ["+l+"] ?",function(e){console.log(i),admin.req({type:"post",data:{supplierContractNo:l,orderId:i[0].orderId},url:setter.baseUrl+"sqe/stencilorder/submitByOt",success:function(t){"0"==t.code&&(layer.alert("Stencil 提交成功！！"),table.reload("sqeManaOrderT_tabStencil"),layer.close(e))}})})}}),e("sqeMana_order_together",{})});