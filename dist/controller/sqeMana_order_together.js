/** layuiAdmin.pro-v1.0.0 LPPL License By http://www.layui.com/admin/ */
 ;"use strict";function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}layui.define(["admin","table","index","element","form","laydate"],function(e){function t(){table.render({elem:"#sqeManaOrderT_tabPcb",url:setter.baseUrl+"/sqe/pcborder/orderTogether/list",toolbar:"#ord_tother_tb",cellMinWidth:80,id:"sqeManaOrderT_tabPcb",page:!0,parseData:function(e){return{code:0,data:e.page.list,count:e.page.totalCount}},cols:[[{type:"checkbox"},_defineProperty({field:"status",title:"状态",templet:"#pcb",width:115},"templet",'<div>{{ d.status == 4 ? "待确认交期" : "" }}</div>'),{field:"gmtCreate",title:"报价时间",width:168},{field:"supplierNo",title:"供应商编号"},{field:"factoryMake",title:"供应商厂编"},{field:"productNo",title:"聚谷型号"},{field:"pcbName",title:"聚谷物料号"},{field:"quantityPcs",title:"订单数量(PCS)"},{field:"unitPrice",title:"单价"},{field:"subtotal",title:"合计"},{field:"remark",title:"订单备注"},{field:"engineeringFee",title:"工程费",width:96,hide:!0},{field:"testCostFee",title:"飞针费",width:96,hide:!0},{field:"testCostFee",title:"测试架费",width:96,hide:!0},{field:"toolingFee",title:"模具",width:96,hide:!0},{field:"supplierQuoteNo",title:"报价单号",hide:!0},{field:"dimensionsX",title:"dimensionsX",hide:!0},{field:"dimensionsY",title:"dimensionsY",hide:!0},{field:"panelSizeX",title:"panelSizeX",hide:!0},{field:"panelSizeY",title:"panelSizeY",hide:!0},{field:"panelWayX",title:"panelWayX",hide:!0},{field:"panelWayY",title:"panelWayY",hide:!0},{field:"gerberName",title:"gerberName",hide:!0},{field:"gerberPath",title:"gerberPath",hide:!0},{fixed:"right",title:"操作",toolbar:"#scmManaOrderT_tabbar",width:150}]],done:function(e,t,i){}})}function i(){table.render({elem:"#sqeManaOrderT_tabStencil",url:setter.baseUrl+"sqe/stencilorder/orderTogether/list",toolbar:"#ord_tother_tbS",cellMinWidth:80,id:"sqeManaOrderT_tabStencil",page:!0,parseData:function(e){return{code:0,data:e.page.list,count:e.page.totalCount}},cols:[[{type:"checkbox"},_defineProperty({field:"status",title:"状态",templet:"#pcb",width:115},"templet",'<div>{{ d.status == 4 ? "待确认交期" : "" }}</div>'),{field:"gmtCreate",title:"报价时间",width:168},{field:"supplierNo",title:"供应商编号"},{field:"factoryMake",title:"供应商厂编"},{field:"productNo",title:"聚谷型号"},{field:"pcbName",title:"聚谷物料号"},{field:"quantityPcs",title:"订单数量(PCS)"},{field:"unitPrice",title:"单价"},{field:"subtotal",title:"合计"},{field:"remark",title:"订单备注"},{field:"engineeringFee",title:"工程费",width:96,hide:!0},{field:"testCostFee",title:"飞针费",width:96,hide:!0},{field:"testCostFee",title:"测试架费",width:96,hide:!0},{field:"toolingFee",title:"模具",width:96,hide:!0},{field:"supplierQuoteNo",title:"报价单号",hide:!0},{field:"dimensionsX",title:"dimensionsX",hide:!0},{field:"dimensionsY",title:"dimensionsY",hide:!0},{field:"panelSizeX",title:"panelSizeX",hide:!0},{field:"panelSizeY",title:"panelSizeY",hide:!0},{field:"panelWayX",title:"panelWayX",hide:!0},{field:"panelWayY",title:"panelWayY",hide:!0},{field:"gerberName",title:"gerberName",hide:!0},{field:"gerberPath",title:"gerberPath",hide:!0},{fixed:"right",title:"操作",toolbar:"#scmManaOrderT_tabbarS",width:150}]],done:function(e,t,i){}})}table=layui.table,view=layui.view,admin=layui.admin,form=layui.form,setter=layui.setter,element=layui.element;var r=layui.jquery;t();var l={orderType:1};element.on("tab(tabot-scmManagement)",function(e){console.log(e.index),0===e.index?(l.orderType=1,t()):1===e.index?(l.orderType=2,i()):2===e.index&&(l.orderType=3)}),table.on("toolbar(sqeManaOrderT_tabPcb)",function(e){var t=table.checkStatus(e.config.id);if("submit"===e.event){for(var i=t.data,r=null,l=0;l<i.length;l++)null==r?r=i[l].supplierContractNo:r!=i[l].supplierContractNo&&null!=r&&(r+=","+i[l].supplierContractNo);if(t.data.length<1)return layer.msg("请选择一条数据"),!1;layer.confirm("确认提交 ["+r+"] ?",function(e){console.log(i),admin.req({type:"post",data:{supplierContractNo:r,orderId:i[0].orderId},url:setter.baseUrl+"sqe/pcborder/submitByOt",success:function(t){"0"==t.code&&(layer.alert("提交成功！！"),table.reload("sqeManaOrderT_tabPcb"),layer.close(e))}})})}}),table.on("tool(sqeManaOrderT_tabPcb)",function(e){var t=e.data;"edit"==e.event?admin.popup({title:"订单协同编辑",area:["434px","448px"],btn:["保存","取消"],yes:function(e,t){r(".otEdit").click()},success:function(e,i){var r=t.id,l=t.supplierId,a=t.orderId;view(this.id).render("sqeManagement/iframeWindow/order_together_edit",t).done(function(){form.on("submit(otEdit)",function(e){var t=e.field;return t.id=r,t.orderId=a,t.supplierId=l,console.log(t),admin.req({type:"post",data:t,url:setter.baseUrl+"scm/ordersupplier/update",success:function(e){layer.alert("订单协同修改成功"),table.reload("sqeManaOrderT_tabPcb"),layer.close(i)}}),!1})})}}):"search"==e.event?(layer.msg("查看订单协同"),admin.popup({title:"订单id:［"+t.id+"］-----------订单时间：［"+t.gmtCreate+"］",area:["45%","70%"],success:function(e,i){view(this.id).render("marketManagement/iframeWindow/order_pcb_detail",t).done(function(){})}})):"del"==e.event&&(layer.msg("删除操作！"),layer.confirm("确定删除？",function(){admin.req({type:"post",data:{ids:t.id},url:setter.baseUrl+"scm/ordersupplier/delete",success:function(){layer.alert("删除成功！"),e.del(),table.reload("sqeManaOrderT_tabPcb"),layer.closeAll()}})}))}),table.on("toolbar(sqeManaOrderT_tabStencil)",function(e){var t=table.checkStatus(e.config.id);if("submit"===e.event){for(var i=t.data,r=null,l=0;l<i.length;l++)null==r?r=i[l].supplierContractNo:r+=","+i[l].supplierContractNo;if(t.data.length<1)return layer.msg("请选择一条数据"),!1;layer.confirm("确认提交 ["+r+"] ?",function(e){console.log(i),admin.req({type:"post",data:{supplierContractNo:r,orderId:i[0].orderId},url:setter.baseUrl+"sqe/stencilorder/submitByOt",success:function(t){"0"==t.code&&(layer.alert("Stencil 提交成功！！"),table.reload("sqeManaOrderT_tabStencil"),layer.close(e))}})})}}),table.on("tool(sqeManaOrderT_tabStencil)",function(e){var t=e.data;"edit"==e.event?admin.popup({title:"订单协同编辑",area:["434px","448px"],btn:["保存","取消"],yes:function(e,t){layer.msg("提交信息"),r(".otEdit").click()},success:function(e,i){var r=t.id,l=t.supplierId,a=t.orderId;view(this.id).render("sqeManagement/iframeWindow/order_together_edit",t).done(function(){form.on("submit(otEdit)",function(e){var t=e.field;return t.id=r,t.orderId=a,t.supplierId=l,console.log(t),admin.req({type:"post",data:t,url:setter.baseUrl+"scm/ordersupplier/update",success:function(e){layer.alert("订单协同修改成功"),table.reload("sqeManaOrderT_tabStencil"),layer.close(i)}}),!1})})}}):"search"==e.event?admin.popup({title:"订单id:［"+t.id+"］-----------订单时间：［"+t.gmtCreate+"］",area:["837px","373px"],success:function(e,i){view(this.id).render("marketManagement/iframeWindow/order_stencil_detail",t).done(function(){})}}):"del"==e.event&&layer.confirm("确定删除？",function(){admin.req({type:"post",data:{ids:t.id},url:setter.baseUrl+"scm/ordersupplier/delete",success:function(){layer.alert("删除成功！"),e.del(),table.reload("sqeManaOrderT_tabPcb"),layer.closeAll()}})})}),e("sqeMana_order_together",{})});