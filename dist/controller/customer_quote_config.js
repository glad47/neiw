/** layuiAdmin.pro-v1.0.0 LPPL License By http://www.layui.com/admin/ */
 ;"use strict";function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}layui.define(["admin","table","element","form"],function(e){function t(e,t,a){console.log(e+" "+t+" "+a),n.ajaxSettings.async=!1,n.get(u.imUrl+"getAllParameter",{parameterTypeId:e},function(e){n("select[name='g']").empty(),n("select[name='h']").empty(),n.each(e.data,function(e,a){a.id===t?n("select[name='g']").append("<option value='"+a.id+"' selected>"+a.parameterName+"</option>"):n("select[name='g']").append("<option value='"+a.id+"'>"+a.parameterName+"</option>")})}),n.get(u.imUrl+"getAllParameterValue",{parameterId:t},function(e){var t=n("select[name='h']");t.empty(),n.each(e.data,function(e,t){t.id===a?n("select[name='h']").append("<option value='"+t.id+"' selected>"+t.parameterValue+"</option>"):n("select[name='h']").append("<option value='"+t.id+"'>"+t.parameterValue+"</option>")})}),n.ajaxSettings.async=!0,r.render()}var a,i=layui.table,n=layui.jquery,o=(layui.element,layui.admin),r=layui.form,l=layui.view,u=layui.setter;r.render(null,"app-content-comment"),r.on("select",function(e){}),r.on("select(f)",function(e){n.get(u.imUrl+"getAllParameter",{parameterTypeId:e.value},function(e){n("select[name='g']").empty(),n("select[name='h']").empty(),n.each(e.data,function(e,t){n("select[name='g']").append("<option value='"+t.id+"'>"+t.parameterName+"</option>")}),r.render()})}),r.on("select(g)",function(e){n.get(u.imUrl+"getAllParameterValue",{parameterId:e.value},function(e){var t=n("select[name='h']");t.empty(),n.each(e.data,function(e,t){n("select[name='h']").append("<option value='"+t.id+"'>"+t.parameterValue+"</option>")}),r.render()})}),i.render({elem:"#customer_quote_config_listTab",url:u.imUrl+"getAllQuoteConfigByConsumerAdjusten",cellMinWidth:80,cols:[[{field:"consumerAdjustQuoteId",title:"id",sort:!0},{field:"userSysName",title:"客户代码"},{field:"userEmail",title:"用户邮箱",sort:!0},{field:"id",title:"报价id",sort:!0},{field:"areaParameterName",title:"平米",sort:!0},{field:"pcbTypeName",title:"基材",sort:!0},{field:"layerNum",title:"层数",sort:!0},{field:"urgentType",title:"加急类型",sort:!0},{field:"parameterTypeName",title:"参数类型",sort:!0,align:"right"},{field:"parameterName",title:"参数名",sort:!0,align:"right"},{field:"parameterValue",title:"参数值",sort:!0,align:"right"},{field:"premiumType",title:"加价类别",sort:!0},{field:"quote",title:"正常报价",sort:!0},{field:"adjustedQuote",title:"调整价",sort:!0},(a={width:150,align:"center"},_defineProperty(a,"align","center"),_defineProperty(a,"fixed","right"),_defineProperty(a,"toolbar","#customer-quote-config-operate"),_defineProperty(a,"title","操作"),a)]],page:!0}),i.on("tool(customer_quote_config_listTab)",function(e){var a=e.data;console.log(a),"edit"===e.event?o.popup({title:"编辑客户报价配置",area:["850px","440px"],id:"LAY-popup-customer-edit",btn:["提交","取消"],yes:function(e,t){n("#layuiadmin-app-form-submit").click()},end:function(){},success:function(e,i){l(this.id).render("/infoManagement/iframeWindow/customer_quote_config_form",a).done(function(){r.render(null,"layuiadmin-app-form-list"),t(a.parameterTypeId,a.parameterNameId,a.parameterValueId),r.on("submit(layuiadmin-app-form-submit)",function(e){var t=e.field;o.req({url:u.baseUrl+"sys/consumeradjustenquote/update",type:"POST",data:t,success:function(e){layui.table.reload("customer_quote_config_listTab"),layer.close(i)}})})})}}):"del"===e.event&&layer.confirm("确定删除此报价？",function(e){o.req({url:u.baseUrl+"sys/consumeradjustenquote/delete",type:"POST",data:{ids:a.consumerAdjustQuoteId},success:function(e){layui.table.reload("customer_quote_config_listTab"),layer.msg("已删除")}})})});var s={customerQuoteConfig_add:function(){o.popup({type:1,title:"客户报价配置新增",shadeClose:!0,shade:!1,maxmin:!1,area:["850px","700px"],content:'<div class="layui-row" id="customer_edit_info"></div>',btn:["添加","查询","取消"],yes:function(e,t){n("#layuiadmin-app-form-submit").click()},btn2:function(e,t){return n("#layuiadmin-app-form-submit").click(),!1},success:function(e,t){l("customer_edit_info").render("/infoManagement/iframeWindow/customer_quote_config_form").then(function(e){}).done(function(){r.render(null,"layuiadmin-app-form-list"),r.on("submit(layuiadmin-app-form-submit)",function(e){var a=e.field;console.log(a);var a=e.field;o.req({url:u.imUrl+"findQuoteConfig",type:"POST",data:{areaSq:a.a,pcbtype:a.b,layerNum:a.c,urgentType:a.d,parameterType:a.f,parameterName:a.g,parameter:a.h,premiumType:a.e},success:function(e){0==e.code&null!=e.data?(a.quoteConfigId=e.data.id,n("#imgtalk").attr("value",e.data.quote)):layer.msg("没有该报价！")},async:!1}),console.log(a),""!==a.quote&&""!==a.adjustedQuote&&o.req({url:u.baseUrl+"sys/consumeradjustenquote/save",type:"POST",data:a,success:function(e){console.log(e),0===e.code?(layui.table.reload("customer_quote_config_listTab"),layer.close(t)):layer.msg(e.msg)}})})})}})}};n(".layui-btn").on("click",function(){var e=n(this).data("type");s[e]&&s[e].call(this)}),e("customer_quote_config",{})});