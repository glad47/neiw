/** layuiAdmin.pro-v1.0.0 LPPL License By http://www.layui.com/admin/ */
 ;"use strict";layui.define(["admin","table","index","element","form"],function(e){var i,t=layui.jquery,n=layui.table,l=layui.view,r=layui.admin,s=layui.form,a=layui.setter;layui.element;s.render(null,"user_info_formlist"),s.on("submit(LAY-user-info-search)",function(e){var i=e.field;n.reload("user_infoTab",{where:i})}),t(".user-info-search-form input").bind("input propertychange",function(e){t("*[lay-filter='LAY-user-info-search']").click()}),s.on("select(search-dept-sel)",function(e){t("*[lay-filter='LAY-user-info-search']").click()}),n.render({elem:"#user_infoTab",url:a.baseUrl+"sys/user/list",cellMinWidth:80,id:"user_infoTab",toolbar:!0,page:!0,cols:[[{field:"userId",title:"用户ID",sort:!0,width:90,align:"center"},{field:"username",title:"用户名",width:180,align:"center"},{field:"mobile",title:"办公电话",minWidth:106,align:"center"},{field:"deptId",title:"部门id",sort:!0,width:150,align:"center",hide:!0},{field:"deptName",title:"部门",sort:!0,width:150,align:"center"},{field:"jobNumber",title:"工号",align:"center",sort:!0,width:120},{field:"skype",title:"Skype",sort:!0,width:120,align:"center"},{field:"email",title:"Email",sort:!0,align:"center"},{field:"status",title:"状态",sort:!0,align:"center",templet:"#user_status"},{field:"createUserId",title:"创建人",align:"center"},{field:"createTime",title:"创建时间",width:200,align:"center"},{title:"操作",width:115,align:"center",fixed:"right",toolbar:"#user_info_Toolbar"}]],done:function(){/(iPhone|iPad|iPod|iOS|Android)/i.test(navigator.userAgent)&&t("#LAY_app_body").each(function(e){t("a[lay-event='edit']").html('<i class="layui-icon layui-icon-edit"></i>'),t("a[lay-event='search']").html('<i class="layui-icon layui-icon-search"></i>'),t("a[lay-event='del']").html('<i class="layui-icon layui-icon-delete"></i>'),t(".laytable-cell-1-0-22").css({width:"130px"})})}}),n.on("tool(user_infoTab)",function(e){var t=e.data,o=t.userId,u=t.username,d=t.deptName;"edit"===e.event?(i="useredit",r.req({type:"get",url:a.baseUrl+"sys/user/info/"+o,success:function(e){var i=e.user;i.deptName=d,console.log(i),r.popup({title:"修改用户信息",shadeClose:!0,shade:!1,maxmin:!0,btn:["提交"]["取消"],id:"userAdd_form",area:["766px","510px"],success:function(e,t){l(this.id).render("/infoManagement/iframeWindow/user_edit_info",i).done(function(){var e;s.render(null,"user_editInfo_form"),s.on("switch(switchUser)",function(i){1==i.elem.checked?(layer.msg("已启用"),e=1):(layer.msg("停用"),e=0)}),s.on("submit(LAY-user-editInfo-submit)",function(i){var n=i.field;return n.userId=o,n.status=e,console.log("用户修改表单提交的信息为："+JSON.stringify(n)),r.req({type:"post",url:a.baseUrl+"sys/user/update",data:n,done:function(e){console.log(e),layer.msg("用户信息修改成功"),layui.table.reload("user_infoTab")},fail:function(e){layer.msg("用户信息修改失败，请稍后再试！")}}),layer.close(t),!1})})}})}})):"del"===e.event&&layer.confirm("确定删除用户名名为［"+u+"］吗？",function(i){r.req({type:"post",url:a.baseUrl+"sys/user/delete",data:{userIds:o},done:function(t){layer.msg("用户删除成功"),e.del(),layer.close(i),n.reload("supplier_infoTab")},fail:function(e){layer.msg("服务器异常，稍后再试！")}})})});var o={userInfo_add:function(e){i="useradd";var t;r.popup({title:"添加用户信息",shadeClose:!0,shade:!1,maxmin:!0,area:["766px","510px"],success:function(i,n){l(this.id).render("/infoManagement/iframeWindow/user_edit_info",e).done(function(){s.render(null,"user_editInfo_form"),s.on("switch(switchUser)",function(e){1==e.elem.checked?(layer.msg("已启用"),t=1):(layer.msg("停用"),t=0)}),s.on("submit(LAY-user-editInfo-submit)",function(e){var i=e.field;return""==i.status||null==i.status||"off"==i.status?i.status=0:"on"==i.status&&(i.status=1),console.log("新增用户提交的表单值为："+JSON.stringify(i)),r.req({type:"post",url:a.baseUrl+"sys/user/save",data:i,done:function(e){console.log(e),layer.msg("用户信息添加成功"),layui.table.reload("user_infoTab")},fail:function(e){layer.msg("用户信息添加失败，请稍后再试！")}}),layer.close(n),!1})})}})}};t("div").delegate(".layui-btn","click",function(){var e=t(this).data("type");o[e]&&o[e].call(this)}),s.verify({username:function(e,i){if(null==e||""==e)return"用户名不能为空！！！"},password:function(e,t){if("useredit"!=i)return null==e||""==e?"密码不能为空！！！":void 0},jobNumber:function(e,i){if(null==e||""==e)return"工号不能为空！！！"}}),e("sys_user",{})});