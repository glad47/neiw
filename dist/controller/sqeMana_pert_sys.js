/** layuiAdmin.pro-v1.0.0 LPPL License By http://www.layui.com/admin/ */
 ;"use strict";layui.define(["admin","table","index","element","form","laydate"],function(e){table=layui.table,view=layui.view,admin=layui.admin,form=layui.form,setter=layui.setter,element=layui.element;var t=layui.jquery,r={orderType:1};element.on("tab(tab-planToger)",function(e){console.log(e.index),0===e.index?r.orderType=1:1===e.index?r.orderType=2:2===e.index&&(r.orderType=3)}),table.render({elem:"#sqeMana_pert_sys",url:setter.baseUrl+"pert/revieworder/list?status=3",toolbar:"#sqeMana_pertSys_tb",cellMinWidth:80,id:"sqeMana_pertSys",page:!0,parseData:function(e){return{code:0,data:e.page.list,count:e.page.totalCount}},cols:[[{type:"checkbox"},{field:"status",title:"状态",width:110},{field:"customerNo",title:"客户编号",Width:110},{field:"productNo",title:"P/N",minWidth:219},{field:"id",title:"ID",hide:!0},{fixed:"right",title:"操作",toolbar:"#sqeMana_pertSys_tabbar",width:150}]],done:function(e,t,r){}}),table.on("toolbar(sqeMana_pert_sys)",function(e){var r=table.checkStatus(e.config.id);new Object;switch(e.event){case"submit":var a=r.data;a.length>1?layer.msg("最多只能选择一条数据！"):a.length<=0?layer.msg("请选择一条要提交的数据！"):layer.confirm("确定提交评审？",function(){admin.req({type:"post",url:setter.baseUrl+"pert/revieworder/update",data:{id:a[0].id,status:4},success:function(){layer.alert("评审提交成功！",function(){table.reload("sqeMana_pertSys"),layer.closeAll()})}})});break;case"addOffer":var a=r.data;if(a.length>1)layer.msg("最多只能选择一条数据！");else if(0===a.length)layer.msg("请选择一条数据！");else{var n=a[0].id;console.log("this_id:"+n),admin.req({type:"post",url:setter.baseUrl+"sys/consumer/user/all",success:function(e){var r={},a={supplierNo:"",unitPrice:"",boardFee:"",postFee:"",testCostFee:"",engineeringFee:"",toolingFee:"",overworkFee:""};r.cInfo=e.data,r.pcbInfo=a,admin.popup({title:"添加供应商报价",area:["749px","486px"],btn:["保存","取消"],yes:function(e,r){t("#pertSysSOrderAddSubmit").click()},success:function(e,t){view(this.id).render("sqeManagement/iframeWindow/pert_sysSOrderAdd",r).done(function(){form.render(),form.on("submit(pertSysSOrderAddSubmit)",function(e){var t=e.field;t.orderId=n,admin.req({type:"post",data:t,url:setter.baseUrl+"pert/supplierquote/save",success:function(){layer.alert("供应商报价添加成功！",function(){table.reload("sqeMana_pertSys"),layer.closeAll()})}}),console.log(t)})})}})}})}}}),table.on("tool(sqeMana_pert_sys)",function(e){var r=e.data,a=r.id;if(console.log("_this_id"+a),"del"==e.event)layer.confirm("确定删除？",function(){admin.req({type:"post",data:{ids:r.id},url:setter.baseUrl+"pert/revieworder/delete",success:function(e){layer.alert("评审订单删除成功！"),table.reload("sqeMana_pertSys"),layer.closeAll()}})});else if("detail"==e.event)admin.popup({title:"编辑PCB订单信息",btn:["立即提交","取消"],area:["820px","90%"],yes:function(){t(".submit-ok").click()},success:function(e,t){view(this.id).render("marketManagement/iframeWindow/orderPCB_update",r).done(function(){console.log(r),form.render(null,""),form.on("submit(LAY-pcborder-update-submit)",function(e){var r=e.field;return""!=r.remark&&"null"!=r.remark||(r.remark=" "),console.log("提交的字段信息："+JSON.stringify(r)),admin.req({type:"post",url:setter.baseUrl+"pert/pcbinfo/save",data:r,done:function(e){layer.msg("订单信息修改成功"),layui.table.reload("interior_order_Tabpcb")},fail:function(e){layer.msg("订单信息修改失败，请稍后再试！")}}),layer.close(t),!1})})}});else if("sOrderDetail"==e.event){var n={type:"sqeMana_pert"};admin.popup({title:"供应商报价详情",btn:["返回"],area:["56%","56%"],yes:function(){layer.closeAll()},success:function(e,t){view(this.id).render("sqeManagement/iframeWindow/supplierOrder_detail",n).done(function(){console.log(n),form.render()})}})}}),e("sqeMana_pert_sys",{})});