/** layuiAdmin.pro-v1.0.0 LPPL License By http://www.layui.com/admin/ */
 ;"use strict";layui.define(["admin","table","index","element","form","laydate"],function(e){function t(){table.render({elem:"#iqcIncom_auditor",url:setter.baseUrl+"iqc/pcborder/incomingAuditor/list",toolbar:"#sqeMana_incoAuTb",cellMinWidth:80,id:"iqcIncom_auditor",page:!0,parseData:function(e){return{code:0,data:e.page.list,count:e.page.totalCount}},cols:[[{type:"checkbox"},{field:"status",title:"状态",width:110,templet:"#iqcMana_ia"},{field:"id",title:"ID",hide:!0},{field:"supplierContractNo",title:"合同单号",minWidth:171},{field:"deliveryTime",title:"交期",width:110,templet:" <a>{{ d.deliveryTime.substring(0,10) }}</a> "},{field:"supplierId",title:"供应商编号",width:117},{field:"factoryMake",title:"供应商厂编",width:117},{field:"productNo",title:"聚谷型号",width:124},{field:"orderPcsNumber",title:"订单数量(PCS)",width:134},{field:"donePcsNumber",title:"已交数量(PCS)",width:134},{field:"surplusPcsNumber",title:"未交数量(PCS)",width:134},{field:"currPcsNumber",title:"送货数量",minWidth:133},{field:"courierCompany",title:"快递公司",width:124},{field:"courierOrderNo",title:"快递订单号",width:117},{field:"deliveryOrderNo",title:"送货单号",width:117},{field:"deliveryNo",title:"交货批次",width:144},{field:"gmtCreate",title:"gmtCreate",hide:!0},{field:"gmtModified",title:"gmtModified",hide:!0},{fixed:"right",title:"操作",toolbar:"#iqcManaIncau_tabbar",width:160}]],done:function(e,t,i){}})}function i(){table.render({elem:"#iqcIncom_auditorS",url:setter.baseUrl+"iqc/stencilorder/incomingAuditor/list",toolbar:"#sqeMana_incoAuTbS",cellMinWidth:80,id:"iqcIncom_auditorS",page:!0,parseData:function(e){return{code:0,data:e.page.list,count:e.page.totalCount}},cols:[[{type:"checkbox"},{field:"status",title:"状态",width:110,templet:"#iqcMana_ia"},{field:"id",title:"ID",hide:!0},{field:"supplierContractNo",title:"合同单号",minWidth:171},{field:"deliveryTime",title:"交期",width:110,templet:" <a>{{ d.deliveryTime.substring(0,10) }}</a> "},{field:"supplierId",title:"供应商编号",width:117},{field:"factoryMake",title:"供应商厂编",width:117},{field:"productNo",title:"聚谷型号",width:124},{field:"orderPcsNumber",title:"订单数量(PCS)",width:134},{field:"donePcsNumber",title:"已交数量(PCS)",width:134},{field:"surplusPcsNumber",title:"未交数量(PCS)",width:134},{field:"currPcsNumber",title:"送货数量",minWidth:133},{field:"courierCompany",title:"快递公司",width:124},{field:"courierOrderNo",title:"快递订单号",width:117},{field:"deliveryOrderNo",title:"送货单号",width:117},{field:"deliveryNo",title:"交货批次",width:144},{field:"gmtCreate",title:"gmtCreate",hide:!0},{field:"gmtModified",title:"gmtModified",hide:!0},{fixed:"right",title:"操作",toolbar:"#iqcManaIncau_tabbarS",width:160}]],done:function(e,t,i){}})}table=layui.table,view=layui.view,admin=layui.admin,form=layui.form,setter=layui.setter,element=layui.element;var a=layui.jquery;t();var r={orderType:1};element.on("tab(tab-planToger)",function(e){console.log(e.index),0===e.index?(r.orderType=1,t()):1===e.index?(r.orderType=2,i()):2===e.index&&(r.orderType=3)}),table.on("toolbar(iqcIncom_auditor)",function(e){var t=table.checkStatus(e.config.id),i=t.data;if(console.log(i),"plrk"==e.event){i.map(function(e){return e.id}).join(",");layer.confirm("确定批量入库？",function(){admin.req({type:"post",headers:{access_token:layui.data("layuiAdmin").access_token},contentType:"application/json;charset=utf-8",data:JSON.stringify(i),url:setter.baseUrl+"iqc/pcborder/batchStatusOk",success:function(){layer.msg("批量入库成功"),table.reload("iqcIncom_auditor"),layer.closeAll()}})})}}),table.on("tool(iqcIncom_auditor)",function(e){var t=e.data;t.deliveryTime&&(t.deliveryTime=t.deliveryTime.substring(0,10)),console.log(t),"edit"==e.event?admin.popup({title:"PCB此批来料检验",area:["624px","494px"],btn:["NG评审","NG批退","OK入库","保存"],btn1:function(e,i){t.pcsMantissa=a("input[name='pcsMantissa']").val(),t.failPcsNumber=a("input[name='failPcsNumber']").val(),layer.confirm("确定评审？",function(){admin.req({type:"post",data:t,url:setter.baseUrl+"iqc/pcborder/statusReview",success:function(e){table.reload("iqcIncom_auditor"),layer.closeAll()}})})},btn2:function(){return t.pcsMantissa=a("input[name='pcsMantissa']").val(),t.failPcsNumber=a("input[name='failPcsNumber']").val(),layer.confirm("确定批退？",function(){admin.req({type:"post",data:t,url:setter.baseUrl+"iqc/pcborder/statusBack",success:function(e){table.reload("iqcIncom_auditor"),layer.closeAll()}})}),!1},btn3:function(){return t.pcsMantissa=a("input[name='pcsMantissa']").val(),t.failPcsNumber=a("input[name='failPcsNumber']").val(),layer.confirm("确定入库？",function(){admin.req({type:"post",data:t,url:setter.baseUrl+"iqc/pcborder/statusOk",success:function(e){table.reload("iqcIncom_auditor"),layer.closeAll()}})}),!1},btn4:function(){t.pcsMantissa=a("input[name='pcsMantissa']").val(),t.failPcsNumber=a("input[name='failPcsNumber']").val(),layer.confirm("确定保存？",function(){admin.req({type:"post",data:t,url:setter.baseUrl+"iqc/pcborder/updateOrderShipment",success:function(){table.reload("iqcIncom_auditor"),layer.closeAll()}})})},success:function(e,i){var a=t.id,r=t.supplierId,l=t.orderId;view(this.id).render("iqcManagement/iframeWindow/incoming_auditor_edit",t).done(function(){form.on("submit(otEdit)",function(e){var t=e.field;return t.id=a,t.orderId=l,t.supplierId=r,console.log(t),admin.req({type:"post",data:t,url:setter.baseUrl+"scm/ordersupplier/update",success:function(e){layer.alert("订单协同修改成功"),table.reload("iqcIncom_auditor"),layer.close(i)}}),!1})})}}):"search"==e.event&&layer.msg("查看订单协同")}),table.on("toolbar(iqcIncom_auditorS)",function(e){var t=table.checkStatus(e.config.id),i=t.data;if("plrk"===e.event){var a=i.map(function(e){return e.id}).join(",");layer.confirm("确定批量入库？",function(){admin.req({type:"post",data:{ids:a},url:setter.baseUrl+"iqc/stencilorder/batchStatusOk",success:function(){layer.msg("批量入库成功"),table.reload("iqcIncom_auditorS"),layer.closeAll()}})})}}),table.on("tool(iqcIncom_auditorS)",function(e){var t={data:{}};t.data=e.data;var i={};i.id=e.data.id,i.orderSupplierId=e.data.orderSupplierId,i.supplierId=e.data.supplierId,i.factoryMake=e.data.factoryMake,i.orderPcsNumber=e.data.orderPcsNumber,i.donePcsNumber=e.data.donePcsNumber,i.currPcsNumber=e.data.currPcsNumber,i.orderPeriod="",console.log(i),"edit"==e.event?admin.popup({title:"Stencil此批来料检验",area:["624px","494px"],btn:["NG评审","NG批退","OK入库","保存"],btn1:function(e,t){i.pcsMantissa=a("input[name='pcsMantissa']").val(),i.failPcsNumber=a("input[name='failPcsNumber']").val(),console.log(i),layer.confirm("确定评审？",function(){admin.req({type:"post",data:i,url:setter.baseUrl+"iqc/stencilorder/statusReview",success:function(e){table.reload("iqcIncom_auditorS"),layer.closeAll()}})})},btn2:function(){return i.pcsMantissa=a("input[name='pcsMantissa']").val(),i.failPcsNumber=a("input[name='failPcsNumber']").val(),layer.confirm("确定批退？",function(){admin.req({type:"post",data:i,url:setter.baseUrl+"iqc/stencilorder/statusBack",success:function(e){table.reload("iqcIncom_auditorS"),layer.closeAll()}})}),!1},btn3:function(){return i.pcsMantissa=a("input[name='pcsMantissa']").val(),i.failPcsNumber=a("input[name='failPcsNumber']").val(),i.orderId=t.orderId,layer.confirm("确定入库？",function(){admin.req({type:"post",data:i,url:setter.baseUrl+"iqc/stencilorder/statusOk",success:function(e){table.reload("iqcIncom_auditorS"),layer.closeAll()}})}),!1},btn4:function(){i.pcsMantissa=a("input[name='pcsMantissa']").val(),i.failPcsNumber=a("input[name='failPcsNumber']").val(),layer.confirm("确定保存？",function(){admin.req({type:"post",data:i,url:setter.baseUrl+"iqc/stencilorder/updateOrderShipment",success:function(){table.reload("iqcIncom_auditorS"),layer.closeAll()}})})},success:function(e,i){var a=t.id,r=t.supplierId,l=t.orderId;view(this.id).render("iqcManagement/iframeWindow/incoming_auditor_edit",t).done(function(){form.on("submit(otEdit)",function(e){var t=e.field;return t.id=a,t.orderId=l,t.supplierId=r,console.log(t),admin.req({type:"post",data:t,url:setter.baseUrl+"scm/ordersupplier/update",success:function(e){layer.alert("Stencil订单协同修改成功"),table.reload("iqcIncom_auditorS"),layer.close(i)}}),!1})})}}):"search"==e.event&&layer.msg("查看订单协同")}),e("iqcMana_incoming_auditor",{})});