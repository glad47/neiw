/** layuiAdmin.pro-v1.0.0 LPPL License By http://www.layui.com/admin/ */
 ;"use strict";layui.define(["admin","table","util","form","upload"],function(e){function t(){o.render({elem:"#LAY-info-qc-jg-table",url:r.imUrl+"quoteConfig/getAllQuoteConfigs",method:"POST",data:{areaSq:0},parseData:function(e){return{code:0,data:e.data,count:e.data.length}},cols:[[{type:"numbers",title:"序号",width:50},{field:"id",title:"id",width:70},{field:"areaParameterName",title:"平米",width:120},{field:"pcbTypeName",title:"基材",width:100},{field:"layerNum",title:"层数",width:50},{field:"urgentType",title:"加急类型",width:120},{field:"parameterTypeName",title:"参数类型",width:120},{field:"parameterName",title:"参数名",width:180},{field:"quoteCondition",title:"判断",width:70},{field:"parameterValue",title:"参数值",width:100},{field:"premiumType",title:"加价类别",width:120},{field:"quote",title:"标准值",width:100},{title:"操作",width:180,align:"center",toolbar:"#info-qc-jg-toolbar"}]]})}function i(e,t){o.on("edit(".concat(e,")"),function(e){var i=e.value,l=e.data,a=e.field,n={};n[a]=i,n.id=l.id,d.req({url:t,type:"POST",data:n,success:function(e){0===e.code?layer.msg("修改成功！！"):layer.msg(e.msg)}})})}function l(e,t,i,l){o.render({elem:"#".concat(e),url:t,method:"POST",parseData:function(e){return l?{code:0,data:e.page.list,count:e.page.totalCount}:{code:0,data:e.data,count:e.data.length}},cols:i,page:!1})}function a(e,t,i){console.log(e+" "+t+" "+i),n.ajaxSettings.async=!1,n.get(r.imUrl+"quoteConfig/getAllParameter",{parameterTypeId:e},function(e){n("select[name='parameterName']").empty(),n("select[name='parameter']").empty(),n.each(e.data,function(e,i){i.id===t?n("#pn").append("<option value='"+i.id+"' selected>"+i.parameterName+"</option>"):n("#pn").append("<option value='"+i.id+"'>"+i.parameterName+"</option>")})}),n.get(r.imUrl+"quoteConfig/getAllParameterValue",{parameterId:t},function(e){var t=n("select[name='parameter']");t.empty(),n.each(e.data,function(e,t){t.id===i?n("#pa").append("<option value='"+t.id+"' selected>"+t.parameterValue+"</option>"):n("#pa").append("<option value='"+t.id+"'>"+t.parameterValue+"</option>")})}),n.ajaxSettings.async=!0,c.render()}var n=layui.$,d=layui.admin,r=layui.setter,o=layui.table,c=layui.form,f=layui.upload,u=layui.view,s=layui.element;c.render(null,"sys-quote-config-form-list"),c.on("select(e)",function(e){n.get(r.imUrl+"quoteConfig/getAllParameter",{parameterTypeId:e.value},function(e){n("select[name='parameterName']").empty(),n("select[name='parameterValue']").empty(),n.each(e.data,function(e,t){n("select[name='parameterName']").append("<option value='"+t.id+"'>"+t.parameterName+"</option>")}),c.render(null,"sys-quote-config-form-list")})}),c.on("select(f)",function(e){n.get(r.imUrl+"quoteConfig/getAllParameterValue",{parameterId:e.value},function(e){var t=n("select[name='parameter']");t.empty(),n.each(e.data,function(e,t){n("select[name='parameter']").append("<option value='"+t.id+"'>"+t.parameterValue+"</option>")}),c.render(null,"sys-quote-config-form-list")})}),c.on("submit(LAY-sys-quote-config-formlist-search)",function(e){var t=e.field;o.reload("LAY-info-qc-jg-table",{where:t})});var g={jg:{text:"价格配置",id:"LAY-info-qc-jg-table"},zl:{text:"重量配置",id:"LAY-info-qc-zl-table",editUrl:r.imUrl+"quoteConfig/updateQuoteWeight",url:r.imUrl+"quoteConfig/getAllQuoteWeights",cols:[[{field:"thicknaesName",title:"",width:100,align:"center"},{field:"fr41",title:"FR-4 1层",width:120,align:"center",edit:"text"},{field:"fr42",title:"FR-4 2层",width:120,align:"center",edit:"text"},{field:"fr44",title:"FR-4 4层",width:120,align:"center",edit:"text"},{field:"fr46",title:"FR-4 6层",width:120,align:"center",edit:"text"},{field:"fr48",title:"FR-4 8层",width:120,align:"center",edit:"text"},{field:"al1",title:"AL 1层",width:100,align:"center",edit:"text"},{field:"al2",title:"AL 2层",width:100,align:"center",edit:"text"},{field:"fr4al",title:"FR-4+AL",width:100,align:"center",edit:"text"},{field:"fpc",title:"FPC",width:100,align:"center",edit:"text"}]]},jsb:{text:"金属板配置",id:"LAY-info-qc-jsb-table",editUrl:r.imUrl+"quoteConfig/updateQuoteMetal",url:r.imUrl+"quoteConfig/getAllQuotePremiumMetal",cols:[[{field:"name",title:"加价项",width:200,align:"center"},{field:"metalPriceValue",title:"参考值",width:150,align:"center",edit:"text"},{field:"unitName",title:"单位",width:150,align:"center"}]]},fjsb:{text:"非金属板配置",id:"LAY-info-qc-fjsb-table",editUrl:r.imUrl+"quoteConfig/updateQuoteNoMetal",url:r.imUrl+"quoteConfig/getAllQuotePremiumNoMetal",cols:[[{field:"name",title:"加价项",width:200,align:"center"},{field:"noMetalPriceValue",title:"参考值",width:150,align:"center",edit:"text"},{field:"unitName",title:"单位",width:150,align:"center"}]]},qt:{text:"其他配置",id:"LAY-info-qc-qt-table",editUrl:r.imUrl+"quoteConfig/updateQuoteOther",url:r.imUrl+"quoteConfig/getAllQuotePremiumOther",cols:[[{field:"name",title:"加价项",width:200,align:"center"},{field:"otherPriceValue",title:"参考值",width:150,align:"center",edit:"text"},{field:"unitName",title:"单位",width:150,align:"center"}]]},jq:{text:"交期配置",id:"LAY-info-qc-jq-table",editUrl:r.imUrl+"quoteConfig/updateQuoteUrgentBuilds",url:r.imUrl+"quoteConfig/allQuoteUrgentBuilds",cols:[[{field:"areaParameterName",title:"平米类型",width:150,align:"center"},{field:"areaMinParameter",title:"平米最小值",width:150,align:"center",templet:'<div>{{d.areaMinParameter || "0"}}<div>'},{field:"areaMaxParameter",title:"平米最大值",width:150,align:"center"},{field:"urgentType",title:"加急类型",width:150,align:"center"},{field:"layerNum",title:"层数",width:150,align:"center"},{field:"dayNumber",title:"天数",width:150,align:"center",edit:"text"},{field:"price",title:"费用",width:150,align:"center",templet:'<div>{{d.price || "0"}}<div>',edit:"text"}]]},pmlx:{text:"平米类型配置",id:"LAY-info-qc-pmlx-table",editUrl:r.imUrl+"quoteConfig/updateQuoteArea",url:r.imUrl+"quoteConfig/getAllAreaParameter",cols:[[{field:"areaParameterName",title:"平米类型",width:150,align:"center"},{field:"areaMinParameter",title:"面积区间最小值",width:150,align:"center",templet:'<div>{{d.areaMinParameter || "0"}}<div>',edit:"text"},{field:"areaMaxParameter",title:"面积区间最大值",width:150,align:"center",templet:'<div>{{d.areaMaxParameter || "0"}}<div>',edit:"text"}]]},hl:{text:"汇率配置",id:"LAY-info-qc-hl-table",editUrl:r.imUrl+"quoteConfig/updateQuoteExchangeRate",url:r.imUrl+"quoteConfig/getAllExchangeRate",cols:[[{field:"id",title:"id",width:150,align:"center"},{field:"currency",title:"币种",width:150,align:"center"},{field:"exchangeRate",title:"汇率",width:150,align:"center",edit:"text"}]]},yf:{text:"运费配置",id:"LAY-info-qc-yf-table",editUrl:r.imUrl+"quoteConfig/updateCourierQuoteExtra",url:r.imUrl+"quoteConfig/allCourierQuoteExtra",cols:[[{field:"id",title:"id",width:150,align:"center"},{field:"itemName",title:"额外项名",width:150,align:"center"},{field:"itemRate",title:"比例",width:150,align:"center",edit:"text"}]]},gw:{text:"钢网配置",id:"LAY-info-qc-gw-table",editUrl:r.imUrl+"quoteConfig/updateQuoteStencil",url:r.imUrl+"quoteConfig/getAllQuoteStencil",cols:[[{field:"id",title:"id",width:150,align:"center"},{field:"materialName",title:"物料名称",width:150,align:"center"},{field:"stencilSizex",title:"尺寸x",width:150,align:"center"},{field:"stencilSizey",title:"尺寸y",width:150,align:"center"},{field:"stencilAreax",title:"面积x",width:150,align:"center"},{field:"stencilAreay",title:"面积y",width:150,align:"center"},{field:"price",title:"价格",width:150,align:"center",edit:"text"},{field:"weight",title:"重量",width:150,align:"center",edit:"text"}]]},tp:{text:"贴片配置",id:"LAY-info-qc-tp-table",editUrl:r.imUrl+"quoteConfig/updateQuoteAssembly",url:r.imUrl+"quoteConfig/getAllQuoteAssembly",cols:[[{field:"id",title:"id",width:150,align:"center"},{field:"name",title:"分项",width:150,align:"center"},{field:"value",title:"价格/RMB",width:150,align:"center",edit:"text"}]]},fedex:{text:"Fedex运费配置",id:"LAY-info-qc-fedex-table",editUrl:r.baseUrl+"sys/freight/updateFedexRate",url:r.baseUrl+"sys/freight/fedexRateList",cols:[[{field:"id",title:"id",align:"center"},{field:"weight",title:"重量",width:85,align:"center"},{field:"partitionA",title:"A区",width:75,align:"center",edit:"text"},{field:"partitionB",title:"B区",width:75,align:"center",edit:"text"},{field:"partitionD",title:"D区",width:75,align:"center",edit:"text"},{field:"partitionE",title:"E区",width:82,align:"center",edit:"text"},{field:"partitionF",title:"F区",width:75,align:"center",edit:"text"},{field:"partitionG",title:"G区",width:82,align:"center",edit:"text"},{field:"partitionH",title:"H区",width:75,align:"center",edit:"text"},{field:"partitionK",title:"K区",width:75,align:"center",edit:"text"},{field:"partitionM",title:"M区",width:75,align:"center",edit:"text"},{field:"partitionN",title:"N区",width:82,align:"center",edit:"text"},{field:"partitionO",title:"O区",width:75,align:"center",edit:"text"},{field:"partitionP",title:"P区",width:75,align:"center",edit:"text"},{field:"partitionQ",title:"Q区",width:75,align:"center",edit:"text"},{field:"partitionR",title:"R区",width:75,align:"center",edit:"text"},{field:"partitionS",title:"S区",width:75,align:"center",edit:"text"},{field:"partitionT",title:"T区",width:75,align:"center",edit:"text"},{field:"partitionU",title:"U区",width:75,align:"center",edit:"text"},{field:"partitionV",title:"V区",width:75,align:"center",edit:"text"},{field:"partitionX",title:"X区",width:75,align:"center",edit:"text"},{field:"partitionY",title:"Y区",width:75,align:"center",edit:"text"},{field:"partitionZ",title:"Z区",width:75,align:"center",edit:"text"},{field:"partition1",title:"1区",width:82,align:"center",edit:"text"},{field:"partition2",title:"2区",width:82,align:"center",edit:"text"}]]}};t(),s.on("tab(sys-quoteConfig-tabs)",function(e){if(0!=e.index?n("#sqcfl").addClass("layui-hide"):n("#sqcfl").removeClass("layui-hide"),1===e.index){var t=g.zl;l(t.id,t.url,t.cols),i(t.id,t.editUrl)}else if(2===e.index){var t=g.jsb;l(t.id,t.url,t.cols),i(t.id,t.editUrl)}else if(3===e.index){var t=g.fjsb;l(t.id,t.url,t.cols),i(t.id,t.editUrl)}else if(4===e.index){var t=g.qt;l(t.id,t.url,t.cols),i(t.id,t.editUrl)}else if(5===e.index){var t=g.jq;l(t.id,t.url,t.cols),i(t.id,t.editUrl)}else if(6===e.index){var t=g.pmlx;l(t.id,t.url,t.cols),i(t.id,t.editUrl)}else if(7===e.index){var t=g.hl;l(t.id,t.url,t.cols),i(t.id,t.editUrl)}else if(8===e.index){var t=g.yf;l(t.id,t.url,t.cols),i(t.id,t.editUrl)}else if(9===e.index){var t=g.gw;l(t.id,t.url,t.cols),i(t.id,t.editUrl)}else if(10===e.index){var t=g.tp;l(t.id,t.url,t.cols),i(t.id,t.editUrl)}else if(11===e.index){var t=g.fedex;l(t.id,t.url,t.cols,1),i(t.id,t.editUrl)}}),o.on("tool(LAY-info-qc-jg-table)",function(e){var t=e.data;console.log(t),"edit"===e.event?d.popup({title:"编辑报价配置",area:["850px","440px"],btn:["提交","取消"],yes:function(e,t){n("#sys-quoteConfig-form-submit").click()},success:function(e,i){u(this.id).render("/infoManagement/iframeWindow/sys_quoteConfig_form",t).done(function(){c.render(null,"layuiadmin-sys-quoteconfig-form-list"),a(t.parameterTypeId,t.parameterNameId,t.parameterValueId),c.on("submit(layuiadmin-sys-quoteConfig-form-submit)",function(e){var t=e.field;d.req({url:r.imUrl+"quoteConfig/editQuoteConfig",type:"POST",data:t,success:function(e){layui.table.reload("LAY-info-qc-jg-table"),layer.close(i)}})})})}}):"del"===e.event&&layer.confirm("确定删除此报价？",function(e){d.req({url:r.imUrl+"quoteConfig/deleteQuoteConfig",type:"POST",data:t.field,success:function(e){layui.table.reload("LAY-info-qc-jg-table"),layer.msg("已删除")}})})});var m={add:function(e,t){var i=g[t];d.popup({title:"添加报价配置",area:["766px","510px"],btn:["提交","取消"],yes:function(e,t){n("#sys-quoteConfig-form-submit").click()},success:function(e,t){u(this.id).render("/infoManagement/iframeWindow/sys_quoteConfig_form").done(function(){c.render(null,"layuiadmin-sys-quoteconfig-form-list"),c.on("submit(layuiadmin-sys-quoteConfig-form-submit)",function(e){var l=e.field;d.req({url:r.imUrl+"quoteConfig/saveQuoteConfig",type:"POST",data:l,success:function(e){0===e.code?(layer.msg("添加成功！！"),layui.table.reload(i.id),layer.close(t)):layer.msg(e.msg)},async:!1})})})}})}};f.render({elem:"#excelFedexRates",url:r.baseUrl+"sys/freight/importFedexRates",exts:"xlsx|xls",headers:{access_token:layui.data("layuiAdmin").access_token},done:function(e){layer.msg(e.msg)},error:function(){layer.error("上传异常！！")}}),n(".LAY-sys-quote-config-btns .layui-btn").on("click",function(){var e=n(this),t=e.data("events"),i=e.data("type");m[t]&&m[t].call(this,e,i)}),e("sys_quote_config",{})});