/** layuiAdmin.pro-v1.0.0 LPPL License By http://www.layui.com/admin/ */
 ;"use strict";layui.define(["table","form"],function(e){function i(e){var i=new Object;return n.req({type:"post",data:{invoiceId:e},async:!1,url:c.baseUrl+"epc/custominvoice/queryCustomInvoiceById",success:function(e){i=e.data}}),i}var t=layui.$,n=layui.admin,o=layui.view,a=layui.table,c=layui.setter;layui.form;a.render({elem:"#invoiceList_Tabpcb",url:c.baseUrl+"epc/orderinvoice/list",toolbar:"#invoiceList_TopBar",cellMinWidth:80,id:"invoiceList_Tabpcb",page:!0,parseData:function(e){return{code:0,data:e.page.list,count:e.page.totalCount}},cols:[[{type:"checkbox",fixed:"left"},{field:"productNos",fixed:"left",title:"聚谷型号",align:"center",minWidth:154,sort:!0},{field:"invoiceNo",title:"发票号",minWidth:150},{field:"businessName",title:"跟单员"},{field:"totalFee",title:"发票金额"},{field:"gmtCreate",title:"创建时间",minWidth:130},{field:"businessId",title:"跟单员id",hide:!0},{field:"consumerId",title:"客户id",hide:!0},{title:"操作",width:190,align:"center",fixed:"right",toolbar:"#invoiceList_Bar"}]]}),a.on("toolbar(invoiceList_Tabpcb)",function(e){var i=a.checkStatus(e.config.id);"generateInvoice"===e.event&&(i.data.type="1",n.popup({title:"添加发票",area:["100%","100%"],btn:["保存","取消"],id:"popGenerateInvoice",yes:function(e){t(".gi-submit").click()},success:function(){o(this.id).render("/marketManagement/iframeWindow/generate_invoice",i.data).done(function(){})}}))}),a.on("tool(invoiceList_Tabpcb)",function(e){var a=e.data;if("il-edit"===e.event){var r=i(a.id);r.type="2",r.id=a.id,n.popup({title:"查看发票",area:["100%","100%"],btn:["更新","取消"],id:"popGenerateInvoiceUpdate",yes:function(e){t(".gi-submit").click()},success:function(){o(this.id).render("/marketManagement/iframeWindow/generate_invoice",r).done(function(){})}})}else if("il-del"===e.event)layer.confirm("确定删除吗？",function(i){n.req({type:"post",data:{ids:a.id},url:c.baseUrl+"epc/orderinvoice/delete",success:function(){e.del(),layer.msg("已删除")}})});else if("il-search"===e.event){var s={data:{}},d=a.invoiceNo,u=a.businessName;s.data=i(a.id),n.req({type:"get",data:"",url:c.baseUrl+"sys/consumer/user/info/"+e.data.consumerId,success:function(e){s.userName=e.user.userName,s.companyName=e.user.companName,s.country=e.user.country,s.invoiceNo=d,s.businessName=u,s.city=e.user.city,s.address=e.user.address,s.mobilePhone=e.user.mobilePhone,s.postcode=e.user.postcode,s.paymentType=e.user.paymentType,s.deliveryType=e.user.deliveryType,s.contact=e.user.contact,n.popup({title:"内部合同",area:["100%","100%"],btn:["打印","关闭"],maxmin:!0,yes:function(e,i){var t="quoteContract_AllB";document.body.innerHTML=document.getElementById(t).innerHTML,window.print(),window.location.reload()},success:function(e,i){s.htmlType=2,o(this.id).render("marketManagement/iframeWindow/quote_contractInvo",s).done(function(){console.log(s)})}})}})}}),e("market_invoiceList",{})});