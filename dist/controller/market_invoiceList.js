/** layuiAdmin.pro-v1.0.0 LPPL License By http://www.layui.com/admin/ */
 ;"use strict";layui.define(["table","form"],function(e){function i(e){var i=new Object;return n.req({type:"post",data:{invoiceId:e},async:!1,url:r.baseUrl+"epc/custominvoice/queryCustomInvoiceById",success:function(e){i=e.data}}),i}var t=layui.$,n=layui.admin,o=layui.view,a=layui.table,r=layui.setter;layui.form;a.render({elem:"#invoiceList_Tabpcb",url:r.baseUrl+"epc/orderinvoice/list",cellMinWidth:80,id:"invoiceList_Tabpcb",page:!0,parseData:function(e){return{code:0,data:e.page.list,count:e.page.totalCount}},cols:[[{type:"checkbox",fixed:"left"},{field:"productNos",fixed:"left",title:"聚谷型号",align:"center",minWidth:154,sort:!0},{field:"invoiceNo",title:"发票号",minWidth:150},{field:"invoiceDate",title:"发票时间"},{field:"businessName",title:"跟单员"},{field:"totalFee",title:"发票金额"},{field:"gmtCreate",title:"创建时间",minWidth:130},{field:"id",width:100,title:"ID",sort:!0},{field:"businessId",title:"跟单员id",hide:!0},{field:"consumerId",title:"客户id",hide:!0},{title:"操作",width:190,align:"center",fixed:"right",toolbar:"#invoiceList_Bar"}]]}),a.on("tool(invoiceList_Tabpcb)",function(e){var a=e.data;if("il-edit"===e.event){var s=i(a.id);s.type="2",s.id=a.id,n.popup({title:"查看发票",area:["100%","100%"],btn:["更新","取消"],id:"popGenerateInvoiceUpdate",yes:function(e){t(".gi-submit").click()},success:function(){o(this.id).render("/marketManagement/iframeWindow/generate_invoice",s).done(function(){})}})}else if("il-del"===e.event)layer.confirm("确定删除吗？",function(i){n.req({type:"post",data:{ids:a.id},url:r.baseUrl+"epc/orderinvoice/delete",success:function(){e.del(),layer.msg("已删除")}})});else if("il-search"===e.event){var c={data:{}},d=a.invoiceNo,l=a.businessName;c.data=i(a.id),n.req({type:"get",data:"",url:r.baseUrl+"sys/consumer/user/info/"+e.data.consumerId,success:function(e){c.userName=e.user.userName,c.companyName=e.user.companName,c.country=e.user.country,c.invoiceNo=d,c.businessName=l,c.city=e.user.city,c.address=e.user.address,c.mobilePhone=e.user.mobilePhone,c.postcode=e.user.postcode,c.paymentType=e.user.paymentType,c.deliveryType=e.user.deliveryType,c.contact=e.user.contact,n.popup({title:"内部合同",area:["100%","100%"],btn:["打印","关闭"],maxmin:!0,yes:function(e,i){var t="quoteContract_AllB";document.body.innerHTML=document.getElementById(t).innerHTML,window.print(),window.location.reload()},success:function(e,i){c.htmlType=2,o(this.id).render("marketManagement/iframeWindow/quote_contractInvo",c).done(function(){console.log(c)})}})}})}}),e("market_invoiceList",{})});