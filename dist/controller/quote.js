/** layuiAdmin.pro-v1.0.0 LPPL License By http://www.layui.com/admin/ */
 ;"use strict";layui.define(["admin","form","element","laytpl","layer","upload"],function(e){function t(e){if(1===se){s("1");var t=parseFloat($*ee*te)/1e6;P("#areasq").val(t.toFixed(3))}else if(2===se){s("2");var t=parseFloat(ae*oe*ne)/1e6;if(P("#areasq").val(t.toFixed(3)),""!=ne&&""!=ie&&""!=le){var i=Math.ceil(ne*ie*le);P("#quantityPCS").val(i)}}}function i(e){P("#areasq").val(""),0===e?(P(".itPanelway input").attr("disabled",B.isDis.itPanelway),P(".itPanelsize input").attr("disabled",B.isDis.itPanelsize)):1===e?(P(".mto-input").removeAttr("disabled","true"),P(".itPanelway input").attr("disabled","disabled"),P(".itPanelsize input").attr("disabled","disabled"),P(".itSinlgesize input").val(""),P(".itPanelway input").val(""),P(".itPanelsize input").val("")):2===e&&(P(".mto-input").removeAttr("disabled","true"),P(".itSinlgesize input").attr("disabled","disabled"),P(".itSinlgesize input").val(""))}function l(){P("#selHc").attr("disabled",Z.isDis.selHc),P("#selInlayercoopper").attr("disabled",Z.isDis.selInlayercoopper),P("#selInnerMintrack").attr("disabled",Z.isDis.selInnerMintrack),P("#selNofcore").attr("disabled",Z.isDis.selNofcore),P("#selMinspaccing").attr("disabled",Z.isDis.selMinspaccing),P("#selNofpp").attr("disabled",Z.isDis.selNofpp),P("#radioSinglePcb").attr("checked","true"),P("#ptfr4").attr("checked","true"),P("#routingOne").attr("checked","true"),P("#selLayer").val(Z.selLayer),P("#selFinishThickness").val(Z.selFinishThickness),P("#selMaterial").val(Z.selMaterial),P("#selkbsy").val(Z.selkbsy),P("#selTg").val(Z.selTg),P("#selHf").val(Z.selHf),P("#selHc").val(Z.selHc),P("#selInlayercoopper").val(Z.selInlayercoopper),P("#selInnerMintrack").val(Z.selInnerMintrack),P("#selNofcore").val(Z.selNofcore),P("#selMinspaccing").val(Z.selMinspaccing),P("#selNofpp").val(Z.selNofpp),P("#selOuterlayercopper").val(Z.selOuterlayercopper),P("#selOutMintrack").val(Z.selOutMintrack),P("#selBgasize").val(Z.selBgasize),P("#selMinspacing").val(Z.selMinspacing),P("#selMinholesize").val(Z.selMinholesize),P("#selPthcopper").val(Z.selPthcopper),P("#selSoldermc").val(Z.selSoldermc),P("#selViaprocess").val(Z.selViaprocess),P("#selSilksc").val(Z.selSilksc),P("#selPeelable").val(Z.selPeelable),P("#selSurfacefinish").val(Z.selSurfacefinish),P("#selTestcost").val(Z.selTestcost),k.render()}function n(e){if(P("#selLayer").children().remove(),"Aluminum"==e)for(var t=0;t<A.length;t++){var i=A[t].text,l=A[t].value;P("#selLayer").append("<option value="+l+">"+i+"</option>")}else if("FR4"==e)for(var t=0;t<q.length;t++){var i=q[t].text,l=q[t].value;P("#selLayer").append("<option value="+l+">"+i+"</option>"),r(1)}else if("FR4+Aluminum"==e)for(var t=0;t<M.length;t++){var i=M[t].text,l=M[t].value;P("#selLayer").append("<option value="+l+">"+i+"</option>")}}function a(e){if(P("#selMaterial").children().remove(),"Aluminum"==e){for(var t=0;t<W.length;t++){var i=W[t].text,l=W[t].value;P("#selMaterial").append("<option value="+l+">"+i+"</option>")}o("yg")}else{for(var t=0;t<D.length;t++){var i=D[t].text,l=D[t].value;P("#selMaterial").append("<option value="+l+">"+i+"</option>")}o("kb")}k.render("select")}function o(e){if(P("#selkbsy").children().remove(),"kb"==e)for(var t=0;t<Y.length;t++){var i=Y[t].text,l=Y[t].value;P("#selkbsy").append("<option value="+l+">"+i+"</option>")}else if("yg"==e)for(var t=0;t<_.length;t++){var i=_[t].text,l=_[t].value;P("#selkbsy").append("<option value="+l+">"+i+"</option>")}else if("sy"==e)for(var t=0;t<z.length;t++){var i=z[t].text,l=z[t].value;P("#selkbsy").append("<option value="+l+">"+i+"</option>")}k.render("select")}function s(e){var t=e;"1"==t?($=P("#singleSizeX").val(),ee=P("#singleSizeY").val(),te=P("#quantityPCS").val()):"2"==t&&(ie=P("#panelWayX").val(),le=P("#panelWayY").val(),ne=P("#quantityPanel").val(),ae=P("#panelSizeX").val(),oe=P("#panelSizeY").val())}function r(e){c(),2===re?(Z.selLayer=1,Z.selMaterial="YG",Z.selkbsy="YG0001",Z.selHc="1W",Z.selMinholesize="1.5",Z.selPthcopper="none",Z.selSoldermc="white",Z.selViaprocess="none",Z.selSilksc="black",Z.isDis.selHc=!1):3===re&&(Z.selLayer=4,Z.selHc="1W",Z.selInlayercoopper="1oz",Z.selMintrack="5mil",Z.selNofcore="1",Z.selMinspaccing="5mil",Z.selNofpp="2",Z.selInnerMintrack="5mil",Z.selMinholesize="1.5",Z.selPthcopper="none",Z.selSoldermc="white",Z.selSilksc="black",Z.selPeelable="none",Z.isDis.selInlayercoopper=!1,Z.isDis.selInnerMintrack=!1,Z.isDis.selNofcore=!1,Z.isDis.selMinspaccing=!1,Z.isDis.selNofpp=!1),l()}function c(){Z.selLayer=2,Z.selFinishThickness="1.6mm",Z.selMaterial="KB",Z.selkbsy="KB6160",Z.selTg="135",Z.selHf="NO",Z.selHc="none",Z.selInlayercoopper="none",Z.selMintrack="none",Z.selNofcore="none",Z.selMinspaccing="none",Z.selNofpp="none",Z.selOuterlayercopper="1oz",Z.selInnerMintrack="none",Z.selOutMintrack="5mil",Z.selBgasize="0.30",Z.selMinspacing="5mil",Z.selMinholesize="0.3",Z.selPthcopper="20um",Z.selSoldermc="green",Z.selViaprocess="Follow_gerber",Z.selSilksc="white",Z.selPeelable="none",Z.selSurfacefinish="HASL_with_lead",Z.selTestcost="1",Z.selCti="175≤CTI<250",Z.isDis={},Z.isDis.selHc=!0,Z.isDis.selInlayercoopper=!0,Z.isDis.selInnerMintrack=!0,Z.isDis.selNofcore=!0,Z.isDis.selMinspaccing=!0,Z.isDis.selNofpp=!0}function u(){var e=P("#areasq").val(),t=P("#selLayer").val();P("input[name='buildTime']").remove(),P(".build-time-item .layui-form-radio").remove(),I.req({type:"post",url:C.imUrl+"quote/getBuildTime",data:{areaSq:e,layerNum:t},success:function(e){P(".build-time-item").css("display","");var t;P("#selBuildTime").children().remove();for(var i=0;i<e.data.length;i++)P("#selBuildTime").append("<option value="+e.data[i].price+">"+e.data[i].dayNumber+"</option>"),t=e.data[0].dayNumber;K.buildTime=t,P(".build-time-item input").each(function(){var e=P(this).attr("title");console.log(e),"none"==e&&this.remove()}),k.render()},error:function(){x.msg("Get BuildTime Fail!!!")}})}function p(){var e=null;1===Q.bordType?e="selCompany":2===Q.bordType?e="selCompanyt":3===Q.bordType&&(e="selCompany"),console.log("SelectId:"+e),I.req({type:"post",url:C.imUrl+"quote/getCouriers",success:function(t){P("select[id='"+e+"'] option").remove(),Q.companyId=t.data[0].id;for(var i=0;i<t.data.length;i++)P("#"+e).append("<option value="+t.data[i].id+">"+t.data[i].courierName+"</option>"),G.courierId=t.data[0].id,Q.companyId=G.courierId;k.render("select")},error:function(){x.msg("Get Couriers Fail!!!")}})}function d(){var e=null;1===Q.bordType?e="selCountrys":2===Q.bordType?e="selCountryst":3===Q.bordType&&(e="selCountryss"),P("select[id='"+e+"'] option").remove(),k.render(),I.req({type:"post",url:C.imUrl+"quote/getCountry",success:function(t){Q.countrysId=t.data[0].id;for(var i=0;i<t.data.length;i++)P("#"+e).append("<option value="+t.data[i].id+">"+t.data[i].name+"</option>"),G.countryId=t.data[0].id,Q.countrysId=G.countryId,console.log("国家的选中id值为："+G.countryId);k.render()},error:function(){x.msg("Get Countrys Fail!!!")}})}function v(e,t){var i;null!=e&&"undefined"!=typeof e&&""!=e||(e=1),null!=t&&"undefined"!=typeof t&&""!=t||(t=70),i=2===Q.bordType?w.stencilWeight:Q.totalWeight,I.req({type:"post",url:C.imUrl+"quote/getShippingCost",data:{courierId:e,countryId:t,totalWeight:i},success:function(e){null!=e.data&&1===Q.bordType?(K.postFee=e.data.shippingCost,U.postFee=e.data.shippingCost,L.shipping=e.data.shippingCost,P("#shippingPrice").val(L.shipping),g()):null!=e.data&&2===Q.bordType?(w.stencil_shippingPrice=V.postFee=e.data.shippingCost,console.log("stencil_shippingPrice:"+w.stencil_shippingPrice),P("#postFees").val(w.stencil_shippingPrice),y()):P("#shippingPrice").val("不支持该配送")},error:function(){x.msg("Get ShippingCost Fail!!!")}})}function m(){I.req({type:"post",url:C.baseUrl+"sys/consumer/user/all",success:function(e){for(var t=0;t<e.data.length;t++)P("#selCustomer").append("<option id="+e.data[t].id+" value="+e.data[t].id+">"+e.data[t].userSystemId+"</option>");k.render("select")}})}function f(e){var t=0;P.each(e,function(i,l){var n=parseFloat(l);(""==n||null==n||isNaN(n))&&(e[i]=0,n=0),t+=n}),j.pcbCost=t.toFixed(2),console.log(j),P("#pcbCost").val(j.pcbCost),g()}function g(){var e=P("#shippingPrice").val();j.shippingPrice=parseFloat(e),P.each(j,function(e,t){(""==t||null==t||isNaN(t))&&(j[e]=0)});var t=parseFloat(j.pcbCost),e=parseFloat(j.shippingPrice),i=(t+e).toFixed(2);j.totalPrice=i,console.log("totalPrice:"+i),K.subtotal=j.totalPrice,O.totalPriced=j.totalPrice,P("#totalPrice").val(j.totalPrice)}function y(){var e;e="Top And Bottom (On Single Stencil)"==V.stencilSide?1:2,V.inStencilCost=V.sQuantity*w.stencilSize_price*e,P("#inStencilCost").val(V.inStencilCost),console.log("计算出的单价为："+V.inStencilCost),b()}function b(){var e=V;console.log("inStencilCost:"+e.inStencilCost);var t=e.postFee+e.inStencilCost;J.totalStencilFee=t,O.totalPricedS=t,P("#stotalPrice").val(t)}function h(){var e=new Object;return e.enginnerFee=parseFloat(P("#enginnerFee").val()),e.boardFee=parseFloat(P("#boardFee").val()),e.testCostFee=parseFloat(P("#testFee").val()),e.toolingFee=parseFloat(P("#toolingFee").val()),e.overworkFee=parseFloat(P("#urgentFee").val()),e}function S(){P("#inStencilCost").val(""),P("#shippingPrice").val(""),P("#totalPrice").val(""),k.render()}var P=layui.jquery,F=layui.view,k=layui.form,I=layui.admin,T=layui.element,C=layui.setter,N=layui.upload,x=layui.layer;T.render();var q=[{text:1,value:1},{text:2,value:2},{text:4,value:4},{text:6,value:6},{text:8,value:8}],A=[{text:1,value:1},{text:2,value:2}],M=[{text:4,value:4},{text:6,value:6},{text:8,value:8}],D=[{text:"KB",value:"KB"},{text:"SY",value:"SY"}],W=[{text:"YG",value:"YG"}],Y=[{text:"KB6160",value:"KB6160"},{text:"KB6150",value:"KB6150"},{text:"KB6165",value:"KB6165"},{text:"KB6167",value:"KB6167"}],z=[{text:"SY1130",value:"SY1130"},{text:"SY1141",value:"SY1141"},{text:"SY1150",value:"SY1150"},{text:"SY1170",value:"SY1170"},{text:"SY1180",value:"SY1180"},{text:"SY1000",value:"SY1000"},{text:"SY1000-2",value:"SY1000-2"},{text:"SY1600",value:"SY1600"}],_=[{text:"YG0001",value:"YG0001"},{text:"YG0002",value:"YG0002"},{text:"YG0003",value:"YG0003"},{text:"YG0004",value:"YG0004"}],B={isDis:{itPanelway:!0,itPanelsize:!0}},Q={bordType:1,companyId:1,countrysId:70,totalWeight:0},w={stencilSize_price:"",stencilWeight:"",stencil_shippingPrice:""},U={postFee:"",customerAid:"",ids:"",orderNo:""},G={courierId:"",countryId:"",totalWeight:""},L={shipping:""},O={totalPric:null,totalPriced:null,isQuote:!1,totalPricS:null,totalPricedS:null,isQuoteS:!1},H=null,K={engineeringFee:"",boardFee:"",testCostFee:"",toolingFee:"",overworkFee:0,buildTime:"",weight:"",postFee:0,subtotal:"",quoteConfigIds:"",productNo:"",userId:"",orderType:1,gerberName:"",gerberPath:"",pcbName:"",orderNo:""},R={},X={stencilWeight:"",inStencilCost:""},j={pcbCost:0,totalPrice:0,shippingPrice:0},V={postFee:w.stencil_shippingPrice,inStencilCost:null,sQuantity:1,stencilSide:"Top And Bottom (On Single Stencil)",sunitPrice:w.stencilSize_price,stotalPrice:null},E=new Object,J={stencilSide:"Top And Bottom (On Single Stencil)",quantity:V.sQuantity,thickness:.12,existingFiducials:.1,totalStencilFee:V.stotalPrice,gerberPath:null,gerberName:null,orderId:null,orderType:1,pcbName:null,postFee:null,orderNo:null,companyId:Q.companyId,countrysId:Q.countrysId,customerSysName:null,userId:null,productNo:null},Z={};c(),l(),i(0),n("FR4"),a(),o("kb"),m();var $,ee,te,ie,le,ne,ae,oe,se=1;P("#singleSizeX,#singleSizeY,#quantityPCS").bind("input propertychange",function(e){t()}),P("#panelSizeX,#panelSizeY,#quantityPanel").bind("input propertychange",function(e){null!=ae&&null!=oe&&null!=ne&&t()}),P("#panelWayX,#panelWayY,#quantityPanel").bind("input propertychange",function(e){t()}),P("input[name='testPoint']").bind("input propertychange",function(e){setTimeout(function(){P(".up-subbtn").click()},1800)}),P("input[name='panelRoutingPath']").bind("input propertychange",function(e){setTimeout(function(){P(".up-subbtn").click()},1800)}),P("input[name='punchingHoles']").bind("input propertychange",function(e){setTimeout(function(){P(".up-subbtn").click()},1800)}),P("input[name='punchingSlots']").bind("input propertychange",function(e){setTimeout(function(){P(".up-subbtn").click()},1800)}),P("input[name='surfaceArea']").bind("input propertychange",function(e){setTimeout(function(){P(".up-subbtn").click()},1800)}),P("#mPrice").bind("input propertychange",function(e){var t=P("#mPrice").val(),i=P("#areasq").val(),l=parseFloat(t*i).toFixed(2),n=P("#boardFee").val();P("#unitPrice").val(parseFloat(n/i).toFixed(2)),P("#boardFee").val(l),x.msg(l)}),P("#rPcbForm").bind("input propertychange",function(){var e=h();f(e),K.postFee=parseFloat(P("#shippingPrice").val()),K.engineeringFee=parseFloat(P("#enginnerFee").val()),K=Object.assign(K,e),console.log(K)}),P("#stencil_quantity").bind("input propertychange",function(){var e=parseFloat(P(this).val());(""==e||null==e||"undefined"==typeof e||isNaN(e))&&(e=0),V.sQuantity=J.quantity=e,y()}),k.on("radio(boardType)",function(e){var t=e.value;"1"==t?(se=1,i(1)):"2"==t&&(se=2,i(2))}),k.on("select(material)",function(e){var t=e.value;"KB"==t?o("kb"):"SY"==t?o("sy"):"YG"==t&&o("yg")}),k.on("select(selSurfacefinish)",function(e){var t=e.value;"HASL_with_lead"==t||"HASL_lead_free"==t?P("#selSurfacethickness").val("2.54-25.4um"):"Immersion_Gold"==t?P("#selSurfacethickness").val("2u"):"Immersion_tin"==t?P("#selSurfacethickness").val("0.5um-0.7um"):"Immersion_silver"==t?P("#selSurfacethickness").val("≥0.05um"):"OSP"==t&&P("#selSurfacethickness").val("0.25-0.5um"),"Immersion_Gold"==t?P("input[name='surfaceArea']").removeAttr("disabled"):P("input[name='surfaceArea']").attr("disabled",!0),k.render("select","quoteForm"),k.render(null,"quoteForm")}),k.on("select(testPointType)",function(e){var t=e.value;"1"==t?P("#testPointT").text("飞针费："):P("#testPointT").text("测试架："),P(".up-subbtn").click()}),k.on("select(stencilSide)",function(e){var t=e.value;console.log(t),V.stencilSide=J.stencilSide=t,y()}),k.on("radio(existingFiducials)",function(e){var t=J.existingFiducials=e.value;x.msg(t)}),k.on("radio(sthickness)",function(e){var t=J.thickness=e.value;x.msg(t)}),k.on("radio(routingType)",function(e){var t=e.value;"1"==t?(P("input[name='panelRoutingPath']").removeAttr("disabled"),P("input[name='punchingHoles']").attr("disabled",!0),P("input[name='punchingSlots']").attr("disabled",!0)):(P("input[name='panelRoutingPath']").attr("disabled",!0),P("input[name='punchingHoles']").removeAttr("disabled"),P("input[name='punchingSlots']").removeAttr("disabled")),P(".up-subbtn").click(),k.render()}),T.on("collapse(orderTypeCol)",function(e){var t=e.title.context.innerText;t.indexOf("PCB Phototype")!=-1?(P(".rig-price-cardbody form").removeClass("quote-avtive"),P(".rig-price").addClass("quote-avtive"),Q.bordType=1):t.indexOf("SMT-Stencil")!=-1?(P(".rig-price-cardbody form").removeClass("quote-avtive"),P("#stencilForm").addClass("quote-avtive"),Q.bordType=2):t.indexOf("Assembly Service")!=-1&&(P(".rig-price-cardbody form").removeClass("quote-avtive"),P("#assemblyForm").addClass("quote-avtive"),Q.bordType=3),S()}),k.on("select(layer)",function(e){var t=e.value;Z.selLayer=t,"1"==re&&("1"==t?(Z.selPthcopper="none",Z.selViaprocess="none"):"2"==t?(Z.selPthcopper="20um",Z.selViaprocess="Follow_gerber"):"4"==t?(c(),Z.selLayer=t,Z.selInlayercoopper="1oz",Z.isDis.selInlayercoopper=!1,Z.selInnerMintrack="5mil",Z.isDis.selInnerMintrack=!1,Z.selNofcore="1",Z.isDis.selNofcore=!1,Z.selNofpp="2",Z.isDis.selNofpp=!1):"6"==t?(c(),Z.selLayer=t,Z.selInlayercoopper="1oz",Z.isDis.selInlayercoopper=!1,Z.selInnerMintrack="5mil",Z.isDis.selInnerMintrack=!1,Z.selNofcore="2",Z.isDis.selNofcore=!1,Z.selNofpp="3",Z.isDis.selNofpp=!1,Z.selPthcopper="none"):"8"==t&&(c(),Z.selLayer=t,Z.selInlayercoopper="1oz",Z.isDis.selInlayercoopper=!1,Z.selInnerMintrack="5mil",Z.isDis.selInnerMintrack=!1,Z.selNofcore="3",Z.isDis.selNofcore=!1,Z.selNofpp="4",Z.isDis.selNofpp=!1,Z.selPthcopper="none"),l())});var re=1;k.on("radio(pcbType)",function(e){var t=e.value;x.msg(t),"FR4"==t?(re=1,n("FR4"),r(),a("FR4")):"Aluminum"==t?(re=2,n("Aluminum"),r(),a("Aluminum")):"FR4+Aluminum"==t&&(re=3,n("FR4+Aluminum"),r(),a("FR4+Aluminum"))}),k.on("radio(buildTimeRadio)",function(e){var t=e.value;console.log(e),console.log(e),K.overworkFee=t,P("#urgentFee").val(t),f()}),k.on("select(selBuildTime)",function(e){var t=e.value,i=P("#selBuildTime").find("option[value="+e.value+"]").text();j.shippingPrice=t,K.overworkFee=t,K.buildTime=i,P("#urgentFee").val(t);var l=h();f(l)}),k.on("select(company)",function(e){Q.companyId=P(e.elem).find("option:selected").attr("value");var t=Q.companyId,i=Q.countrysId;v(t,i),v()}),k.on("select(countrys)",function(e){Q.countrysId=P(e.elem).find("option:selected").attr("value"),2===Q.bordType&&b();var t=Q.companyId,i=Q.countrysId;v(t,i)}),k.on("select(filterCustomer)",function(e){var t=P(e.elem).find("option:selected").text();P("#orderPN").val(""),U.customerAid=e.value,K.userId=J.userId=e.value,J.customerSysName=t,P("#customerId").val(e.value),P("#customerSysName").val(P(e.elem).find("option:selected").text()),k.render("")}),k.on("select(filterOrderType)",function(e){K.orderType=J.orderType=e.value}),P("#postFees").bind("input propertychange",function(e){V.postFee=parseFloat(P(this).val()),y()}),P("#inStencilCost").bind("input propertychange",function(e){V.inStencilCost=parseFloat(P(this).val()),b()}),k.on("submit(assemblyService)",function(e){var e=e.field;return I.req({type:"post",data:e,url:C.imUrl+"quote/getAssemblyQuote",success:function(e){var t=P("#pcbQuantity").val(),i=parseFloat(e.data.totalAssemblyQuote/t);P("#pricePCS").val(i.toFixed(2)),P("#assemblyCost").val(e.data.totalAssemblyQuote),null!=e.data.totalAssemblyWeight&&""!=e.data.totalAssemblyWeight&&P("#assemblyWeight").val(e.data.totalAssemblyWeight),console.log(e);e.data.totalAssemblyQuote,e.data.totalAssemblyWeight}}),!1}),P("#panelWayX,#panelWayY,#quantityPanel").keydown(function(e){var t=parseInt(e.keyCode);return 110!=t}),P("#panelWayX,#panelWayY,#quantityPanel").bind("cut copy paste",function(e){e.preventDefault()}),k.on("submit(quoteForm)",function(e){var e=e.field,t=e.cncAndPunch;return R=e,e.isExistSmt=0,e.stackUp="none",e.innerMinTrack=e.innerMinSpacing,e.outerMinSpacing=e.outerMinTrack,e.silkScreenBotColor=e.solderMaskTopColor,e.solderMaskBotColor=e.solderMaskTopColor,e.surfaceArea=e.surfaceArea,e.orderNo=P("#orderNo").val(),K.orderNo=e.orderNo,e.pcbName=K.pcbName,console.log(e),2!==se||null!=e.panelWayX&&""!=e.panelWayX&&null!=e.panelWayY&&""!=e.panelWayY?null==e.testPoint||""==e.testPoint?(P("html,body").animate({scrollTop:200},"slow"),x.msg("请输入测试点数量 !"),!1):(console.log("surfaceFinish:"+e.surfaceFinish+"\nsurfaceArea:"+e.surfaceArea),"Immersion_Gold"==e.surfaceFinish&&""==e.surfaceArea?(x.msg("请输入沉金面积！"),!1):(I.req({type:"post",url:C.imUrl+"quote/countAdditionInfo",data:e,success:function(e){if(null!=e.data.pcbPriceDetail&&""!=e.data.pcbPriceDetail&&(null==e.data.pcbPriceDetail.qcidList&&""==e.data.pcbPriceDetail.qcidList||(U.ids=e.data.pcbPriceDetail.qcidList,K.quoteConfigIds=e.data.pcbPriceDetail.qcidList.join(","),U.ids=e.data.pcbPriceDetail.qcidList,console.log(U.ids))),console.log(e),K.engineeringFee=e.data.projectQuoteToUSD,K.boardFee=e.data.totalBoardQuoteToUSD,K.testCostFee=e.data.totalTestPointToUSD,K.toolingFee=e.data.cncAndPunchingQuoteToUSD,K.weight=e.data.totalQuoteWeight,Q.totalWeight=e.data.totalQuoteWeight,P("#boardFee").val(e.data.totalBoardQuoteToUSD),P("#enginnerFee").val(e.data.projectQuoteToUSD),P("#pcbWeight").val(e.data.totalQuoteWeight+" KG"),P("#testFee").val(e.data.totalTestPointToUSD),P("#flyingTest").val(e.data.totalTestPointToUSD),P("#routingCost").val(e.data.cncAndPunchingQuoteToUSD),P("#unitPrice").val(e.data.unitPrice),G.totalWeight=e.data.totalQuoteWeight,Q.totalWeight=e.data.totalQuoteWeight,H=e.data.areaType,console.log("areaType:"+H),"1"==t?P("#toolingFee").val(0):P("#toolingFee").val(e.data.cncAndPunchingQuoteToUSD),"1"==H)P("#mPrice").val(""),P("#mPrice").attr("disabled",!0);else{var i=parseFloat(e.data.totalBoardQuoteToUSD/P("#areasq").val()).toFixed(2);P("#mPrice").val(i),P("#mPrice").removeAttr("disabled")}if(f(),u(),null!=G.courierId&&""!=G.courierId||p(),null!=G.countryId&&""!=G.countryId||d(),null!=Q.companyId&&""!=Q.companyId&&null!=Q.countrysId&&""!=Q.countrysId){var l=Q.companyId,n=Q.countrysId;v(l,n)}var a=h();f(a)},error:function(e){alert("Services Error!!!")}}),k.render(),!1)):(x.tips("请输入拼版方式 !","#panelWayX",{tips:[1,"#3595CC"],time:5e3}),!1)}),P(".stencilSide").click(function(){I.popup({title:"Stencil Size",area:["60%","85%"],btn:["确定","取消"],yes:function(e,t){var i=layui.data("stencilList");E=i.params,w.stencilSize_price=E.unitPrice,w.stencilWeight=E.weight,X.stencilWeight=w.stencilWeight,P("#stencilWeight").val(w.stencilWeight+" KG "),X.stencilWeight=w.stencilSize_price,P("#sunitPrice").val(w.stencilSize_price),P("#inStencilSize").val(P("#stenContainer").val()),p(),d(),v(),x.closeAll()},success:function(e,t){F(this.id).render("marketManagement/iframeWindow/stencil_size_list",null).done(function(){})}})});var ce={resetQuoteTab:function(){P("a[title='刷新']").click(),x.msg("重置报价表")},addCustomerFile:function(){x.msg("添加客户资料")},addThisQuote:function(){var e=Object.assign(R,K);return console.log(e),console.log("userId:"+K.userId),null==K.userId||""==K.userId?(x.msg("请先选择客户"),!1):null==K.gerberName||""==K.gerberName?(x.tips("请先上传Gerber资料再添加当前报价 !","#addFile",{tips:[1,"#3595CC"],time:2e3}),!1):void(O.totalPric==O.totalPriced&&1==O.isQuote?x.confirm("你已经添加了相同参数的报价，是否再次添加？",function(){I.req({type:"post",data:e,url:C.baseUrl+"epc/pcborder/save",success:function(e){P("#orderPN").val(e.pn),K.productNo=e.pn,k.render(null,"checkCustomer"),"500"!=e.code&&x.alert("你已成功添加当前报价！")}})}):(I.req({type:"post",data:e,url:C.baseUrl+"epc/pcborder/save",success:function(e){P("#orderPN").val(e.pn),K.productNo=e.pn,k.render(null,"checkCustomer"),"500"!=e.code&&x.alert("你已成功添加当前报价！")}}),O.totalPric=O.totalPriced,O.isQuote=!0))},lookQuote:function(){var e=K.quoteConfigIds;null==U.customerAid||""==U.customerAid?x.msg("请选择对应的客户"):I.popup({title:"产看报价详情",area:["70%","85%"],btn:["确定","取消"],yes:function(e,t){x.closeAll()},success:function(t,i){var l={ids:""};l.ids=K.quoteConfigIds,F(this.id).render("marketManagement/iframeWindow/quote_detaily",l).done(function(){P("#sss").text(e),P("#sss").attr("name",e),console.log(l)})}})},upSubbtn:function(){if("1"==Q.bordType)null==U.customerAid||""==U.customerAid?x.tips("请先选择客户 !","#selCustomer_container",{tips:[1,"#3595CC"],time:2e3}):P(".bot-subbtn").click();else if(2===Q.bordType){P(".rStencilSubmit").click();var e=Object.assign(J,E);if(e.orderNo=P("#orderNo").val(),e.postFee=V.postFee,console.log(e),console.log("saveSMTStencil.gerberPath:"+J.gerberPath),null==e.userId||""==e.userId)return x.msg("请先选择客户"),!1;if(null==e.gerberName||""==e.gerberName)return x.tips("请先上传Gerber资料再添加当前报价 !","#addFile",{tips:[1,"#3595CC"],time:2e3}),!1;O.totalPricS==O.totalPricedS&&1==O.isQuoteS?x.confirm("你已经添加了相同参数的报价，是否再次添加？",function(){I.req({type:"post",data:e,url:C.baseUrl+"epc/stencilorder/save",success:function(e){x.alert("钢网报价成功！"),P("#orderPN").val(e.pn),J.productNo=e.pn}})}):(I.req({type:"post",data:e,url:C.baseUrl+"epc/stencilorder/save",success:function(e){x.alert("钢网报价成功！"),P("#orderPN").val(e.pn),J.productNo=e.pn}}),O.totalPricS=O.totalPricedS,O.isQuoteS=!0)}else 3===Q.bordType&&P(".rAssemblySubmit").click()}};N.render({elem:"#addFile",url:C.baseUrl+"sys/oss/upload/geber?access_token="+layui.data("layuiAdmin").access_token,field:"file",accept:"file",exts:"zip|rar|7z",before:function(e){e.preview(function(e,t,i){var l=t.name;K.gerberName=J.gerberName=l,console.log("上传的文件名为："+l),K.pcbName=J.pcbName=l.substring(0,l.indexOf(".")),null==P("#pcbName").val&&""==P("#pcbName").val||P("#pcbName").val(K.pcbName),k.render(null,"")})},done:function(e,t,i){x.msg("文件上传成功！");var l=e.url,n=/\[(.+?)\]/g,a=l.match(n);console.log("未处理的路径为："+a);var o=a[0].replace(/\[|]/g,"");K.gerberPath=J.gerberPath=o,console.log("处理完的路径为："+o)},error:function(){x.msg("文件上传失败！")}});P(".layui-btn").on("click",function(){var e=P(this).data("type");ce[e]?ce[e].call(this):""}),P(".up-rsetbtn").on("click",function(){P(".bot-rsetbtn").click()}),P(".importPcbInfo>button").on("click",function(){I.popup({title:"导入pcb订单信息",area:["506px","288px"],btn:["导入","取消"],yes:function(e,t){P("#importPCBInfo").click(),x.closeAll()},success:function(e,t){F(this.id).render("marketManagement/iframeWindow/import_pcbInfoForm").done(function(){k.on("submit(importPCBInfo)",function(e){var i=e.field;return console.log(i),I.req({type:"post",url:C.baseUrl+"pert/revieworder/reviewOrderInfo",data:e.field,success:function(e){console.log(e.data);var i=e.data;console.log(i),null!=i?(P("#inside_quote_all input,#inside_quote_all select").each(function(){var e=P(this).attr("name"),t=P(this),l=P(this).attr("type");t.is("input")&&("text"==l||"number"==l?t.val(i[e]):"checkbox"==l?P("input[type=checkbox][name="+e+"][value='"+i[e]+"']").attr("checked","checked"):"radio"==l&&P("input[name="+e+"][value='"+i[e]+"']").prop("checked","checked")),t.is("select")&&P("select[name="+e+"]").find("option:contains('"+i[e]+"')").attr("selected",!0)}),k.render(),x.msg("导入PCB信息成功")):x.alert("当前不存在PCB参数详情！"),x.close(t)}}),!1})})}})}),e("quote",{})});