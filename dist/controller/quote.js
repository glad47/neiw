/** layuiAdmin.pro-v1.0.0 LPPL License By http://www.layui.com/admin/ */
 ;"use strict";layui.define(["admin","form","element","laytpl","layer","upload"],function(e){function t(e){if(1===re){s("1");var t=parseFloat(ee*te*ie)/1e6;F("#areasq").val(t.toFixed(3))}else if(2===re){s("2");var t=parseFloat(oe*se*ae)/1e6;if(F("#areasq").val(t.toFixed(3)),""!=ae&&""!=ne&&""!=le){var i=Math.ceil(ae*ne*le);F("#quantityPCS").val(i)}}}function i(e){F("#areasq").val(""),0===e?(F(".itPanelway input").attr("disabled",Q.isDis.itPanelway),F(".itPanelsize input").attr("disabled",Q.isDis.itPanelsize)):1===e?(F(".mto-input").removeAttr("disabled","true"),F(".itPanelway input").attr("disabled","disabled"),F(".itPanelsize input").attr("disabled","disabled"),F(".itSinlgesize input").val(""),F(".itPanelway input").val(""),F(".itPanelsize input").val("")):2===e&&(F(".mto-input").removeAttr("disabled","true"),F(".itSinlgesize input").attr("disabled","disabled"),F(".itSinlgesize input").val(""))}function n(){F("#selHc").attr("disabled",$.isDis.selHc),F("#selInlayercoopper").attr("disabled",$.isDis.selInlayercoopper),F("#selInnerMintrack").attr("disabled",$.isDis.selInnerMintrack),F("#selNofcore").attr("disabled",$.isDis.selNofcore),F("#selMinspaccing").attr("disabled",$.isDis.selMinspaccing),F("#selNofpp").attr("disabled",$.isDis.selNofpp),F("#radioSinglePcb").attr("checked","true"),F("#ptfr4").attr("checked","true"),F("#routingOne").attr("checked","true"),F("#selLayer").val($.selLayer),F("#selFinishThickness").val($.selFinishThickness),F("#selMaterial").val($.selMaterial),F("#selkbsy").val($.selkbsy),F("#selTg").val($.selTg),F("#selHf").val($.selHf),F("#selHc").val($.selHc),F("#selInlayercoopper").val($.selInlayercoopper),F("#selInnerMintrack").val($.selInnerMintrack),F("#selNofcore").val($.selNofcore),F("#selMinspaccing").val($.selMinspaccing),F("#selNofpp").val($.selNofpp),F("#selOuterlayercopper").val($.selOuterlayercopper),F("#selOutMintrack").val($.selOutMintrack),F("#selBgasize").val($.selBgasize),F("#selMinspacing").val($.selMinspacing),F("#selMinholesize").val($.selMinholesize),F("#selPthcopper").val($.selPthcopper),F("#selSoldermc").val($.selSoldermc),F("#selViaprocess").val($.selViaprocess),F("#selSilksc").val($.selSilksc),F("#selPeelable").val($.selPeelable),F("#selSurfacefinish").val($.selSurfacefinish),F("#selTestcost").val($.selTestcost),k.render()}function l(e){if(F("#selLayer").children().remove(),"Aluminum"==e)for(var t=0;t<M.length;t++){var i=M[t].text,n=M[t].value;F("#selLayer").append("<option value="+n+">"+i+"</option>")}else if("FR4"==e)for(var t=0;t<A.length;t++){var i=A[t].text,n=A[t].value;F("#selLayer").append("<option value="+n+">"+i+"</option>"),r(1)}else if("FR4+Aluminum"==e)for(var t=0;t<D.length;t++){var i=D[t].text,n=D[t].value;F("#selLayer").append("<option value="+n+">"+i+"</option>")}}function a(e){if(F("#selMaterial").children().remove(),"Aluminum"==e){for(var t=0;t<Y.length;t++){var i=Y[t].text,n=Y[t].value;F("#selMaterial").append("<option value="+n+">"+i+"</option>")}o("yg")}else{for(var t=0;t<W.length;t++){var i=W[t].text,n=W[t].value;F("#selMaterial").append("<option value="+n+">"+i+"</option>")}o("kb")}k.render("select")}function o(e){if(F("#selkbsy").children().remove(),"kb"==e)for(var t=0;t<z.length;t++){var i=z[t].text,n=z[t].value;F("#selkbsy").append("<option value="+n+">"+i+"</option>")}else if("yg"==e)for(var t=0;t<B.length;t++){var i=B[t].text,n=B[t].value;F("#selkbsy").append("<option value="+n+">"+i+"</option>")}else if("sy"==e)for(var t=0;t<_.length;t++){var i=_[t].text,n=_[t].value;F("#selkbsy").append("<option value="+n+">"+i+"</option>")}k.render("select")}function s(e){var t=e;"1"==t?(ee=F("#singleSizeX").val(),te=F("#singleSizeY").val(),ie=F("#quantityPCS").val()):"2"==t&&(ne=F("#panelWayX").val(),le=F("#panelWayY").val(),ae=F("#quantityPanel").val(),oe=F("#panelSizeX").val(),se=F("#panelSizeY").val())}function r(e){c(),2===ce?($.selLayer=1,$.selMaterial="YG",$.selkbsy="YG0001",$.selHc="1W",$.selMinholesize="1.5",$.selPthcopper="none",$.selSoldermc="white",$.selViaprocess="none",$.selSilksc="black",$.isDis.selHc=!1):3===ce&&($.selLayer=4,$.selHc="1W",$.selInlayercoopper="1oz",$.selMintrack="5mil",$.selNofcore="1",$.selMinspaccing="5mil",$.selNofpp="2",$.selInnerMintrack="5mil",$.selMinholesize="1.5",$.selPthcopper="none",$.selSoldermc="white",$.selSilksc="black",$.selPeelable="none",$.isDis.selInlayercoopper=!1,$.isDis.selInnerMintrack=!1,$.isDis.selNofcore=!1,$.isDis.selMinspaccing=!1,$.isDis.selNofpp=!1),n()}function c(){$.selLayer=2,$.selFinishThickness="1.6mm",$.selMaterial="KB",$.selkbsy="KB6160",$.selTg="135",$.selHf="NO",$.selHc="none",$.selInlayercoopper="none",$.selMintrack="none",$.selNofcore="none",$.selMinspaccing="none",$.selNofpp="none",$.selOuterlayercopper="1oz",$.selInnerMintrack="none",$.selOutMintrack="5mil",$.selBgasize="0.30",$.selMinspacing="5mil",$.selMinholesize="0.3",$.selPthcopper="20um",$.selSoldermc="green",$.selViaprocess="Follow_gerber",$.selSilksc="white",$.selPeelable="none",$.selSurfacefinish="HASL_with_lead",$.selTestcost="1",$.selCti="175≤CTI<250",$.isDis={},$.isDis.selHc=!0,$.isDis.selInlayercoopper=!0,$.isDis.selInnerMintrack=!0,$.isDis.selNofcore=!0,$.isDis.selMinspaccing=!0,$.isDis.selNofpp=!0}function u(){var e=F("#areasq").val(),t=F("#selLayer").val();F("input[name='buildTime']").remove(),F(".build-time-item .layui-form-radio").remove(),T.req({type:"post",url:C.imUrl+"quote/getBuildTime",data:{areaSq:e,layerNum:t},success:function(e){F(".build-time-item").css("display","");var t;F("#selBuildTime").children().remove();for(var i=0;i<e.data.length;i++)F("#selBuildTime").append("<option value="+e.data[i].price+">"+e.data[i].dayNumber+"</option>"),t=e.data[0].dayNumber;R.buildTime=t,F(".build-time-item input").each(function(){var e=F(this).attr("title");console.log(e),"none"==e&&this.remove()}),k.render()},error:function(){q.msg("Get BuildTime Fail!!!")}})}function p(){var e=null;1===w.bordType?e="selCompany":2===w.bordType?e="selCompanyt":3===w.bordType&&(e="selCompany"),console.log("SelectId:"+e),T.req({type:"post",url:C.imUrl+"quote/getCouriers",success:function(t){F("select[id='"+e+"'] option").remove(),w.companyId=t.data[0].id;for(var i=0;i<t.data.length;i++)F("#"+e).append("<option value="+t.data[i].id+">"+t.data[i].courierName+"</option>"),L.courierId=t.data[0].id,w.companyId=L.courierId;k.render("select")},error:function(){q.msg("Get Couriers Fail!!!")}})}function d(){var e=null;1===w.bordType?e="selCountrys":2===w.bordType?e="selCountryst":3===w.bordType&&(e="selCountryss"),F("select[id='"+e+"'] option").remove(),k.render(),T.req({type:"post",url:C.imUrl+"quote/getCountry",success:function(t){w.countrysId=t.data[0].id;for(var i=0;i<t.data.length;i++)F("#"+e).append("<option value="+t.data[i].id+">"+t.data[i].name+"</option>"),L.countryId=t.data[0].id,w.countrysId=L.countryId,console.log("国家的选中id值为："+L.countryId);k.render()},error:function(){q.msg("Get Countrys Fail!!!")}})}function v(e,t){var i;null!=e&&"undefined"!=typeof e&&""!=e||(e=1),null!=t&&"undefined"!=typeof t&&""!=t||(t=70),i=2===w.bordType?U.stencilWeight:w.totalWeight,T.req({type:"post",url:C.imUrl+"quote/getShippingCost",data:{courierId:e,countryId:t,totalWeight:i},success:function(e){null!=e.data&&1===w.bordType?(R.postFee=e.data.shippingCost,G.postFee=e.data.shippingCost,O.shipping=e.data.shippingCost,F("#shippingPrice").val(O.shipping),g()):null!=e.data&&2===w.bordType?(U.stencil_shippingPrice=E.postFee=e.data.shippingCost,console.log("stencil_shippingPrice:"+U.stencil_shippingPrice),F("#postFees").val(U.stencil_shippingPrice),y()):F("#shippingPrice").val("不支持该配送")},error:function(){q.msg("Get ShippingCost Fail!!!")}})}function m(){T.req({type:"post",url:C.baseUrl+"sys/consumer/user/all",success:function(e){for(var t=0;t<e.data.length;t++)F("#selCustomer").append("<option id="+e.data[t].id+" value="+e.data[t].id+">"+e.data[t].userSystemId+"</option>");k.render("select")}})}function f(e){var t=0;F.each(e,function(i,n){var l=parseFloat(n);(""==l||null==l||isNaN(l))&&(e[i]=0,l=0),t+=l}),V.pcbCost=t.toFixed(2),console.log(V),F("#pcbCost").val(V.pcbCost),g()}function g(){var e=F("#shippingPrice").val();V.shippingPrice=parseFloat(e),F.each(V,function(e,t){(""==t||null==t||isNaN(t))&&(V[e]=0)});var t=parseFloat(V.pcbCost),e=parseFloat(V.shippingPrice),i=(t+e).toFixed(2);V.totalPrice=i,R.subtotal=t,H.totalPriced=V.totalPrice,F("#totalPrice").val(V.totalPrice)}function y(){var e;e="Top And Bottom (On Single Stencil)"==E.stencilSide?1:2,E.inStencilCost=E.sQuantity*U.stencilSize_price*e,F("#inStencilCost").val(E.inStencilCost),b()}function b(){var e=E,t=e.postFee+e.inStencilCost;Z.totalStencilFee=t,H.totalPricedS=t,F("#stotalPrice").val(t),h()}function h(){var e=parseInt(F("#inStencilCost").val()),t=parseInt(F("#stencil_quantity").val());F("#sunitPrice").val((e/t).toFixed(2))}function S(){var e=new Object;return e.enginnerFee=parseFloat(F("#enginnerFee").val()),e.boardFee=parseFloat(F("#boardFee").val()),e.testCostFee=parseFloat(F("#testFee").val()),e.toolingFee=parseFloat(F("#toolingFee").val()),e.overworkFee=parseFloat(F("#urgentFee").val()),e}function P(){F("#inStencilCost").val(""),F("#shippingPrice").val(""),F("#totalPrice").val(""),k.render()}var F=layui.jquery,I=layui.view,k=layui.form,T=layui.admin,N=layui.element,C=layui.setter,x=layui.upload,q=layui.layer;N.render();var A=[{text:0,value:0},{text:1,value:1},{text:2,value:2},{text:4,value:4},{text:6,value:6},{text:8,value:8}],M=[{text:0,value:0},{text:1,value:1},{text:2,value:2}],D=[{text:0,value:0},{text:4,value:4},{text:6,value:6},{text:8,value:8}],W=[{text:"KB",value:"KB"},{text:"SY",value:"SY"}],Y=[{text:"YG",value:"YG"}],z=[{text:"KB6160",value:"KB6160"},{text:"KB6150",value:"KB6150"},{text:"KB6165",value:"KB6165"},{text:"KB6167",value:"KB6167"}],_=[{text:"SY1130",value:"SY1130"},{text:"SY1141",value:"SY1141"},{text:"SY1150",value:"SY1150"},{text:"SY1170",value:"SY1170"},{text:"SY1180",value:"SY1180"},{text:"SY1000",value:"SY1000"},{text:"SY1000-2",value:"SY1000-2"},{text:"SY1600",value:"SY1600"}],B=[{text:"YG0001",value:"YG0001"},{text:"YG0002",value:"YG0002"},{text:"YG0003",value:"YG0003"},{text:"YG0004",value:"YG0004"}],Q={isDis:{itPanelway:!0,itPanelsize:!0}},w={bordType:1,companyId:1,countrysId:70,totalWeight:0},U={stencilSize_price:"",stencilWeight:"",stencil_shippingPrice:""},G={postFee:"",customerAid:"",ids:"",orderNo:""},L={courierId:"",countryId:"",totalWeight:""},O={shipping:""},H={totalPric:null,totalPriced:null,isQuote:!1,totalPricS:null,totalPricedS:null,isQuoteS:!1},K=null,R={engineeringFee:"",boardFee:"",testCostFee:"",toolingFee:"",overworkFee:0,buildTime:"",weight:"",postFee:0,subtotal:"",quoteConfigIds:"",productNo:"",userId:"",orderType:1,gerberName:"",gerberPath:"",pcbName:"",orderNo:"",countries:"Afghanistan"},X={},j={stencilWeight:"",inStencilCost:""},V={pcbCost:0,totalPrice:0,shippingPrice:0},E={postFee:U.stencil_shippingPrice,inStencilCost:null,sQuantity:1,stencilSide:"Top And Bottom (On Single Stencil)",sunitPrice:U.stencilSize_price,stotalPrice:null},J=new Object,Z={stencilSide:"Top And Bottom (On Single Stencil)",quantity:E.sQuantity,thickness:.12,existingFiducials:.1,totalStencilFee:E.stotalPrice,gerberPath:null,gerberName:null,orderId:null,orderType:1,pcbName:null,postFee:null,orderNo:null,companyId:w.companyId,countrysId:w.countrysId,customerSysName:null,userId:null,productNo:null},$={};c(),n(),i(0),l("FR4"),a(),o("kb"),m();var ee,te,ie,ne,le,ae,oe,se,re=1;F("#singleSizeX,#singleSizeY,#quantityPCS").bind("input propertychange",function(e){t()}),F("#panelSizeX,#panelSizeY,#quantityPanel").bind("input propertychange",function(e){null!=oe&&null!=se&&null!=ae&&t()}),F("#panelWayX,#panelWayY,#quantityPanel").bind("input propertychange",function(e){t()}),F("input[name='testPoint']").bind("input propertychange",function(e){setTimeout(function(){F(".up-subbtn").click()},1800)}),F("input[name='panelRoutingPath']").bind("input propertychange",function(e){setTimeout(function(){F(".up-subbtn").click()},1800)}),F("input[name='punchingHoles']").bind("input propertychange",function(e){setTimeout(function(){F(".up-subbtn").click()},1800)}),F("input[name='punchingSlots']").bind("input propertychange",function(e){setTimeout(function(){F(".up-subbtn").click()},1800)}),F("input[name='surfaceArea']").bind("input propertychange",function(e){setTimeout(function(){F(".up-subbtn").click()},1800)}),F("#mPrice").bind("input propertychange",function(e){var t=F("#mPrice").val(),i=F("#areasq").val(),n=parseFloat(t*i).toFixed(2),l=F("#boardFee").val();F("#unitPrice").val(parseFloat(l/i).toFixed(2)),F("#boardFee").val(n),q.msg(n)}),F("#rPcbForm").bind("input propertychange",function(){var e=S();f(e),R.postFee=parseFloat(F("#shippingPrice").val()),R.engineeringFee=parseFloat(F("#enginnerFee").val()),R=Object.assign(R,e),console.log(R)}),F("#stencil_quantity").bind("input propertychange",function(){var e=parseFloat(F(this).val());(""==e||null==e||"undefined"==typeof e||isNaN(e))&&(e=0),E.sQuantity=Z.quantity=e,y()}),k.on("radio(boardType)",function(e){var t=e.value;"1"==t?(re=1,i(1)):"2"==t&&(re=2,i(2))}),k.on("select(material)",function(e){var t=e.value;"KB"==t?o("kb"):"SY"==t?o("sy"):"YG"==t&&o("yg")}),k.on("select(selSurfacefinish)",function(e){var t=e.value;"HASL_with_lead"==t||"HASL_lead_free"==t?F("#selSurfacethickness").val("2.54-25.4um"):"Immersion_Gold"==t?F("#selSurfacethickness").val("2u"):"Immersion_tin"==t?F("#selSurfacethickness").val("0.5um-0.7um"):"Immersion_silver"==t?F("#selSurfacethickness").val("≥0.05um"):"OSP"==t&&F("#selSurfacethickness").val("0.25-0.5um"),"Immersion_Gold"==t?F("input[name='surfaceArea']").removeAttr("disabled"):F("input[name='surfaceArea']").attr("disabled",!0),k.render("select","quoteForm"),k.render(null,"quoteForm")}),k.on("select(testPointType)",function(e){var t=e.value;"1"==t?F("#testPointT").text("飞针费："):F("#testPointT").text("测试架："),F(".up-subbtn").click()}),k.on("select(stencilSide)",function(e){var t=e.value;console.log(t),E.stencilSide=Z.stencilSide=t,y()}),k.on("radio(existingFiducials)",function(e){var t=Z.existingFiducials=e.value;q.msg(t)}),k.on("radio(sthickness)",function(e){var t=Z.thickness=e.value;q.msg(t)}),k.on("radio(routingType)",function(e){var t=e.value;"1"==t?(F("input[name='panelRoutingPath']").removeAttr("disabled"),F("input[name='punchingHoles']").attr("disabled",!0),F("input[name='punchingSlots']").attr("disabled",!0)):(F("input[name='panelRoutingPath']").attr("disabled",!0),F("input[name='punchingHoles']").removeAttr("disabled"),F("input[name='punchingSlots']").removeAttr("disabled")),F(".up-subbtn").click(),k.render()}),N.on("collapse(orderTypeCol)",function(e){var t=e.title.context.innerText;t.indexOf("PCB Phototype")!=-1?(F(".rig-price-cardbody form").removeClass("quote-avtive"),F(".rig-price").addClass("quote-avtive"),w.bordType=1):t.indexOf("SMT-Stencil")!=-1?(F(".rig-price-cardbody form").removeClass("quote-avtive"),F("#stencilForm").addClass("quote-avtive"),w.bordType=2):t.indexOf("Assembly Service")!=-1&&(F(".rig-price-cardbody form").removeClass("quote-avtive"),F("#assemblyForm").addClass("quote-avtive"),w.bordType=3),P()}),k.on("select(layer)",function(e){var t=e.value;$.selLayer=t,"1"==ce&&("1"==t?($.selPthcopper="none",$.selViaprocess="none"):"2"==t?($.selPthcopper="20um",$.selViaprocess="Follow_gerber"):"4"==t?(c(),$.selLayer=t,$.selInlayercoopper="1oz",$.isDis.selInlayercoopper=!1,$.selInnerMintrack="5mil",$.isDis.selInnerMintrack=!1,$.selNofcore="1",$.isDis.selNofcore=!1,$.selNofpp="2",$.isDis.selNofpp=!1):"6"==t?(c(),$.selLayer=t,$.selInlayercoopper="1oz",$.isDis.selInlayercoopper=!1,$.selInnerMintrack="5mil",$.isDis.selInnerMintrack=!1,$.selNofcore="2",$.isDis.selNofcore=!1,$.selNofpp="3",$.isDis.selNofpp=!1,$.selPthcopper="none"):"8"==t&&(c(),$.selLayer=t,$.selInlayercoopper="1oz",$.isDis.selInlayercoopper=!1,$.selInnerMintrack="5mil",$.isDis.selInnerMintrack=!1,$.selNofcore="3",$.isDis.selNofcore=!1,$.selNofpp="4",$.isDis.selNofpp=!1,$.selPthcopper="none"),n())});var ce=1;k.on("radio(pcbType)",function(e){var t=e.value;q.msg(t),"FR4"==t?(ce=1,l("FR4"),r(),a("FR4")):"Aluminum"==t?(ce=2,l("Aluminum"),r(),a("Aluminum")):"FR4+Aluminum"==t&&(ce=3,l("FR4+Aluminum"),r(),a("FR4+Aluminum"))}),k.on("radio(buildTimeRadio)",function(e){var t=e.value;console.log(e),console.log(e),R.overworkFee=t,F("#urgentFee").val(t),f()}),k.on("select(selBuildTime)",function(e){var t=e.value,i=F("#selBuildTime").find("option[value="+e.value+"]").text();V.shippingPrice=t,R.overworkFee=t,R.buildTime=i,F("#urgentFee").val(t);var n=S();f(n)}),k.on("select(company)",function(e){w.companyId=F(e.elem).find("option:selected").attr("value");var t=w.companyId,i=w.countrysId;v(t,i),v()}),k.on("select(countrys)",function(e){w.countrysId=F(e.elem).find("option:selected").attr("value"),R.countries=w.countrysId,2===w.bordType&&b();var t=w.companyId,i=w.countrysId;v(t,i)}),k.on("select(filterCustomer)",function(e){var t=F(e.elem).find("option:selected").text();F("#orderPN").val(""),G.customerAid=e.value,R.userId=Z.userId=e.value,Z.customerSysName=t,F("#customerId").val(e.value),F("#customerSysName").val(F(e.elem).find("option:selected").text()),k.render("")}),k.on("select(filterOrderType)",function(e){R.orderType=Z.orderType=e.value}),F("#postFees").bind("input propertychange",function(e){E.postFee=parseFloat(F(this).val()),y()}),F("#inStencilCost").bind("input propertychange",function(e){E.inStencilCost=parseFloat(F(this).val()),b()}),k.on("submit(assemblyService)",function(e){var e=e.field;return T.req({type:"post",data:e,url:C.imUrl+"quote/getAssemblyQuote",success:function(e){var t=F("#pcbQuantity").val(),i=parseFloat(e.data.totalAssemblyQuote/t);F("#pricePCS").val(i.toFixed(2)),F("#assemblyCost").val(e.data.totalAssemblyQuote),null!=e.data.totalAssemblyWeight&&""!=e.data.totalAssemblyWeight&&F("#assemblyWeight").val(e.data.totalAssemblyWeight),console.log(e);e.data.totalAssemblyQuote,e.data.totalAssemblyWeight}}),!1}),F("#panelWayX,#panelWayY,#quantityPanel").keydown(function(e){var t=parseInt(e.keyCode);return 110!=t}),F("#panelWayX,#panelWayY,#quantityPanel").bind("cut copy paste",function(e){e.preventDefault()}),k.on("submit(quoteForm)",function(e){var e=e.field,t=e.cncAndPunch;return X=e,e.isExistSmt=0,e.stackUp="none",e.innerMinTrack=e.innerMinSpacing,e.outerMinSpacing=e.outerMinTrack,e.silkScreenBotColor=e.solderMaskTopColor,e.solderMaskBotColor=e.solderMaskTopColor,e.surfaceArea=e.surfaceArea,e.orderNo=F("#orderNo").val(),R.orderNo=e.orderNo,e.pcbName=R.pcbName,console.log(e),2!==re||null!=e.panelWayX&&""!=e.panelWayX&&null!=e.panelWayY&&""!=e.panelWayY?null==e.testPoint||""==e.testPoint?(F("html,body").animate({scrollTop:200},"slow"),q.msg("请输入测试点数量 !"),!1):(console.log("surfaceFinish:"+e.surfaceFinish+"\nsurfaceArea:"+e.surfaceArea),"Immersion_Gold"==e.surfaceFinish&&""==e.surfaceArea?(q.msg("请输入沉金面积！"),!1):(T.req({type:"post",url:C.imUrl+"quote/countAdditionInfo",data:e,success:function(e){if(null!=e.data.pcbPriceDetail&&""!=e.data.pcbPriceDetail&&(null==e.data.pcbPriceDetail.qcidList&&""==e.data.pcbPriceDetail.qcidList||(G.ids=e.data.pcbPriceDetail.qcidList,R.quoteConfigIds=e.data.pcbPriceDetail.qcidList.join(","),G.ids=e.data.pcbPriceDetail.qcidList,console.log(G.ids))),console.log(e),R.engineeringFee=e.data.projectQuoteToUSD,R.boardFee=e.data.totalBoardQuoteToUSD,R.testCostFee=e.data.totalTestPointToUSD,R.toolingFee=e.data.cncAndPunchingQuoteToUSD,R.weight=e.data.totalQuoteWeight,w.totalWeight=e.data.totalQuoteWeight,F("#boardFee").val(e.data.totalBoardQuoteToUSD),F("#enginnerFee").val(e.data.projectQuoteToUSD),F("#pcbWeight").val(e.data.totalQuoteWeight+" KG"),F("#testFee").val(e.data.totalTestPointToUSD),F("#flyingTest").val(e.data.totalTestPointToUSD),F("#routingCost").val(e.data.cncAndPunchingQuoteToUSD),F("#unitPrice").val(e.data.unitPrice),L.totalWeight=e.data.totalQuoteWeight,w.totalWeight=e.data.totalQuoteWeight,K=e.data.areaType,console.log("areaType:"+K),"1"==t?F("#toolingFee").val(0):F("#toolingFee").val(e.data.cncAndPunchingQuoteToUSD),"1"==K)F("#mPrice").val(""),F("#mPrice").attr("disabled",!0);else{var i=parseFloat(e.data.totalBoardQuoteToUSD/F("#areasq").val()).toFixed(2);F("#mPrice").val(i),F("#mPrice").removeAttr("disabled")}if(f(),u(),null!=L.courierId&&""!=L.courierId||p(),null!=L.countryId&&""!=L.countryId||d(),null!=w.companyId&&""!=w.companyId&&null!=w.countrysId&&""!=w.countrysId){var n=w.companyId,l=w.countrysId;v(n,l)}var a=S();f(a)},error:function(e){alert("Services Error!!!")}}),k.render(),!1)):(q.tips("请输入拼版方式 !","#panelWayX",{tips:[1,"#3595CC"],time:5e3}),!1)}),F(".stencilSide").click(function(){T.popup({title:"Stencil Size",area:["60%","85%"],btn:["确定","取消"],yes:function(e,t){var i=layui.data("stencilList");J=i.params,U.stencilSize_price=J.unitPrice,U.stencilWeight=J.weight,j.stencilWeight=U.stencilWeight,F("#stencilWeight").val(U.stencilWeight+" KG "),j.stencilWeight=U.stencilSize_price,F("#inStencilSize").val(F("#stenContainer").val()),p(),d(),v(),q.closeAll()},success:function(e,t){I(this.id).render("marketManagement/iframeWindow/stencil_size_list",null).done(function(){})}})});var ue={resetQuoteTab:function(){F("a[title='刷新']").click(),q.msg("重置报价表")},addCustomerFile:function(){q.msg("添加客户资料")},addThisQuote:function(){var e=Object.assign(X,R);return console.log(e),console.log("userId:"+R.userId),null==R.userId||""==R.userId?(q.msg("请先选择客户"),!1):null==R.gerberName||""==R.gerberName?(q.tips("请先上传Gerber资料再添加当前报价 !","#addFile",{tips:[1,"#3595CC"],time:2e3}),!1):void(H.totalPric==H.totalPriced&&1==H.isQuote?q.confirm("你已经添加了相同参数的报价，是否再次添加？",function(){T.req({type:"post",data:e,url:C.baseUrl+"epc/pcborder/save",success:function(e){F("#orderPN").val(e.pn),R.productNo=e.pn,k.render(null,"checkCustomer"),"500"!=e.code&&q.alert("你已成功添加当前报价！")}})}):(T.req({type:"post",data:e,url:C.baseUrl+"epc/pcborder/save",success:function(e){F("#orderPN").val(e.pn),R.productNo=e.pn,k.render(null,"checkCustomer"),"500"!=e.code&&q.alert("你已成功添加当前报价！")}}),H.totalPric=H.totalPriced,H.isQuote=!0))},lookQuote:function(){var e=R.quoteConfigIds;null==G.customerAid||""==G.customerAid?q.msg("请选择对应的客户"):T.popup({title:"产看报价详情",area:["70%","85%"],btn:["确定","取消"],yes:function(e,t){q.closeAll()},success:function(t,i){var n={ids:""};n.ids=R.quoteConfigIds,I(this.id).render("marketManagement/iframeWindow/quote_detaily",n).done(function(){F("#sss").text(e),F("#sss").attr("name",e),console.log(n)})}})},upSubbtn:function(){if("1"==w.bordType)null==G.customerAid||""==G.customerAid?q.tips("请先选择客户 !","#selCustomer_container",{tips:[1,"#3595CC"],time:2e3}):F(".bot-subbtn").click();else if(2===w.bordType){F(".rStencilSubmit").click();var e=Object.assign(Z,J);if(e.orderNo=F("#orderNo").val(),e.postFee=E.postFee,console.log(e),console.log("saveSMTStencil.gerberPath:"+Z.gerberPath),null==e.userId||""==e.userId)return q.msg("请先选择客户"),!1;if(null==e.gerberName||""==e.gerberName)return q.tips("请先上传Gerber资料再添加当前报价 !","#addFile",{tips:[1,"#3595CC"],time:2e3}),!1;H.totalPricS==H.totalPricedS&&1==H.isQuoteS?q.confirm("你已经添加了相同参数的报价，是否再次添加？",function(){T.req({type:"post",data:e,url:C.baseUrl+"epc/stencilorder/save",success:function(e){q.alert("钢网报价成功！"),F("#orderPN").val(e.pn),Z.productNo=e.pn}})}):(T.req({type:"post",data:e,url:C.baseUrl+"epc/stencilorder/save",success:function(e){q.alert("钢网报价成功！"),F("#orderPN").val(e.pn),Z.productNo=e.pn}}),H.totalPricS=H.totalPricedS,H.isQuoteS=!0)}else 3===w.bordType&&F(".rAssemblySubmit").click()}};x.render({elem:"#addFile",url:C.baseUrl+"sys/oss/upload/geber?access_token="+layui.data("layuiAdmin").access_token,field:"file",accept:"file",exts:"zip|rar|7z",before:function(e){e.preview(function(e,t,i){var n=t.name;R.gerberName=Z.gerberName=n,console.log("上传的文件名为："+n),R.pcbName=Z.pcbName=n.substring(0,n.indexOf(".")),null==F("#pcbName").val&&""==F("#pcbName").val||F("#pcbName").val(R.pcbName),k.render(null,"")})},done:function(e,t,i){q.msg("文件上传成功！");var n=e.url,l=/\[(.+?)\]/g,a=n.match(l);console.log("未处理的路径为："+a);var o=a[0].replace(/\[|]/g,"");R.gerberPath=Z.gerberPath=o,console.log("处理完的路径为："+o)},error:function(){q.msg("文件上传失败！")}});F(".layui-btn").on("click",function(){var e=F(this).data("type");ue[e]?ue[e].call(this):""}),F(".up-rsetbtn").on("click",function(){F(".bot-rsetbtn").click()}),F(".importPcbInfo>button").on("click",function(){T.popup({title:"导入pcb订单信息",area:["506px","288px"],btn:["导入","取消"],yes:function(e,t){F("#importPCBInfo").click(),q.closeAll()},success:function(e,t){I(this.id).render("marketManagement/iframeWindow/import_pcbInfoForm").done(function(){k.on("submit(importPCBInfo)",function(e){var i=e.field;return console.log(i),T.req({type:"post",url:C.baseUrl+"pert/revieworder/reviewOrderInfo",data:e.field,success:function(e){console.log(e.data);var i=e.data;console.log(i),null!=i?(F("#inside_quote_all input,#inside_quote_all select").each(function(){var e=F(this).attr("name"),t=F(this),n=F(this).attr("type");t.is("input")&&("text"==n||"number"==n?t.val(i[e]):"checkbox"==n?F("input[type=checkbox][name="+e+"][value='"+i[e]+"']").attr("checked","checked"):"radio"==n&&F("input[name="+e+"][value='"+i[e]+"']").prop("checked","checked")),t.is("select")&&F("select[name="+e+"]").find("option:contains('"+i[e]+"')").attr("selected",!0)}),k.render(),q.msg("导入PCB信息成功")):q.alert("当前不存在PCB参数详情！"),q.close(t)}}),!1})})}})}),e("quote",{})});