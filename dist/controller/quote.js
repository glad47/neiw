/** layuiAdmin.pro-v1.0.0 LPPL License By http://www.layui.com/admin/ */
 ;"use strict";layui.define(["admin","form","element","laytpl","layer","upload","jsTools"],function(e){function t(e){if(1===ue){s("1");var t=parseFloat(ie*ne*le)/1e6;I("#areasq").val(t.toFixed(3))}else if(2===ue){s("2");var t=parseFloat(re*ce*se)/1e6;if(I("#areasq").val(t.toFixed(3)),""!=se&&""!=ae&&""!=oe){var i=Math.ceil(se*ae*oe);I("#quantityPCS").val(i)}}}function i(e){I("#areasq").val(""),0===e?(I(".itPanelway input").attr("disabled",O.isDis.itPanelway),I(".itPanelsize input").attr("disabled",O.isDis.itPanelsize)):1===e?(I(".mto-input").removeAttr("disabled","true"),I(".itPanelway input").attr("disabled","disabled"),I(".itPanelsize input").attr("disabled","disabled"),I(".itSinlgesize input").val(""),I(".itPanelway input").val(""),I(".itPanelsize input").val("")):2===e&&(I(".mto-input").removeAttr("disabled","true"),I(".itSinlgesize input").attr("disabled","disabled"),I(".itSinlgesize input").val(""))}function n(){I("#selHc").attr("disabled",te.isDis.selHc),I("#selInlayercoopper").attr("disabled",te.isDis.selInlayercoopper),I("#selInnerMintrack").attr("disabled",te.isDis.selInnerMintrack),I("#selNofcore").attr("disabled",te.isDis.selNofcore),I("#selMinspaccing").attr("disabled",te.isDis.selMinspaccing),I("#selNofpp").attr("disabled",te.isDis.selNofpp),I("#radioSinglePcb").attr("checked","true"),I("#ptfr4").attr("checked","true"),I("#routingOne").attr("checked","true"),I("#selLayer").val(te.selLayer),I("#selFinishThickness").val(te.selFinishThickness),I("#selMaterial").val(te.selMaterial),I("#selkbsy").val(te.selkbsy),I("#selTg").val(te.selTg),I("#selHf").val(te.selHf),I("#selHc").val(te.selHc),I("#selInlayercoopper").val(te.selInlayercoopper),I("#selInnerMintrack").val(te.selInnerMintrack),I("#selNofcore").val(te.selNofcore),I("#selMinspaccing").val(te.selMinspaccing),I("#selNofpp").val(te.selNofpp),I("#selOuterlayercopper").val(te.selOuterlayercopper),I("#selOutMintrack").val(te.selOutMintrack),I("#selBgasize").val(te.selBgasize),I("#selMinspacing").val(te.selMinspacing),I("#selMinholesize").val(te.selMinholesize),I("#selPthcopper").val(te.selPthcopper),I("#selSoldermc").val(te.selSoldermc),I("#selViaprocess").val(te.selViaprocess),I("#selSilksc").val(te.selSilksc),I("#selPeelable").val(te.selPeelable),I("#selSurfacefinish").val(te.selSurfacefinish),I("#selTestcost").val(te.selTestcost),T.render()}function l(e){if(I("#selLayer").children().remove(),"Aluminum"==e)for(var t=0;t<W.length;t++){var i=W[t].text,n=W[t].value;I("#selLayer").append("<option value="+n+">"+i+"</option>")}else if("FR4"==e)for(var t=0;t<D.length;t++){var i=D[t].text,n=D[t].value;I("#selLayer").append("<option value="+n+">"+i+"</option>"),r(1)}else if("FR4+Aluminum"==e)for(var t=0;t<Y.length;t++){var i=Y[t].text,n=Y[t].value;I("#selLayer").append("<option value="+n+">"+i+"</option>")}}function a(e){if(I("#selMaterial").children().remove(),"Aluminum"==e){for(var t=0;t<z.length;t++){var i=z[t].text,n=z[t].value;I("#selMaterial").append("<option value="+n+">"+i+"</option>")}o("yg")}else{for(var t=0;t<B.length;t++){var i=B[t].text,n=B[t].value;I("#selMaterial").append("<option value="+n+">"+i+"</option>")}o("kb")}T.render("select")}function o(e){if(I("#selkbsy").children().remove(),"kb"==e)for(var t=0;t<_.length;t++){var i=_[t].text,n=_[t].value;I("#selkbsy").append("<option value="+n+">"+i+"</option>")}else if("yg"==e)for(var t=0;t<Q.length;t++){var i=Q[t].text,n=Q[t].value;I("#selkbsy").append("<option value="+n+">"+i+"</option>")}else if("sy"==e)for(var t=0;t<w.length;t++){var i=w[t].text,n=w[t].value;I("#selkbsy").append("<option value="+n+">"+i+"</option>")}T.render("select")}function s(e){var t=e;"1"==t?(ie=I("#singleSizeX").val(),ne=I("#singleSizeY").val(),le=I("#quantityPCS").val()):"2"==t&&(ae=I("#panelWayX").val(),oe=I("#panelWayY").val(),se=I("#quantityPanel").val(),re=I("#panelSizeX").val(),ce=I("#panelSizeY").val())}function r(e){c(),2===pe?(te.selLayer=1,te.selMaterial="YG",te.selkbsy="YG0001",te.selHc="1W",te.selMinholesize="1.5",te.selPthcopper="none",te.selSoldermc="white",te.selViaprocess="none",te.selSilksc="black",te.isDis.selHc=!1):3===pe&&(te.selLayer=4,te.selHc="1W",te.selInlayercoopper="1oz",te.selMintrack="5mil",te.selNofcore="1",te.selMinspaccing="5mil",te.selNofpp="2",te.selInnerMintrack="5mil",te.selMinholesize="1.5",te.selPthcopper="none",te.selSoldermc="white",te.selSilksc="black",te.selPeelable="none",te.isDis.selInlayercoopper=!1,te.isDis.selInnerMintrack=!1,te.isDis.selNofcore=!1,te.isDis.selMinspaccing=!1,te.isDis.selNofpp=!1),n()}function c(){te.selLayer=2,te.selFinishThickness="1.6mm",te.selMaterial="KB",te.selkbsy="KB6160",te.selTg="135",te.selHf="NO",te.selHc="none",te.selInlayercoopper="none",te.selMintrack="none",te.selNofcore="none",te.selMinspaccing="none",te.selNofpp="none",te.selOuterlayercopper="1oz",te.selInnerMintrack="none",te.selOutMintrack="5mil",te.selBgasize="0.30",te.selMinspacing="5mil",te.selMinholesize="0.3",te.selPthcopper="20um",te.selSoldermc="green",te.selViaprocess="Follow_gerber",te.selSilksc="white",te.selPeelable="none",te.selSurfacefinish="HASL_with_lead",te.selTestcost="1",te.selCti="175≤CTI<250",te.isDis={},te.isDis.selHc=!0,te.isDis.selInlayercoopper=!0,te.isDis.selInnerMintrack=!0,te.isDis.selNofcore=!0,te.isDis.selMinspaccing=!0,te.isDis.selNofpp=!0}function u(){var e=I("#areasq").val(),t=I("#selLayer").val();I("input[name='buildTime']").remove(),I(".build-time-item .layui-form-radio").remove(),C.req({type:"post",url:x.imUrl+"quote/getBuildTime",data:{areaSq:e,layerNum:t},success:function(e){I(".build-time-item").css("display","");var t;I("#selBuildTime").children().remove();for(var i=0;i<e.data.length;i++)I("#selBuildTime").append("<option value="+e.data[i].price+">"+e.data[i].dayNumber+"</option>"),t=e.data[0].dayNumber;X.buildTime=t,I(".build-time-item input").each(function(){var e=I(this).attr("title");console.log(e),"none"==e&&this.remove()}),T.render()},error:function(){M.msg("Get BuildTime Fail!!!")}})}function p(){var e=null;1===U.bordType?e="selCompany":2===U.bordType?e="selCompanyt":3===U.bordType&&(e="selCompany"),console.log("SelectId:"+e),C.req({type:"post",url:x.imUrl+"quote/getCouriers",success:function(t){I("select[id='"+e+"'] option").remove(),U.companyId=t.data[0].id;for(var i=0;i<t.data.length;i++)I("#"+e).append("<option value="+t.data[i].id+">"+t.data[i].courierName+"</option>"),H.courierId=t.data[0].id,U.companyId=H.courierId;T.render("select")},error:function(){M.msg("Get Couriers Fail!!!")}})}function d(){var e=null;1===U.bordType?e="selCountrys":2===U.bordType?e="selCountryst":3===U.bordType&&(e="selCountryss"),I("select[id='"+e+"'] option").remove(),T.render(),C.req({type:"post",url:x.imUrl+"quote/getCountry",success:function(t){U.countrysId=t.data[0].id;for(var i=0;i<t.data.length;i++)I("#"+e).append("<option value="+t.data[i].id+">"+t.data[i].name+"</option>"),H.countryId=t.data[0].id,U.countrysId=H.countryId,console.log("国家的选中id值为："+H.countryId);T.render()},error:function(){M.msg("Get Countrys Fail!!!")}})}function v(e,t){var i;null!=e&&"undefined"!=typeof e&&""!=e||(e=1),null!=t&&"undefined"!=typeof t&&""!=t||(t=70),i=2===U.bordType?G.stencilWeight:U.totalWeight,C.req({type:"post",url:x.imUrl+"quote/getShippingCost",data:{courierId:e,countryId:t,totalWeight:i},success:function(e){null!=e.data&&1===U.bordType?(X.postFee=e.data.shippingCost,L.postFee=e.data.shippingCost,R.shipping=e.data.shippingCost,I("#shippingPrice").val(R.shipping),y()):null!=e.data&&2===U.bordType?(G.stencil_shippingPrice=Z.postFee=e.data.shippingCost,console.log("stencil_shippingPrice:"+G.stencil_shippingPrice),I("#postFees").val(G.stencil_shippingPrice),g()):I("#shippingPrice").val("不支持该配送")},error:function(){M.msg("Get ShippingCost Fail!!!")}})}function m(){C.req({type:"post",url:x.baseUrl+"sys/consumer/user/all",success:function(e){for(var t=0;t<e.data.length;t++)I("#selCustomer").append("<option id="+e.data[t].id+" value="+e.data[t].id+">"+e.data[t].userSystemId+"</option>");T.render("select")}})}function f(e){var t=0;I.each(e,function(i,n){var l=parseFloat(n);(""==l||null==l||isNaN(l))&&(e[i]=0,l=0),t+=l}),J.pcbCost=t.toFixed(2),console.log(J),I("#pcbCost").val(J.pcbCost),y()}function y(){var e=I("#shippingPrice").val();J.shippingPrice=parseFloat(e),I.each(J,function(e,t){(""==t||null==t||isNaN(t))&&(J[e]=0)});var t=parseFloat(J.pcbCost),e=parseFloat(J.shippingPrice),i=(t+e).toFixed(2);J.totalPrice=i,X.subtotal=t,K.totalPriced=J.totalPrice,I("#totalPrice").val(J.totalPrice)}function g(){var e;e="Top And Bottom (On Single Stencil)"==Z.stencilSide||"Top"==Z.stencilSide||"Bottom"==Z.stencilSide?1:2,Z.inStencilCost=Z.sQuantity*G.stencilSize_price*e,I("#inStencilCost").val(Z.inStencilCost),b()}function b(){var e=Z,t=e.postFee+e.inStencilCost;ee.totalStencilFee=t,K.totalPricedS=t,I("#stotalPrice").val(t),h()}function h(){var e=parseInt(I("#inStencilCost").val()),t=parseInt(I("#stencil_quantity").val()),i=(e/t).toFixed(2);$.unitPrice=i,I("#sunitPrice").val(i)}function S(){var e=new Object;return e.enginnerFee=parseFloat(I("#enginnerFee").val()),e.boardFee=parseFloat(I("#boardFee").val()),e.testCostFee=parseFloat(I("#testFee").val()),e.toolingFee=parseFloat(I("#toolingFee").val()),e.overworkFee=parseFloat(I("#urgentFee").val()),e}function P(){I("#inStencilCost").val(""),I("#shippingPrice").val(""),I("#totalPrice").val(""),T.render()}function F(e){I("#inside_quote_all input,#inside_quote_all select").each(function(){var t=I(this).attr("name"),i=I(this),n=I(this).attr("type");i.is("input")&&("text"==n||"number"==n?i.val(e[t]):"checkbox"==n?I("input[type=checkbox][name="+t+"][value='"+e[t]+"']").attr("checked","checked"):"radio"==n&&I("input[name="+t+"][value='"+e[t]+"']").prop("checked","checked")),i.is("select")&&I("select[name="+t+"]").find("option:contains('"+e[t]+"')").attr("selected",!0)}),I("input[name='totalPrice']").val(e.subtotal+e.postFee),T.render(),M.msg("导入PCB信息成功")}var I=layui.jquery,k=layui.view,T=layui.form,C=layui.admin,N=layui.element,x=layui.setter,q=layui.upload,A=layui.jsTools,M=layui.layer;N.render();var D=[{text:0,value:0},{text:1,value:1},{text:2,value:2},{text:4,value:4},{text:6,value:6},{text:8,value:8}],W=[{text:0,value:0},{text:1,value:1},{text:2,value:2}],Y=[{text:0,value:0},{text:4,value:4},{text:6,value:6},{text:8,value:8}],B=[{text:"KB",value:"KB"},{text:"SY",value:"SY"}],z=[{text:"YG",value:"YG"}],_=[{text:"KB6160",value:"KB6160"},{text:"KB6150",value:"KB6150"},{text:"KB6165",value:"KB6165"},{text:"KB6167",value:"KB6167"}],w=[{text:"SY1130",value:"SY1130"},{text:"SY1141",value:"SY1141"},{text:"SY1150",value:"SY1150"},{text:"SY1170",value:"SY1170"},{text:"SY1180",value:"SY1180"},{text:"SY1000",value:"SY1000"},{text:"SY1000-2",value:"SY1000-2"},{text:"SY1600",value:"SY1600"}],Q=[{text:"YG0001",value:"YG0001"},{text:"YG0002",value:"YG0002"},{text:"YG0003",value:"YG0003"},{text:"YG0004",value:"YG0004"}],O={isDis:{itPanelway:!0,itPanelsize:!0}},U={bordType:1,companyId:1,countrysId:70,totalWeight:0},G={stencilSize_price:"",stencilWeight:"",stencil_shippingPrice:""},L={postFee:"",customerAid:"",ids:"",orderNo:""},H={courierId:"",countryId:"",totalWeight:""},R={shipping:""},K={totalPric:null,totalPriced:null,isQuote:!1,totalPricS:null,totalPricedS:null,isQuoteS:!1},j=null,X={engineeringFee:"",boardFee:"",testCostFee:"",toolingFee:"",overworkFee:0,buildTime:"",weight:"",postFee:0,subtotal:"",quoteConfigIds:"",productNo:"",userId:"",orderType:1,gerberName:"",gerberPath:"",pcbName:"",orderNo:"",countries:"Afghanistan"},V={},E={stencilWeight:"",inStencilCost:""},J={pcbCost:0,totalPrice:0,shippingPrice:0},Z={postFee:G.stencil_shippingPrice,inStencilCost:null,sQuantity:1,stencilSide:"Top And Bottom (On Single Stencil)",sunitPrice:G.stencilSize_price,stotalPrice:null},$=new Object,ee={stencilSide:"Top And Bottom (On Single Stencil)",quantity:Z.sQuantity,thickness:.12,existingFiducials:.1,totalStencilFee:Z.stotalPrice,gerberPath:null,gerberName:null,orderId:null,orderType:1,pcbName:null,postFee:null,orderNo:null,companyId:U.companyId,countrysId:U.countrysId,customerSysName:null,userId:null,productNo:null},te={};c(),n(),i(0),l("FR4"),a(),o("kb"),m();var ie,ne,le,ae,oe,se,re,ce,ue=1;I("#singleSizeX,#singleSizeY,#quantityPCS").bind("input propertychange",function(e){t()}),I("#panelSizeX,#panelSizeY,#quantityPanel").bind("input propertychange",function(e){null!=re&&null!=ce&&null!=se&&t()}),I("#panelWayX,#panelWayY,#quantityPanel").bind("input propertychange",function(e){t()}),I("input[name='testPoint']").bind("input propertychange",function(e){setTimeout(function(){I(".up-subbtn").click()},1800)}),I("input[name='panelRoutingPath']").bind("input propertychange",function(e){setTimeout(function(){I(".up-subbtn").click()},1800)}),I("input[name='punchingHoles']").bind("input propertychange",function(e){setTimeout(function(){I(".up-subbtn").click()},1800)}),I("input[name='punchingSlots']").bind("input propertychange",function(e){setTimeout(function(){I(".up-subbtn").click()},1800)}),I("input[name='surfaceArea']").bind("input propertychange",function(e){setTimeout(function(){I(".up-subbtn").click()},1800)}),I("#mPrice").bind("input propertychange",function(e){var t=I("#mPrice").val(),i=I("#areasq").val(),n=parseFloat(t*i).toFixed(2),l=I("#boardFee").val();I("#unitPrice").val(parseFloat(l/i).toFixed(2)),I("#boardFee").val(n),M.msg(n)}),I("#rPcbForm").bind("input propertychange",function(){var e=S();f(e),X.postFee=parseFloat(I("#shippingPrice").val()),X.engineeringFee=parseFloat(I("#enginnerFee").val()),X=Object.assign(X,e),console.log(X)}),I("#stencil_quantity").bind("input propertychange",function(){var e=parseFloat(I(this).val());(""==e||null==e||"undefined"==typeof e||isNaN(e))&&(e=0),Z.sQuantity=ee.quantity=e,g()}),T.on("radio(boardType)",function(e){var t=e.value;"1"==t?(ue=1,i(1)):"2"==t&&(ue=2,i(2))}),T.on("select(material)",function(e){var t=e.value;"KB"==t?o("kb"):"SY"==t?o("sy"):"YG"==t&&o("yg")}),T.on("select(selSurfacefinish)",function(e){var t=e.value;"HASL_with_lead"==t||"HASL_lead_free"==t?I("#selSurfacethickness").val("2.54-25.4um"):"Immersion_Gold"==t?I("#selSurfacethickness").val("2u"):"Immersion_tin"==t?I("#selSurfacethickness").val("0.5um-0.7um"):"Immersion_silver"==t?I("#selSurfacethickness").val("≥0.05um"):"OSP"==t&&I("#selSurfacethickness").val("0.25-0.5um"),"Immersion_Gold"==t?I("input[name='surfaceArea']").removeAttr("disabled"):I("input[name='surfaceArea']").attr("disabled",!0),T.render("select","quoteForm"),T.render(null,"quoteForm")}),T.on("select(testPointType)",function(e){var t=e.value;"1"==t?I("#testPointT").text("飞针费："):I("#testPointT").text("测试架："),I(".up-subbtn").click()}),T.on("select(stencilSide)",function(e){var t=e.value;console.log(t),Z.stencilSide=ee.stencilSide=t,g()}),T.on("radio(existingFiducials)",function(e){var t=ee.existingFiducials=e.value;M.msg(t)}),T.on("radio(sthickness)",function(e){var t=ee.thickness=e.value;M.msg(t)}),T.on("radio(routingType)",function(e){var t=e.value;"1"==t?(I("input[name='panelRoutingPath']").removeAttr("disabled"),I("input[name='punchingHoles']").attr("disabled",!0),I("input[name='punchingSlots']").attr("disabled",!0)):(I("input[name='panelRoutingPath']").attr("disabled",!0),I("input[name='punchingHoles']").removeAttr("disabled"),I("input[name='punchingSlots']").removeAttr("disabled")),I(".up-subbtn").click(),T.render()}),N.on("collapse(orderTypeCol)",function(e){var t=e.title.context.innerText;t.indexOf("PCB Phototype")!=-1?(I(".rig-price-cardbody form").removeClass("quote-avtive"),I(".rig-price").addClass("quote-avtive"),U.bordType=1):t.indexOf("SMT-Stencil")!=-1?(I(".rig-price-cardbody form").removeClass("quote-avtive"),I("#stencilForm").addClass("quote-avtive"),U.bordType=2):t.indexOf("Assembly Service")!=-1&&(I(".rig-price-cardbody form").removeClass("quote-avtive"),I("#assemblyForm").addClass("quote-avtive"),U.bordType=3),P()}),T.on("select(layer)",function(e){var t=e.value;te.selLayer=t,"1"==pe&&("1"==t?(te.selPthcopper="none",te.selViaprocess="none"):"2"==t?(te.selPthcopper="20um",te.selViaprocess="Follow_gerber"):"4"==t?(c(),te.selLayer=t,te.selInlayercoopper="1oz",te.isDis.selInlayercoopper=!1,te.selInnerMintrack="5mil",te.isDis.selInnerMintrack=!1,te.selNofcore="1",te.isDis.selNofcore=!1,te.selNofpp="2",te.isDis.selNofpp=!1):"6"==t?(c(),te.selLayer=t,te.selInlayercoopper="1oz",te.isDis.selInlayercoopper=!1,te.selInnerMintrack="5mil",te.isDis.selInnerMintrack=!1,te.selNofcore="2",te.isDis.selNofcore=!1,te.selNofpp="3",te.isDis.selNofpp=!1,te.selPthcopper="none"):"8"==t&&(c(),te.selLayer=t,te.selInlayercoopper="1oz",te.isDis.selInlayercoopper=!1,te.selInnerMintrack="5mil",te.isDis.selInnerMintrack=!1,te.selNofcore="3",te.isDis.selNofcore=!1,te.selNofpp="4",te.isDis.selNofpp=!1,te.selPthcopper="none"),n())});var pe=1;T.on("radio(pcbType)",function(e){var t=e.value;M.msg(t),"FR4"==t?(pe=1,l("FR4"),r(),a("FR4")):"Aluminum"==t?(pe=2,l("Aluminum"),r(),a("Aluminum")):"FR4+Aluminum"==t&&(pe=3,l("FR4+Aluminum"),r(),a("FR4+Aluminum"))}),T.on("radio(buildTimeRadio)",function(e){var t=e.value;console.log(e),console.log(e),X.overworkFee=t,I("#urgentFee").val(t),f()}),T.on("select(selBuildTime)",function(e){var t=e.value,i=I("#selBuildTime").find("option[value="+e.value+"]").text();J.shippingPrice=t,X.overworkFee=t,X.buildTime=i,I("#urgentFee").val(t);var n=S();f(n)}),T.on("select(company)",function(e){U.companyId=I(e.elem).find("option:selected").attr("value");var t=U.companyId,i=U.countrysId;v(t,i),v()}),T.on("select(countrys)",function(e){U.countrysId=I(e.elem).find("option:selected").attr("value"),X.countries=U.countrysId,2===U.bordType&&b();var t=U.companyId,i=U.countrysId;v(t,i)}),T.on("select(filterCustomer)",function(e){var t=I(e.elem).find("option:selected").text();I("#orderPN").val(""),L.customerAid=e.value,X.userId=ee.userId=e.value,ee.customerSysName=t,I("#customerId").val(e.value),I("#customerSysName").val(I(e.elem).find("option:selected").text()),T.render("")}),T.on("select(filterOrderType)",function(e){X.orderType=ee.orderType=e.value}),I("#postFees").bind("input propertychange",function(e){Z.postFee=parseFloat(I(this).val()),g()}),I("#inStencilCost").bind("input propertychange",function(e){Z.inStencilCost=parseFloat(I(this).val()),b()}),T.on("submit(assemblyService)",function(e){var e=e.field;return C.req({type:"post",data:e,url:x.imUrl+"quote/getAssemblyQuote",success:function(e){var t=I("#pcbQuantity").val(),i=parseFloat(e.data.totalAssemblyQuote/t);I("#pricePCS").val(i.toFixed(2)),I("#assemblyCost").val(e.data.totalAssemblyQuote),null!=e.data.totalAssemblyWeight&&""!=e.data.totalAssemblyWeight&&I("#assemblyWeight").val(e.data.totalAssemblyWeight),console.log(e);e.data.totalAssemblyQuote,e.data.totalAssemblyWeight}}),!1}),I("#panelWayX,#panelWayY,#quantityPanel").keydown(function(e){var t=parseInt(e.keyCode);return 110!=t}),I("#panelWayX,#panelWayY,#quantityPanel").bind("cut copy paste",function(e){e.preventDefault()}),T.on("submit(quoteForm)",function(e){var e=e.field,t=e.cncAndPunch;return V=e,e.isExistSmt=0,e.stackUp="none",e.innerMinTrack=e.innerMinSpacing,e.outerMinSpacing=e.outerMinTrack,e.silkScreenBotColor=e.solderMaskTopColor,e.solderMaskBotColor=e.solderMaskTopColor,e.surfaceArea=e.surfaceArea,e.orderNo=I("#orderNo").val(),X.orderNo=e.orderNo,e.pcbName=X.pcbName,console.log(e),2!==ue||null!=e.panelWayX&&""!=e.panelWayX&&null!=e.panelWayY&&""!=e.panelWayY?null==e.testPoint||""==e.testPoint?(I("html,body").animate({scrollTop:200},"slow"),M.msg("请输入测试点数量 !"),!1):(console.log("surfaceFinish:"+e.surfaceFinish+"\nsurfaceArea:"+e.surfaceArea),"Immersion_Gold"==e.surfaceFinish&&""==e.surfaceArea?(M.msg("请输入沉金面积！"),!1):(C.req({type:"post",url:x.imUrl+"quote/countAdditionInfo",data:e,success:function(e){if(null!=e.data.pcbPriceDetail&&""!=e.data.pcbPriceDetail&&(null==e.data.pcbPriceDetail.qcidList&&""==e.data.pcbPriceDetail.qcidList||(L.ids=e.data.pcbPriceDetail.qcidList,X.quoteConfigIds=e.data.pcbPriceDetail.qcidList.join(","),L.ids=e.data.pcbPriceDetail.qcidList,console.log(L.ids))),console.log(e),X.engineeringFee=e.data.projectQuoteToUSD,X.boardFee=e.data.totalBoardQuoteToUSD,X.testCostFee=e.data.totalTestPointToUSD,X.toolingFee=e.data.cncAndPunchingQuoteToUSD,X.weight=e.data.totalQuoteWeight,U.totalWeight=e.data.totalQuoteWeight,I("#boardFee").val(e.data.totalBoardQuoteToUSD),I("#enginnerFee").val(e.data.projectQuoteToUSD),I("#pcbWeight").val(e.data.totalQuoteWeight+" KG"),I("#testFee").val(e.data.totalTestPointToUSD),I("#flyingTest").val(e.data.totalTestPointToUSD),I("#routingCost").val(e.data.cncAndPunchingQuoteToUSD),I("#unitPrice").val(e.data.unitPrice),H.totalWeight=e.data.totalQuoteWeight,U.totalWeight=e.data.totalQuoteWeight,j=e.data.areaType,console.log("areaType:"+j),"1"==t?I("#toolingFee").val(0):I("#toolingFee").val(e.data.cncAndPunchingQuoteToUSD),"1"==j)I("#mPrice").val(""),I("#mPrice").attr("disabled",!0);else{var i=parseFloat(e.data.totalBoardQuoteToUSD/I("#areasq").val()).toFixed(2);I("#mPrice").val(i),I("#mPrice").removeAttr("disabled")}if(f(),u(),null!=H.courierId&&""!=H.courierId||p(),null!=H.countryId&&""!=H.countryId||d(),null!=U.companyId&&""!=U.companyId&&null!=U.countrysId&&""!=U.countrysId){var n=U.companyId,l=U.countrysId;v(n,l)}var a=S();f(a)},error:function(e){alert("Services Error!!!")}}),T.render(),!1)):(M.tips("请输入拼版方式 !","#panelWayX",{tips:[1,"#3595CC"],time:5e3}),!1)}),I(".stencilSide").click(function(){C.popup({title:"Stencil Size",area:["60%","85%"],btn:["确定","取消"],yes:function(e,t){var i=layui.data("stencilList");$=i.params,G.stencilSize_price=$.unitPrice,G.stencilWeight=$.weight,E.stencilWeight=G.stencilWeight,I("#stencilWeight").val(G.stencilWeight+" KG "),E.stencilWeight=G.stencilSize_price,I("#inStencilSize").val(I("#stenContainer").val()),p(),d(),v(),M.closeAll()},success:function(e,t){k(this.id).render("marketManagement/iframeWindow/stencil_size_list",null).done(function(){})}})});var de={resetQuoteTab:function(){I("a[title='刷新']").click(),M.msg("重置报价表")},addCustomerFile:function(){M.msg("添加客户资料")},addThisQuote:function(){var e=Object.assign(V,X);return console.log(e),console.log("userId:"+X.userId),null==X.userId||""==X.userId?(M.msg("请先选择客户"),!1):null==X.gerberName||""==X.gerberName?(M.tips("请先上传Gerber资料再添加当前报价 !","#addFile",{tips:[1,"#3595CC"],time:2e3}),!1):void(K.totalPric==K.totalPriced&&1==K.isQuote?M.confirm("你已经添加了相同参数的报价，是否再次添加？",function(){C.req({type:"post",data:e,url:x.baseUrl+"epc/pcborder/save",success:function(e){I("#orderPN").val(e.pn),X.productNo=e.pn,T.render(null,"checkCustomer"),"500"!=e.code&&M.alert("你已成功添加当前报价！")}})}):(C.req({type:"post",data:e,url:x.baseUrl+"epc/pcborder/save",success:function(e){I("#orderPN").val(e.pn),X.productNo=e.pn,T.render(null,"checkCustomer"),"500"!=e.code&&M.alert("你已成功添加当前报价！")}}),K.totalPric=K.totalPriced,K.isQuote=!0))},lookQuote:function(){var e=X.quoteConfigIds;null==L.customerAid||""==L.customerAid?M.msg("请选择对应的客户"):C.popup({title:"产看报价详情",area:["70%","85%"],btn:["确定","取消"],yes:function(e,t){M.closeAll()},success:function(t,i){var n={ids:""};n.ids=X.quoteConfigIds,k(this.id).render("marketManagement/iframeWindow/quote_detaily",n).done(function(){I("#sss").text(e),I("#sss").attr("name",e),console.log(n)})}})},upSubbtn:function(){if("1"==U.bordType)null==L.customerAid||""==L.customerAid?M.tips("请先选择客户 !","#selCustomer_container",{tips:[1,"#3595CC"],time:2e3}):I(".bot-subbtn").click();else if(2===U.bordType){I(".rStencilSubmit").click();var e=Object.assign(ee,$);if(e.orderNo=I("#orderNo").val(),e.postFee=Z.postFee,console.log(e),console.log("saveSMTStencil.gerberPath:"+ee.gerberPath),null==e.userId||""==e.userId)return M.msg("请先选择客户"),!1;if(null==e.gerberName||""==e.gerberName)return M.tips("请先上传Gerber资料再添加当前报价 !","#addFile",{tips:[1,"#3595CC"],time:2e3}),!1;K.totalPricS==K.totalPricedS&&1==K.isQuoteS?M.confirm("你已经添加了相同参数的报价，是否再次添加？",function(){C.req({type:"post",data:e,url:x.baseUrl+"epc/stencilorder/save",success:function(e){M.alert("钢网报价成功！"),I("#orderPN").val(e.pn),ee.productNo=e.pn}})}):(C.req({type:"post",data:e,url:x.baseUrl+"epc/stencilorder/save",success:function(e){M.alert("钢网报价成功！"),I("#orderPN").val(e.pn),ee.productNo=e.pn}}),K.totalPricS=K.totalPricedS,K.isQuoteS=!0)}else 3===U.bordType&&I(".rAssemblySubmit").click()}};q.render({elem:"#addFile",url:x.baseUrl+"sys/oss/upload/geber?access_token="+layui.data("layuiAdmin").access_token,field:"file",accept:"file",exts:"zip|rar|7z",before:function(e){e.preview(function(e,t,i){var n=t.name;X.gerberName=ee.gerberName=n,X.pcbName=ee.pcbName=A.CleanFileSuffix(n),console.log("显示的文件名为："+X.pcbName),null==I("#pcbName").val&&""==I("#pcbName").val||I("#pcbName").val(X.pcbName),T.render(null,"")})},done:function(e,t,i){M.msg("文件上传成功！");var n=e.url,l=/\[(.+?)\]/g,a=n.match(l);console.log("未处理的路径为："+a);var o=a[0].replace(/\[|]/g,"");X.gerberPath=ee.gerberPath=o,console.log("处理完的路径为："+o)},error:function(){M.msg("文件上传失败！")}});I(".layui-btn").on("click",function(){var e=I(this).data("type");de[e]?de[e].call(this):""}),I(".up-rsetbtn").on("click",function(){I(".bot-rsetbtn").click()}),I(".importPcbInfo>.importOrder").on("click",function(){C.popup({title:"导入pcb订单信息",area:["506px","288px"],btn:["导入","取消"],yes:function(e,t){I("#importPCBInfo").click(),M.closeAll()},success:function(e,t){k(this.id).render("marketManagement/iframeWindow/import_pcbInfoForm").done(function(){T.on("submit(importPCBInfo)",function(e){return C.req({type:"post",url:x.baseUrl+"pert/revieworder/reviewOrderInfo",data:e.field,success:function(e){var i=e.data;null!=i?F(i):M.alert("当前不存在PCB参数详情！"),M.close(t)}}),!1})})}})}),I(".importPcbInfo>.importReOrder").on("click",function(){C.popup({title:"导入返单信息",area:["506px","288px"],btn:["导入","取消"],id:"popupImportReOrder",yes:function(e,t){I("#importRePCBInfo").click(),M.closeAll()},success:function(e,t){k(this.id).render("marketManagement/iframeWindow/import_pcbInfoReOreder").done(function(){T.on("submit(importRePCBInfo)",function(e){e.field;return C.req({type:"post",url:x.baseUrl+"epc/pcborder/findOrderByUidAndProductNo",data:e.field,success:function(e){var i=e.data;null!=i?F(i):M.alert("当前不存在PCB参数详情！"),M.close(t)}}),!1})})}})}),e("quote",{})});