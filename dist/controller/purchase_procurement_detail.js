/** layuiAdmin.pro-v1.0.0 LPPL License By http://www.layui.com/admin/ */
 ;"use strict";layui.define(["admin","table","index","element","form","laydate"],function(e){function t(){table.render({elem:"#proMana_procuDetailPCB",url:setter.baseUrl+"scm/pcborder/purchasingDetails",toolbar:"#sqeMana_incoAuTb",cellMinWidth:80,id:"proMana_procuDetailPCB",page:!0,parseData:function(e){return{code:0,data:e.data.list,count:e.data.totalCount}},cols:[[{type:"checkbox",fixed:"left"},{field:"productNo",title:"内部编号",width:130,fixed:"left",templet:"#iqcMana_ia",sort:!0},{field:"id",title:"客户编号",width:134,sort:!0},{field:"gmtCreate",title:"下单日期",minWidth:171,sort:!0},{field:"currentProcess",title:"进度",width:110,sort:!0},{field:"supplierId",title:"工艺要求",width:313,sort:!0,templet:"#purchase_gyyy"},{field:"factoryMake",title:"尺寸(mm)",width:117,sort:!0,templet:"#purchase_CC"},{field:"quantityPcs",title:"数量(PCS)",width:134,sort:!0},{field:"unitPrice",title:"K单价(元)",width:134,sort:!0},{field:"totalFee",title:"K金额(元)",width:134,sort:!0},{field:"supplierId",title:"供应商",width:134,sort:!0},{field:"supplierUnitPrice",title:"G单价(元)",width:134,sort:!0},{field:"supplierTotalFee",title:"G金额(元)",width:134,sort:!0},{field:"",title:"利润(元)",width:134,sort:!0,templet:"#purchase_LR"},{field:"donePcsNumber",title:"G支付情况",width:134,sort:!0},{field:"supplierProcurementRemark",title:"备注",width:134,sort:!0,edit:"text"},{field:"shippingDeliveryDate",title:"出货日期",width:134,sort:!0},{field:"countries",title:"目的地",width:134,sort:!0},{field:"shippingWeight",title:"重量(kg)",width:134,sort:!0},{field:"supplierTotalFee",title:"金额(元)",width:134,sort:!0},{field:"donePcsNumber",title:"支付情况",width:134,sort:!0},{field:"businessName",title:"业务员",width:134,sort:!0},{field:"courierName",title:"物流公司",width:134,sort:!0},{field:"shippingCourierNumber",title:"运单号",width:134,sort:!0},{field:"shippingPostalFee",title:"运费",width:134,sort:!0},{field:"shippingProcurementRemark",title:"备注",width:134,sort:!0,edit:"text"}]],done:function(e,t,i){}})}function i(){table.render({elem:"#proMana_procuDetailS",url:setter.baseUrl+"scm/stencilorder/purchasingDetails",toolbar:"#proMana_procuDetailS",cellMinWidth:80,id:"proMana_procuDetailS",page:!0,parseData:function(e){return{code:0,data:e.data.list,count:e.data.totalCount}},cols:[[{type:"checkbox",fixed:"left"},{field:"productNo",title:"内部编号",width:130,fixed:"left",templet:"#iqcMana_ia",sort:!0},{field:"id",title:"客户编号",width:134,sort:!0},{field:"gmtCreate",title:"下单日期",minWidth:171,sort:!0},{field:"currentProcess",title:"进度",width:110,sort:!0},{field:"supplierId",title:"工艺要求",width:395,sort:!0,templet:"#purchase_gyyyS"},{field:"factoryMake",title:"尺寸(mm)",width:207,sort:!0,templet:"#purchase_CCS"},{field:"quantity",title:"数量(PCS)",width:134,sort:!0},{field:"unitPrice",title:"K单价(元)",width:134,sort:!0},{field:"totalStencilFee",title:"K金额(元)",width:134,sort:!0},{field:"supplierId",title:"供应商",width:134,sort:!0},{field:"supplierUnitPrice",title:"G单价(元)",width:134,sort:!0},{field:"supplierTotalFee",title:"G金额(元)",width:134,sort:!0},{field:"",title:"利润(元)",width:134,sort:!0,templet:"#purchase_LRS"},{field:"donePcsNumber",title:"G支付情况",width:134,sort:!0},{field:"supplierProcurementRemark",title:"备注",width:134,sort:!0,edit:"text"},{field:"shippingDeliveryDate",title:"出货日期",width:134,sort:!0},{field:"countries",title:"目的地",width:134,sort:!0},{field:"shippingWeight",title:"重量(kg)",width:134,sort:!0},{field:"supplierTotalFee",title:"金额(元)",width:134,sort:!0},{field:"donePcsNumber",title:"支付情况",width:134,sort:!0},{field:"businessName",title:"业务员",width:134,sort:!0},{field:"courierName",title:"物流公司",width:134,sort:!0},{field:"shippingCourierNumber",title:"运单号",width:134,sort:!0},{field:"shippingPostalFee",title:"运费",width:134,sort:!0},{field:"shippingProcurementRemark",title:"备注",width:134,sort:!0,edit:"text"}]],done:function(e,t,i){}})}table=layui.table,view=layui.view,admin=layui.admin,form=layui.form,setter=layui.setter,element=layui.element;var r=layui.jquery;t(),element.on("tab(tab-pruchprocurmentDetail)",function(e){console.log(e.index),0===e.index?t():1===e.index?i():2===e.index}),table.on("toolbar(proMana_procuDetailPCB)",function(e){var t=table.checkStatus(e.config.id);t.data}),table.on("tool(proMana_procuDetailPCB)",function(e){var t=e.data;console.log(t)}),table.on("edit(proMana_procuDetailPCB)",function(e){var t={};"shippingProcurementRemark"==e.field?t={isiId:e.data.isiId,shippingProcurementRemark:e.value}:"supplierProcurementRemark"==e.field&&(t={sosId:e.data.sosId,supplierProcurementRemark:e.value}),admin.req({type:"post",data:t,url:setter.baseUrl+"scm/pcborder/editPurchasingDetails",success:function(e){layer.msg("修改成功！")}})}),table.on("edit(proMana_procuDetailS)",function(e){var t={};"shippingProcurementRemark"==e.field?t={isiId:e.data.isiId,shippingProcurementRemark:e.value}:"supplierProcurementRemark"==e.field&&(t={sosId:e.data.sosId,supplierProcurementRemark:e.value}),admin.req({type:"post",data:t,url:setter.baseUrl+"scm/pcborder/editPurchasingDetails",success:function(e){layer.msg("修改成功！")}})}),table.on("toolbar(iqcIncom_auditorS)",function(e){var t=table.checkStatus(e.config.id),i=t.data;if(i.length<1)return layer.msg("请选择一条数据"),!1;if("plrk"===e.event){for(var r=new Array,l=0;l<i.length;l++)r.push({id:i[l].id,orderId:i[l].orderId,orderPcsNumber:i[l].orderPcsNumber,currPcsNumber:i[l].currPcsNumber,orderType:i[l].orderType,isInternal:i[l].isInternal,onlineOid:i[l].onlineOid});layer.confirm("确定批量入库？",function(){admin.req({type:"post",headers:{access_token:layui.data("layuiAdmin").access_token},contentType:"application/json;charset=utf-8",data:JSON.stringify(r),url:setter.baseUrl+"iqc/stencilorder/batchStatusOk",success:function(){layer.msg("批量入库成功"),table.reload("iqcIncom_auditorS"),layer.closeAll()}})})}}),table.on("tool(iqcIncom_auditorS)",function(e){var t=e.data;console.log(t),"edit"==e.event?admin.popup({title:"Stencil此批来料检验",area:["624px","494px"],btn:["NG评审","NG批退","OK入库","保存"],btn1:function(e,i){t.pcsMantissa=r("input[name='pcsMantissa']").val(),t.failPcsNumber=r("input[name='failPcsNumber']").val(),layer.confirm("确定评审？",function(){admin.req({type:"post",data:t,url:setter.baseUrl+"iqc/stencilorder/statusReview",success:function(e){table.reload("iqcIncom_auditorS"),layer.closeAll()}})})},btn2:function(){return t.pcsMantissa=r("input[name='pcsMantissa']").val(),t.failPcsNumber=r("input[name='failPcsNumber']").val(),layer.confirm("确定批退？",function(){admin.req({type:"post",data:t,url:setter.baseUrl+"iqc/stencilorder/statusBack",success:function(e){table.reload("iqcIncom_auditorS"),layer.closeAll()}})}),!1},btn3:function(){return t.pcsMantissa=r("input[name='pcsMantissa']").val(),t.failPcsNumber=r("input[name='failPcsNumber']").val(),layer.confirm("确定入库？",function(){admin.req({type:"post",data:t,url:setter.baseUrl+"iqc/stencilorder/statusOk",success:function(e){table.reload("iqcIncom_auditorS"),layer.closeAll()}})}),!1},btn4:function(){t.pcsMantissa=r("input[name='pcsMantissa']").val(),t.failPcsNumber=r("input[name='failPcsNumber']").val(),layer.confirm("确定保存？",function(){admin.req({type:"post",data:t,url:setter.baseUrl+"iqc/stencilorder/updateOrderShipment",success:function(){table.reload("iqcIncom_auditorS"),layer.closeAll()}})})},success:function(e,i){var r=t.id,l=t.supplierId,a=t.orderId;view(this.id).render("iqcManagement/iframeWindow/incoming_auditor_edit",t).done(function(){form.on("submit(otEdit)",function(e){var t=e.field;return t.id=r,t.orderId=a,t.supplierId=l,console.log(t),admin.req({type:"post",data:t,url:setter.baseUrl+"scm/ordersupplier/update",success:function(e){layer.alert("Stencil订单协同修改成功"),table.reload("iqcIncom_auditorS"),layer.close(i)}}),!1})})}}):"search"==e.event&&layer.msg("查看订单协同")}),e("purchase_procurement_detail",{})});