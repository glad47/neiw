/** layuiAdmin.pro-v1.0.0 LPPL License By http://www.layui.com/admin/ */
 ;"use strict";layui.define(["admin","table","index","element","form","laydate"],function(e){table=layui.table,view=layui.view,admin=layui.admin,form=layui.form,setter=layui.setter,element=layui.element;var t=layui.jquery;element.on("tab(tab-outsourcing-contrgct)",function(e){0===e.index||1===e.index||2===e.index}),table.render({elem:"#outsourcing_contrgct_tabPcb",url:setter.baseUrl+"scm/pcborder/outsourcingContract/list",toolbar:"#outsourcing_contrgct_tabPcb",cellMinWidth:80,id:"outsourcing_contrgct_tabPcb",page:!0,parseData:function(e){return{code:0,data:e.page.list,count:e.page.totalCount}},cols:[[{type:"checkbox"},{field:"status",title:"状态",templet:"#pcb"},{field:"",title:"报价单号",width:125},{field:"gmtCreate",title:"报价时间",width:166},{field:"supplierNo",title:"供应商编号",width:124},{field:"supplierQuoteNo",title:"供应商厂编",width:117},{field:"productNo",title:"聚谷型号",width:124},{field:"pcbName",title:"聚谷物料号",width:144},{field:"quantityPcs",title:"订单数量(PCS)",width:134},{field:"unitPrice",title:"单价",width:96},{field:"engineeringFee",title:"工程费",width:96},{field:"testCostFee",title:"飞针费",width:96},{field:"testCostFee",title:"测试架费",width:96},{field:"toolingFee",title:"模具",width:96},{field:"subtotal",title:"合计",width:96},{field:"remark",title:"订单备注",width:168},{field:"remark",title:"订单备注",width:168},{field:"remark",title:"订单备注",width:168},{field:"dimensionsX",title:"dimensionsX",hide:!0},{field:"dimensionsY",title:"dimensionsY",hide:!0},{field:"panelSizeX",title:"panelSizeX",hide:!0},{field:"panelSizeY",title:"panelSizeY",hide:!0},{field:"panelWayX",title:"panelWayX",hide:!0},{field:"panelWayY",title:"panelWayY",hide:!0},{field:"gerberName",title:"gerberName",hide:!0},{field:"gerberPath",title:"gerberPath",hide:!0},{fixed:"right",title:"操作",toolbar:"#quotatgt_tabbar",width:130}]],done:function(e,t,i){}}),table.on("toolbar(outsourcing_contrgct_tabPcb)",function(e){var t=table.checkStatus(e.config.id);if("submitPcb"===e.event){for(var i=t.data,a=null,l=0;l<i.length;l++)null==a?a+=i[l].id:a=a+","+i[l].id;console.log(a),layer.confirm("确认提交 ["+a+"] ?",function(e){admin.req({type:"post",data:{ids:a},url:setter.baseUrl+"sqe/pcborder/batch/submit",success:function(t){"0"==t.code&&(layer.alert("提交成功！！"),table.reload("quotatgt_tabPcb"),layer.close(e))}})})}}),table.on("tool(quotatgt_tabPcb)",function(e){var i=e.data;"edit"==e.event?admin.popup({title:"PCB报价协同编辑",area:["50%","80%"],btn:["保存","下载客户资料","取消"],yes:function(e,a){layer.msg("提交信息");var l=new Object;l.id=i.id,l.orderId=i.orderId,l.supplierId=i.supplierId,l.supplierQuoteNo=i.supplierQuoteNo,l.boardFee=i.boardFee,l.testCostFee=t("#qt_pcb_testCostFee").val(),l.engineeringFee=t("#qt_pcb_engineeringFee").val(),l.toolingFee=t("#qt_pcb_toolingFee").val(),l.overworkFee=i.overworkFee,l.deliveryTime=t("#pcbDeliveryDate").val(),l.unitPrice=t("#qt_pcb_unitPrice").val(),l.remark=t("#qRemark").val(),l.status="",l.factoryMake=t("#pcbfactoryMake").val(),l.testPointType=t("#hiddenTestPoint").val(),l.totalFee=t("#qt_pcb_totalFee").text(),l.pcbaProcessFee=t("#qt_pcbaProcessFee").val(),l.pcbaPartsFee=t("#qt_pcbaPartsFee").val(),l.pcbaTestFee=t("#qt_pcbaTestFee").val(),l.pcbaToolFee=t("#qt_pcbaToolFee").val(),l.pcbaSubtotalFee=t("#qt_pcbaSubtotalFee").text(),admin.req({type:"post",data:l,url:setter.baseUrl+"sqe/pcborder/quotationTogether/update",success:function(t){layer.alert("供应商报价修改成功"),table.reload("quotatgt_tabPcb"),layer.close(e)}})},btn2:function(e,t){return layer.msg("下载资料"),!1},success:function(e,a){view(this.id).render("sqeManagement/iframeWindow/quotation_together_pcb",i).done(function(){t(".layui-layer-btn1").attr("href",setter.baseUrl+"sys/oss/download/geber?access_token="+layui.data("layuiAdmin").access_token+"&fileName="+i.quoteGerberPath+"&filePathName="+i.quoteGerberName)})}}):"search"==e.event&&layer.msg("查看订单协同")}),e("scm_outsourcing_contract",{})});