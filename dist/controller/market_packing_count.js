/** layuiAdmin.pro-v1.0.0 LPPL License By http://www.layui.com/admin/ */
 ;"use strict";function ownKeys(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(i),!0).forEach(function(t){_defineProperty(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ownKeys(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}layui.define(["admin","table","index","element","form","laydate"],function(e){function t(e){i.reload("market-count-result-tab",{where:_objectSpread(_objectSpread({},e),{},{packingSpecificationEntityList:e.packingSpecificationEntityList}),method:"POST",contentType:"application/json"})}var i=layui.table,n=layui.view,a=layui.admin,r=layui.form,c=(layui.laydate,layui.setter),o=(layui.element,layui.jquery);r.render(null,"market-packing-form"),r.verify({myrequired:function(e,t){var i=o(" input[ name='optionMark' ] ").val();if("countArea"!==i&&!e)return"必填不能为空！！"}}),o(".onblur-mark").bind("blur",function(){r.val("market-packing-form",{optionMark:"countArea"}),o("#mpcs").click()}),r.on("submit(market-packing-count-sumbit)",function(e){var n=e.field;if("countArea"===n.optionMark){var a=(parseFloat(n.qty/(n.panelX*n.panelY)*n.finishedSizeX*n.finishedSizeY)/1e6).toFixed(2);return r.val("market-packing-form",{area:a}),r.val("market-packing-form",{optionMark:"countResult"}),!1}var c=i.checkStatus("market-packing-size-tab"),o=c.data;return 0===o.length?layer.msg("请至少选择一个箱子规格!!"):(n.packingSpecificationEntityList=o,console.log(n),void t(n))}),i.render({elem:"#market-packing-size-tab",url:c.baseUrl+"marker/packing/specificationList",toolbar:"",id:"market-packing-size-tab",page:!0,parseData:function(e){return{code:0,data:e.page.list,count:e.page.totalCount}},cols:[[{type:"checkbox",fixed:"left"},{field:"longPacking",title:"长（CM）",align:"center",sort:!0,edit:"text"},{field:"widePacking",title:"宽（CM）",align:"center",sort:!0,edit:"text"},{field:"highPacking",title:"高（CM）",align:"center",sort:!0,edit:"text"},{field:"numberPacking",title:"数量",align:"center",sort:!0,edit:"text"}]]}),i.render({elem:"#market-count-result-tab",url:c.baseUrl+"marker/packing/countPackingResult",cellMinWidth:80,id:"market-count-result-tab",method:"POST",contentType:"application/json",cols:[[{type:"numbers",title:"序号",fixed:"left"},{field:"packX",title:"长(CM)",align:"center"},{field:"packY",title:"宽(CM)",align:"center"},{field:"packH",title:"高(CM)",align:"center"},{field:"utilization",title:"利用率",align:"center",sort:!0},{field:"cartonWeight",title:"箱重量",align:"center"},{field:"cartonNumber",title:"箱数",align:"center"},{field:"longPack",title:"长(包)",align:"center"},{field:"winePack",title:"宽(包)",align:"center"},{field:"highPack",title:"高(包)",align:"center"},{field:"sqm",title:"体积(㎡)",align:"center"}]],done:function(e,t,i){this.where={}}}),i.on("edit(market-packing-size-tab)",function(e){var t=e.value,n=e.data,r=e.field,o={};o[r]=t,o.id=n.id,a.req({url:c.baseUrl+"/marker/packing/updateSpecification",type:"POST",data:o,done:function(e){layer.msg("修改成功"),i.reload("market-packing-size-tab")},fail:function(e){layer.msg("修改失败，请稍后再试！")}})});var l={packingSizeAdd:function(){a.popup({title:"添加箱子规格",area:["500px","350px"],id:"LAY-popup-packing-add",success:function(e,t){n(this.id).render("marketManagement/iframeWindow/packing_form_add").done(function(){r.render(null,"market-packing-add-form"),r.on("submit(market-packing-form-submit)",function(e){var n=e.field;a.req({type:"post",url:c.baseUrl+"/marker/packing/saveSpecification",data:n,done:function(e){layer.msg("添加成功"),i.reload("market-packing-size-tab")},fail:function(e){layer.msg("添加失败，请稍后再试！")}}),layer.close(t)})})}})},packingSizeDel:function(){var e=i.checkStatus("market-packing-size-tab"),t=e.data;if(0===t.length)return layer.msg("请选择数据");var n=t.map(function(e){return e.id}).join(",");layer.confirm("确定删除吗？",function(e){a.req({type:"post",url:c.baseUrl+"/marker/packing/delSpecification",data:{ids:n},success:function(){i.reload("market-packing-size-tab"),layer.msg("已删除")}})})},orderInfoInput:function(){a.popup({title:"选择订单型号",closeBtn:0,anim:2,shadeClose:!0,area:["50%","60%"],btn:["导入","取消"],yes:function(){o("#drsjyc").click()},success:function(e,t){n(this.id).render("common/common_import_order_form_table").done(function(){o("#drsjyc").click(function(){var e=i.checkStatus("LAY-common-import-order-table-list"),n=e.data;if(console.log(n),0===n.length)return layer.msg("请选择要导入的数据");n=n[0];var a={finishedSizeX:n.dimensionsX||n.panelSizeX,finishedSizeY:n.dimensionsY||n.panelSizeY,qty:n.quantityPcs,area:n.areaSq,panelX:n.panelWayX||1,panelY:n.panelWayY||1,boardType:n.pcbType,layerNum:n.layerNum,finishThickness:n.finishThickness.replace("mm"," ").trim()};console.log(a),r.val("market-packing-form",a),layer.close(t)})})}})}};o(".layui-btn.layuiadmin-btn-list").on("click",function(){var e=o(this).data("type");l[e]?l[e].call(this):""}),e("market_packing_count",{})});