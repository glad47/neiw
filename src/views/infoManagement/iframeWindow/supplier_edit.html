<title>Edit supplier</title>
<div class="layui-fluid" style="width: 750px;">
    <form class="layui-form edit-cusInfo" lay-filter="supplierAdd_form" id="supplierAdd_form">
        <div class="layui-form-item">
            <div class="addcus-cusNum layui-col-md6">
                <label class="layui-form-label">编号：</label>
                <div class="layui-input-block">
                    <script type="text/html" template>
                        <input type="text" name="supplierId" value="{{ d.params.supplierId || ''}}" autocomplete="off" class="layui-input">
                    </script>
                </div>
            </div>
            <div class="addcus-cusPWd layui-col-md6">
                <label class="layui-form-label">类别：</label>
                <div class="layui-input-block">
                    <!-- <script type="text/html" template>
                    <select name="type">
                        <option value="0" {{ d.params.type =='0' ? 'selected' : '' }}></option>
                        <option value="1" {{ d.params.type =='1' ? 'selected' : '' }}>PCB</option>
                        <option value="2" {{ d.params.type =='2' ? 'selected' : '' }}>PCBA</option>
                        <option value="3" {{ d.params.type =='3' ? 'selected' : '' }}>SMT</option>
                        <option value="4" {{ d.params.type =='4' ? 'selected' : '' }}>物料</option>
                    </select>
                    </script> -->
                    <script type="text/html" template lay-url="{{layui.setter.baseUrl}}sys/dict/commonSelectData" lay-data="{tableName:'供应商信息',fileName:'类别'}" lay-done="layui.data.done(d);" lay-type="post">
                        <select name="type" lay-verify="required">
                            {{# 
                                layui.each(d.data, function(index, item){   
                            }}
                            <option value="0"></option>
                            <option value="{{ item.dictKey || ''}}" {{ d.params.type == item.dictKey ? 'selected' : ''}}>{{ item.dictValue }}</option>
                            {{#  }); }}
                            {{#  if(d.data.length === 0){ }}
                            无数据 
                            {{#  } }}
                        </select>    
                    </script>
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="addcus-merchandiser layui-col-md6">
                <label class="layui-form-label">联系人：</label>
                <div class="layui-input-block">
                    <script type="text/html" template>
                        <input type="text" name="contact" value="{{ d.params.contact || ''}}" autocomplete="off" class="layui-input">
                    </script>
                </div>
            </div>
            <div class="addcus-cusCom layui-col-md6">
                <label class="layui-form-label">公司名称：</label>
                <div class="layui-input-block">
                    <script type="text/html" template>
                        <input type="text" name="companyName" value="{{ d.params.companyName || ''}}" autocomplete="off" class="layui-input">
                    </script>
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="addcus-tel layui-col-md6">
                <label class="layui-form-label">办公电话：</label>
                <div class="layui-input-block">
                    <script type="text/html" template>
                        <input type="text" name="officePhone" value="{{ d.params.officePhone || ''}}" autocomplete="off" class="layui-input">
                    </script>
                </div>
            </div>
            <div class="addcus-skype layui-col-md6">
                <label class="layui-form-label">手机：</label>
                <div class="layui-input-block">
                    <script type="text/html" template>
                        <input type="text" name="phone" value="{{ d.params.phone || ''}}" autocomplete="off" class="layui-input">
                    </script>
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="addcus-email layui-col-md6">
                <label class="layui-form-label">Email：</label>
                <div class="layui-input-block">
                    <script type="text/html" template>
                        <input type="text" name="email" value="{{ d.params.email || ''}}" autocomplete="off" class="layui-input">
                    </script>
                </div>
            </div>
            <div class="layui-col-md6">
                <label class="layui-form-label">传真：</label>
                <div class="layui-input-block">
                    <script type="text/html" template>
                        <input type="text" name="fax" value="{{ d.params.fax || ''}}" autocomplete="off" class="layui-input">
                    </script>
                </div>
            </div>
        </div>

        <div class="layui-form-item">
            
            <div class="addcus-cusNum layui-col-md4">
                <label class="layui-form-label">付款方式：</label>
                <div class="layui-input-block">
                    <!-- <select name="paymentType">
                        <option value="0" {{ d.params.paymentType == '0' ? 'selected' : '' }}></option>
                        <option value="1" {{ d.params.paymentType == '1' ? 'selected' : '' }}>现金</option>
                        <option value="2" {{ d.params.paymentType == '2' ? 'selected' : '' }}>当月结</option>
                        <option value="3" {{ d.params.paymentType == '3' ? 'selected' : '' }}>月结30天</option>
                        <option value="4" {{ d.params.paymentType == '4' ? 'selected' : '' }}>月结60天</option>
                    </select> -->
                    <script type="text/html" template lay-url="{{layui.setter.baseUrl}}sys/dict/commonSelectData" lay-data="{tableName:'供应商信息',fileName:'付款方式'}" lay-done="layui.data.done(d);" lay-type="post">
                        <select name="paymentType" lay-verify="required">
                            {{# 
                                layui.each(d.data, function(index, item){   
                            }}
                            <option value="0"></option>
                            <option value="{{ item.dictKey || ''}}" {{ d.params.paymentType == item.dictKey ? 'selected' : ''}}>{{ item.dictValue }}</option>
                            {{#  }); }}
                            {{#  if(d.data.length === 0){ }}
                            无数据 
                            {{#  } }}
                        </select>    
                    </script>
                </div>
            </div>
            <div class="addcus-cusPWd layui-col-md4">
                <label class="layui-form-label">是否含税：</label>
                <div class="layui-input-block">
                    <script type="text/html" template>
                    <select name="taxe">
                        <option value="0" {{ d.params.taxe == '0' ? 'selected' : '' }}></option>
                        <option value="1" {{ d.params.taxe == '1' ? 'selected' : '' }}>是</option>
                        <option value="2" {{ d.params.taxe == '2' ? 'selected' : '' }}>否</option>
                    </select>
                    </script>
                </div>
            </div>
            <div class="addcus-cusPWd layui-col-md4">
                <label class="layui-form-label">发票类型：</label>
                <div class="layui-input-block">
                    <!-- <select name="invoiceType">
                        <option value="0" {{ d.params.invoiceType == '0' ? 'selected' : '' }}></option>
                        <option value="1"  {{ d.params.invoiceType == '1' ? 'selected' : '' }}>收据</option>
                        <option value="2"  {{ d.params.invoiceType == '2' ? 'selected' : '' }}>普票</option>
                        <option value="3"  {{ d.params.invoiceType == '3' ? 'selected' : '' }}>增值税13%</option>
                    </select> -->
                    <script type="text/html" template lay-url="{{layui.setter.baseUrl}}sys/dict/commonSelectData" lay-data="{tableName:'供应商信息',fileName:'发票类型'}" lay-done="layui.data.done(d);" lay-type="post">
                        <select name="invoiceType" lay-verify="required">
                            {{# 
                                layui.each(d.data, function(index, item){   
                            }}
                            <option value="0"></option>
                            <option value="{{ item.dictKey || ''}}" {{ d.params.invoiceType == item.dictKey ? 'selected' : ''}}>{{ item.dictValue }}</option>
                            {{#  }); }}
                            {{#  if(d.data.length === 0){ }}
                            无数据 
                            {{#  } }}
                        </select>    
                    </script>
                </div>
            </div>
           
        </div>

        <div class="layui-form-item" style="display: none;">
            <script type="text/html" template>
                <div class="addcus-merchandiser layui-col-md6">
                    <label class="layui-form-label">文件名：</label>
                    <div class="layui-input-block">
                        <input type="text" name="accessoryName" value="{{ d.params.accessoryName || ''}}" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="addcus-cusCom layui-col-md6">
                    <label class="layui-form-label">文件路径：</label>
                    <div class="layui-input-block">
                        <input type="text" name="accessoryPath" value="{{ d.params.accessoryPath || ''}}" autocomplete="off" class="layui-input">
                    </div>
                </div>
            </script>
        </div>

        <div class="layui-form-item">
            <div class="addcus-merchandiser layui-col-md6">
                <label class="layui-form-label">操作：</label>
                <div class="layui-input-block">
                    <input type="checkbox" name="switch" lay-skin="switch" lay-text="停用|启用">
                </div>
            </div>
            
            <div class="addcus-merchandiser layui-col-md6">
                <label class="layui-form-label">供应商：</label>
                <div class="layui-input-block">
                    <script type="text/html" template lay-url="{{layui.setter.baseUrl}}sys/user/allSupplier" lay-data="{roleId:14}" lay-done="layui.data.done(d);" lay-type="post">
                        <select name="userId">
                            {{# 
                                var userId = d.params.userId;
                                layui.each(d.data, function(index, item){   
                            }}
                            <option value="" {{ userId == '' ? 'selected' : ''}}></option>
                            <option value="{{ item.userId || ''}}" {{ userId == item.userId ? 'selected' : ''}}>{{ item.username }}</option>
                            {{#  }); }}
                        {{#  if(d.data.length === 0){ }}
                            无数据
                            {{#  } }}
                        </select>    
                    </script>
                </div>
            </div>
        </div>

        <div class="layui-tab layui-tab-brief" lay-filter="docDemoTabBrief">
            <ul class="layui-tab-title">
                <li class="layui-this">内容分类</li>
                <li>附件</li>
                <li>备注</li>
                <li>地址</li>
            </ul>
            <div class="layui-tab-content" style="height: 100px;">
                <div class="layui-tab-item layui-show">
                    <!--内部分类-->
                    <div class="layui-form-item supedit-nbfl">
                        <div class="supedit-type layui-input-block layui-col-md12">
                            <script type="text/html" template>
                            <label class="layui-form-label">类型：</label>
                            <input type="radio" name="strengths" value="1" {{ d.params.strengths == '1' ? 'checked' : '' }} title="简单样板">
                            <input type="radio" name="strengths" value="2" {{ d.params.strengths == '2' ? 'checked' : '' }} title="复杂样板">
                            <input type="radio" name="strengths" value="3" {{ d.params.strengths == '3' ? 'checked' : '' }} title="简单批量">
                            <input type="radio" name="strengths" value="6" {{ d.params.strengths == '6' ? 'checked' : '' }} title="复杂批量">
                            <input type="radio" name="strengths" value="4" {{ d.params.strengths == '4' ? 'checked' : '' }} title="HDI">
                            <input type="radio" name="strengths" value="5" {{ d.params.strengths == '5' ? 'checked' : '' }} title="软板">
                            <input type="radio" name="strengths" value="7" {{ d.params.strengths == '7' ? 'checked' : '' }} title="铝基板">
                            <input type="radio" name="strengths" value="8" {{ d.params.strengths == '8' ? 'checked' : '' }} title="物料">
                            </script>
                        </div>
                        <script type="text/html" template>
                        <div class="layui-input-block layui-col-md12">
                            <div class="supedit-jq layui-col-md6">
                                <label class="layui-form-label">交期：</label>
                                <div id="supedit_jq"></div>
                                <input type="text" name="evaluateDdelivery" value="{{ d.params.evaluateDdelivery }}" autocomplete="off" class="layui-input">
                            </div>
                            <div class="supedit-pz layui-col-md6">
                                <label class="layui-form-label">品质：</label>
                                <div id="supedit_pz" name="evaluateQuality"></div>
                                <input type="text" name="evaluateQuality" value="{{ d.params.evaluateQuality }}" autocomplete="off" class="layui-input">
                            </div>
                        </div>
                        <div class="layui-input-block layui-col-md12">
                            <div class="supedit-phd layui-col-md6">
                                <label class="layui-form-label">配合度：</label>
                                <div id="supedit_phd" name="evaluateCompatibility"></div>
                                <input type="text" name="evaluateCompatibility"  value="{{ d.params.evaluateCompatibility }}"autocomplete="off" class="layui-input">
                            </div>
                            <div class="supedit-pj layui-col-md6">
                                <label class="layui-form-label">评级：</label>
                                <div id="supedit_pj" name="evaluateRate"></div>
                                <input type="text" name="evaluateRate" value="{{ d.params.evaluateRate }}" autocomplete="off" class="layui-input">
                            </div>
                        </div>
                        <hr class="layui-bg-gray">
                        </script>
                    </div>
                </div>
                <div class="layui-tab-item">
                    <script type="text/html" template>
                    {{# if(d.params.accessoryName != null){ }}
                    <div>
                        <a href="{{layui.setter.baseUrl}}sys/oss/download/geber?filePathName={{d.params.accessoryPath}}&fileName={{d.params.accessoryName}}&access_token={{layui.data('layuiAdmin').access_token}}">{{d.params.accessoryName}}点击下载客户附件</a>
                    </div>
                    <button class="layui-btn layui-btn-sm" id="supplierUpload" type="button" style="margin-top: 15px;">修改客户附件</button>
                    {{# }else{ }}
                    <button class="layui-btn layui-btn-sm" id="supplierUpload" type="button" style="margin-top: 15px;">上传客户附件</button>
                    {{# } }}
                    </script>
                </div>
                <div class="layui-tab-item">
                    <div class="layui-form-item layui-form-text">
                        <script type="text/html" template>
                            <textarea placeholder="请输入备注信息" value="{{ d.params.remark || ''}}" class="layui-textarea" name="remark"></textarea>
                        </script>
                    </div>
                </div>
                <div class="layui-tab-item">
                    <div class="layui-form-item layui-form-text">
                        <script type="text/html" template>
                            <textarea placeholder="请输入地址信息" value="{{ d.params.address || ''}}" class="layui-textarea" name="address"></textarea>
                        </script>
                    </div>
                </div>
            </div>
        </div>

        <div class="layui-form-item layui-col-md-offset2" style="display: none;">
            <div class="layui-input-block">
                <button class="layui-btn" type="button" lay-submit lay-filter="LAY-supplier-add-submit" id="supplierEditSubmit">立即提交</button>
                <button type="reset" class="layui-btn layui-btn-primary">重置</button>
            </div>
        </div>

    </form>

</div>
<style>
    /*.edit-cusInfo .layui-input-block {margin-top: 10px;}*/
    .layui-layout-body {overflow: scroll;} /**防止隐藏**/
    input[name="evaluateDdelivery"],input[name="evaluateQuality"],input[name="evaluateCompatibility"],input[name="evaluateRate"]{display: none;}
    .supedit-nbfl .layui-input-block {margin-left: 0;margin-top: 0;}

</style>
<script>
layui.data.done = function(d){
    layui.use(['admin', 'table', 'index','element','form','rate','upload', 'filePathProcess'], function(){
        var table = layui.table;
        var $ = layui.jquery;
        var form = layui.form;
        var element = layui.element;
        var upload = layui.upload;
        var rate = layui.rate;
        var admin = layui.admin;
        var filepathprocess = layui.filePathProcess;
        form.render(null, 'supplierAdd_form');

        //执行实例
        var uploadInst = upload.render({
            elem: '#supplierUpload' //绑定元素
            ,url:  setter.baseUrl+'sys/oss/upload/geber?access_token='+layui.data('layuiAdmin').access_token
            ,field: 'file'  //文件上传的字段名
            ,accept: 'file'
            ,exts: 'zip|rar|7z'
            ,before: function (obj) {
                obj.preview(function (index, file, result) {
                    $("input[name='accessoryName']").val(file.name);   // 回填到表单=>文件名
                });
            }
            ,done: function(res){
                //文件路径
                var sjPath = filepathprocess.pathProcess(res.url);
                $("input[name='accessoryPath']").val(sjPath);   // 回填到表单=>文件名
                layer.alert('客户附件上传成功！点击[立即提交]更新附件信息');
            }
        });

        //交期
        rate.render({
            elem: '#supedit_jq'
            ,value: $("input[name='evaluateDdelivery']").val()
            ,text: true
            ,choose: function (value) {
                $("input[name='evaluateDdelivery']").val(value);
            }
            ,setText: function(value){ //自定义文本的回调
                var arrs = {
                    1: '极差'
                    ,2: '差'
                    ,3: '中等'
                    ,4: '好'
                    ,5: '极好'
                };
                this.span.text(arrs[value] || ( value + "星"));
            }
        });
        //品质
        rate.render({
            elem: '#supedit_pz'
            ,value: $("input[name='evaluateQuality']").val()
            ,text: true
            ,choose: function (value) {
                $("input[name='evaluateQuality']").val(value);
            }
            ,setText: function(value){ //自定义文本的回调
                var arrs = {
                    1: '极差'
                    ,2: '差'
                    ,3: '中等'
                    ,4: '好'
                    ,5: '极好'
                };
                this.span.text(arrs[value] || ( value + "星"));
            }
        });
        //配合度
        rate.render({
            elem: '#supedit_phd'
            ,value: $("input[name='evaluateCompatibility']").val()
            ,text: true
            ,choose: function (value) {
                $("input[name='evaluateCompatibility']").val(value);
            }
            ,setText: function(value){ //自定义文本的回调
                var arrs = {
                    1: '极差'
                    ,2: '差'
                    ,3: '中等'
                    ,4: '好'
                    ,5: '极好'
                };
                this.span.text(arrs[value] || ( value + "星"));
            }
        });
        //评级
        rate.render({
            elem: '#supedit_pj'
            ,value: $("input[name='evaluateRate']").val()
            ,text: true
            ,choose: function (value) {
                $("input[name='evaluateRate']").val(value);
            }
            ,setText: function(value){ //自定义文本的回调
                var arrs = {
                    1: 'C'
                    ,2: 'B2'
                    ,3: 'B1'
                    ,4: 'A2'
                    ,5: 'A1'
                };
                this.span.text(arrs[value] || ( value + "星"));
            }
        });
    });
}
</script>
