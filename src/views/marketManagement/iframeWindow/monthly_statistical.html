<title>月度统计表</title>
<div class="layui-fluid monthly-statistical" id="monthlyStatistical">
    <style>
        .layui-table td, .layui-table th ,.monthly-statistical-header h1{color: black;}
    </style>
    <script type="text/html" template>
    <div class="monthly-statistical-header" style="text-align: center;">
        <h1>
            {{# var bArray = [] }}
            {{# layui.each(d.params, function(index, item){  }}
                {{# if(bArray.indexOf(item.businessName) == -1){ }}
                    {{item.businessName}}
                    {{# bArray.push(item.businessName)}}
                {{# } }}
            {{#  }); }}
            {{d.params.popMonthlyStatisticalType || ''}}统计表</h1>
    </div>
    <table class="layui-table">
        <thead>
        <tr>
            <th>下单日期</th>
            <th>内部型号</th>
            <th>订单金额</th>
            <th>提成</th>
            <th>是否支付</th>
            <th>支付日期</th>
            <th>渠道</th>
            <th>网站</th>
        </tr>
        </thead>
        <tbody>
        <!--总销售额-->
        {{# var totalAll = 0 }}
        <!--总提成-->
        {{# var totalCommission = 0 }}
        {{# layui.each(d.params, function(index, item){  }}

            {{# if(item.commission == null) { }}
                {{# item.commission = 0 }}
            {{# } }}
        <tr>
            <!--下单日期-->
            <td>
                {{# if(item.orderTime != null){ }}
                    {{ item.orderTime.substring(0, 10) || '' }}
                {{# }}}
            </td>
            <!--内部型号-->
            <td>
                {{ item.productNo || '' }}
            </td>
            <!--订单金额-->
            <td>
                {{# if(item.totalFeeCNY == null){ }}
                    {{# item.totalFeeCNY = 0}}
                {{# } }}
                ￥{{ item.totalFeeCNY || '' }}
                <!--汇总-->
                {{# totalAll += parseFloat(item.totalFeeCNY) }}
            </td>
            <!--提成-->
            <td>
                {{# if(item.commission == null || item.commission == ''){ }}
                    {{# item.commission = 0  }}
                {{# } }}
                (提成点:{{ item.commission || 0 }})
                &nbsp;&nbsp;&nbsp;&nbsp;
                {{parseFloat(item.commission*item.totalFeeCNY).toFixed(2)}}
                <!--计算总提成-->
                {{# totalCommission += parseFloat(item.totalFeeCNY*item.commission)}}
            </td>
            <!--是否支付-->
            <td>
                {{# if(item.payLogId != null){ }}
                <a style="color: green">已支付</a>
                {{# } else { }}
                <a style="color: orangered">未支付</a>
                {{# } }}
            </td>
            <!--支付日期-->
            <td>
                {{# if(item.payTime != null){ }}
                    {{ item.payTime.substring(0, 10) || '' }}
                {{# }}}
            </td>
            <!--网站-->
            <td>
                {{ item.customerUserPaVO.siteUrl || '' }}
            </td>
            <!--渠道-->
            <td>
                {{ item.customerUserPaVO.channel || '' }}
            </td>
            <!--新客户-->
            <!--<td>-->
                <!--{{ item.commission || '否' }}-->
            <!--</td>-->
        </tr>
        {{#  }); }}
        <tr>
            <td colspan="7" style="text-align: left;">
                <!--Get statistics-->
                订单数：{{d.params.length}} 条&nbsp;&nbsp;&nbsp;&nbsp;
                <strong>
                销售额：{{totalAll.toFixed(2)}}
                </strong>
                提成(￥)：{{totalCommission.toFixed(2)}} &nbsp;&nbsp;&nbsp;&nbsp;
            </td>
            <td style="text-align: right;">
                统计时间：{{d.params.popMSTime || ''}}
                &nbsp;&nbsp;&nbsp;&nbsp;
                打印时间：{{new Date().toLocaleDateString() }}
            </td>
        </tr>
        </tbody>
    </table>
    </script>
</div>